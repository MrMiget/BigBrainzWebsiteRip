Ext.define("BigBrainzLauncher.view.IMFSiteCodeLogin",{extend:"Ext.container.Viewport",itemId:"imfSiteCodeLogin",layout:{align:"middle",pack:"center",type:"hbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",isStudent:function(b){return(b!=="school"&&b!=="district")},loginStudent:function(c,d,b){Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/sitecode/student",params:{username:d,password:b,sitecode:c},success:function(e){var f=Ext.decode(e.responseText);if(f.success){Ext.ComponentQuery.query("#imfSiteCodeLogin")[0].destroy();student_data.id=f.data[0].id;student_data.name=f.data[0].name;student_data.username=f.data[0].name;school_data.id=f.data[0].school_id;Ext.getStore("GameStore").loadRawData(f);Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+f.data[0].school_id+"/login_info";Ext.getStore("SchoolStore").load({callback:function(){var g=Ext.create("BigBrainzLauncher.view.StudentLoginViewport");BigBrainzLauncher.getApplication().fireEvent("studentSelected",student_data.id)}})}else{Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}})},loginEducator:function(c,d,b){Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/sitecode/school",params:{sitecode:c,username:d,password:b},success:function(e){var g=Ext.decode(e.responseText);if(g.success){Ext.ComponentQuery.query("#imfSiteCodeLogin")[0].destroy();school_data.id=g.id;school_data.name=g.name;school_data.sitecode=resitecode;var f=new Date();var h=new Date(f.getFullYear()+1,f.getMonth(),f.getDay());Ext.util.Cookies.set("__school_id_saved",school_data.id,h);Ext.util.Cookies.set("__school_name_saved",school_data.name,h);Ext.getStore("ClassStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/children";Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/login_info";Ext.getStore("SchoolStore").load({callback:function(l,k,m){Ext.getStore("ClassStore").load({callback:function(o,n,q){var p=Ext.create("BigBrainzLauncher.view.EducatorTreeViewport")}})}})}else{Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}})},loginDistrictAdmin:function(c,d,b){Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/sitecode/district",params:{sitecode:c,username:d,password:b},success:function(e){var f=Ext.decode(e.responseText);if(f.success){district_data.id=f.id;district_data.name=f.name;Ext.ComponentQuery.query("#imfSiteCodeLogin")[0].destroy();Ext.create("BigBrainzLauncher.view.DistrictOverview")}else{Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}})},login:function(){var c=this.down("#sitecode").value;var d=this.down("#username").value;var b=this.down("#password").value;if(this.isStudent(d)){this.loginStudent(c,d,b)}else{if(d=="district"){this.loginDistrictAdmin(c,d,b)}else{this.loginEducator(c,d,b)}}},height:600,hidden:true,html:"<div id = 'login-footer'></div>",itemId:"login-form",width:800,layout:{type:"hbox"},items:[{xtype:"container",flex:1,cls:"login-form",layout:{align:"center",type:"vbox"},items:[{xtype:"container",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"image",height:143,width:267,src:"images/imf-logo.png"}]},{xtype:"container",items:[{xtype:"label",text:"Username"},{xtype:"textfield",itemId:"username",width:300}]},{xtype:"container",items:[{xtype:"label",text:"Password"},{xtype:"textfield",itemId:"password",width:300,inputType:"password"}]},{xtype:"container",flex:1,layout:{align:"stretch",type:"vbox"},items:[{xtype:"label",text:"Sitecode"},{xtype:"textfield",disabled:true,itemId:"sitecode",width:300,listeners:{afterrender:{fn:a.onSitecodeAfterRender,scope:a}}}]},{xtype:"button",handler:function(b,c){b.up("#login-form").login()},cls:"login-btn",width:300,text:"Login"}]},{xtype:"container",flex:1,height:600,layout:{type:"fit"},items:[{xtype:"image",src:"./images/kandi-wave.png"}]}],listeners:{afterrender:{fn:a.onFormAfterRender,scope:a}}}],listeners:{beforerender:{fn:a.onImfSiteCodeLoginBeforeRender,scope:a}}});a.callParent(arguments)},onSitecodeAfterRender:function(a,b){var d=document.location.href.split("?")[1];if(d===undefined){a.focus()}else{var c=Ext.Object.fromQueryString(d);a.setValue(c.sc);a.up("#login-form").down("#username").focus(false,500)}},onFormAfterRender:function(a,b){this.keyNav=Ext.create("Ext.util.KeyNav",this.el,{enter:a.login,scope:a})},onImfSiteCodeLoginBeforeRender:function(a,b){this.initializeData();this.checkLoginToken()},initializeData:function(){Ext.Ajax.useDefaultXhrHeader=false;Ext.define("country_data",{singleton:true,id:"",name:""});Ext.define("state_data",{singleton:true,id:"",name:""});Ext.define("district_data",{singleton:true,id:"",name:""});Ext.define("school_data",{singleton:true,id:"",name:""});Ext.define("class_data",{singleton:true,id:"",name:""});Ext.define("student_data",{singleton:true,id:"",name:"",username:""});Ext.define("Ext.chart.theme.Fancy",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#66CC00","#0066cc","#FFFF00","#FF0000"]},a)])}});Ext.define("Ext.chart.theme.WeeklyUsage",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#0088dd","#0088dd"]},a)])}});String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1};this.school_id="";this.district_id="";this.state_id="";this.country_id="";this.school_name="";this.district_name="";this.state_name="";this.country_name="";Ext.define("Ext.chart.theme.FluencyTimeGraph",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#0000ff","#4169E1","#1E90FF","#00BFFF"]},a)])}});Ext.define("Ext.chart.theme.ImprovementChart",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#FF0000","#0066cc"]},a)])}});Ext.Ajax.on("requestexception",function(c,a,b){if(b.retries>0){b.retries-=1;Ext.Ajax.request(b)}});window.showAdditionAndSubtraction=true;district_data.UseLogin=true},checkLoginToken:function(){var b=this;var d=document.location.href.split("?")[1];if(d===undefined){Ext.ComponentQuery.query("#imfSiteCodeLogin")[0].destroy();var a=Ext.create("BigBrainzLauncher.view.BigBrainzMain")}else{var c=Ext.Object.fromQueryString(d);Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/landing/token",params:{token:c.token},success:function(e){var g=Ext.decode(e.responseText);if(g.success){var f="games/launcher/app-all.html";window.history.pushState("Imagine Math Facts","Imagine Math Facts","/"+f);Ext.ComponentQuery.query("#imfSiteCodeLogin")[0].destroy();if(g.type=="student"){b.loginStudent(g)}if(g.type=="school"){b.loginSchool(g)}if(g.type=="district"){b.loginDistrict(g)}}else{if(g.error=="Invalid Token"){Ext.Msg.alert("Session has expired.","Please login again.",function(){window.location.assign("https://mathfacts.imaginelearning.com")})}else{Ext.Msg.alert("Could not log in.","Please try again.",function(){window.location.assign("https://mathfacts.imaginelearning.com")})}}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.")}})}},loginStudent:function(a){student_data.id=a.data[0].id;student_data.name=a.data[0].name;student_data.username=a.data[0].name;school_data.id=a.data[0].school_id;Ext.getStore("GameStore").loadRawData(a);Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+a.data[0].school_id+"/login_info";Ext.getStore("SchoolStore").load({callback:function(){var b=Ext.create("BigBrainzLauncher.view.StudentLoginViewport");BigBrainzLauncher.getApplication().fireEvent("studentSelected",student_data.id)}})},loginSchool:function(b){school_data.id=b.id;school_data.name=b.name;school_data.sitecode=b.sitecode;var a=new Date();var c=new Date(a.getFullYear()+1,a.getMonth(),a.getDay());Ext.util.Cookies.set("__school_id_saved",school_data.id,c);Ext.util.Cookies.set("__school_name_saved",school_data.name,c);Ext.getStore("ClassStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/children";Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/login_info";Ext.getStore("SchoolStore").load({callback:function(e,d,f){Ext.getStore("ClassStore").load({callback:function(h,g,l){var k=Ext.create("BigBrainzLauncher.view.EducatorTreeViewport")}})}})},loginDistrict:function(a){district_data.id=a.id;district_data.name=a.name;Ext.create("BigBrainzLauncher.view.DistrictOverview")}});Ext.define("BigBrainzLauncher.view.Viewport",{extend:"BigBrainzLauncher.view.IMFSiteCodeLogin",renderTo:Ext.getBody()});Ext.define("BigBrainzLauncher.model.CountryModel",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"name"}],validations:[{type:"presence",field:"id"},{type:"presence",field:"name"}]});Ext.define("BigBrainzLauncher.model.ClassModel",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"name"},{name:"email"},{name:"game_count"},{name:"PilotClass"},{name:"SizeLimit"},{name:"m_pretest_taken"},{name:"m_pretest_avg"},{name:"m_posttest_taken"},{name:"m_posttest_avg"},{name:"m_total_hours"},{name:"m_avg_time"},{name:"m_10"},{name:"m_20"},{name:"m_30"},{name:"m_40"},{name:"m_50"},{name:"m_60"},{name:"m_70"},{name:"m_80"},{name:"m_90"},{name:"d_10"},{name:"d_20"},{name:"d_30"},{name:"d_40"},{name:"d_50"},{name:"d_60"},{name:"d_70"},{name:"d_80"},{name:"d_90"},{name:"d_pretest_taken"},{name:"d_pretest_avg"},{name:"d_posttest_taken"},{name:"d_posttest_avg"},{name:"d_total_hours"},{name:"d_avg_time"},{name:"as_pretest_taken"},{name:"as_pretest_avg"},{name:"as_posttest_taken"},{name:"as_posttest_avg"},{name:"as_total_hours"},{name:"as_avg_time"},{name:"as_10"},{name:"as_20"},{name:"as_30"},{name:"as_40"},{name:"as_50"},{name:"as_60"},{name:"as_70"},{name:"as_80"},{name:"as_90"},{name:"PizzaPartyClass"},{name:"grade"},{name:"OperationOrder"},{name:"FriendlyMode",type:"boolean"}]});Ext.define("BigBrainzLauncher.model.TreeModel",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"text"},{name:"leaf"},{name:"cls"},{defaultValue:false,name:"loaded"},{defaultValue:false,name:"expanded"},{name:"Properties"},{name:"icon"},{name:"data"},{name:"OperationOrder"},{name:"FriendlyMode",type:"boolean"}]});Ext.define("BigBrainzLauncher.model.GameDataModel",{extend:"Ext.data.Model",fields:[{name:"weekly_time"},{name:"fact_grid"},{name:"pretest_grid"},{name:"posttest_grid"}]});Ext.define("BigBrainzLauncher.model.DistrictModel",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"name",sortType:"asUCText"},{name:"UseLogin"},{name:"OperationOrder"},{name:"IL_Site_Code"}],validations:[{type:"presence",field:"id"},{type:"presence",field:"name"}]});Ext.define("BigBrainzLauncher.model.StateModel",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"name"}],validations:[{type:"presence",field:"id"},{type:"presence",field:"name"}]});Ext.define("BigBrainzLauncher.model.SchoolModel",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"name"},{name:"Password"},{name:"DefaultStudentPassword"},{name:"status"},{name:"cEmail"},{name:"cName"},{name:"cPhone"},{name:"HasPassword"},{name:"messages_read"},{name:"purchase_status"},{name:"weekly_progress_ta9"},{name:"weekly_progress_addsub"},{name:"weekly_progress_division"},{name:"pretests_ta9"},{name:"posttests_ta9"},{name:"pretests_division"},{name:"posttests_division"},{name:"pretests_addsub"},{name:"posttests_addsub"},{name:"il_school",type:"boolean"},{name:"IndividualLicensesRemaining",type:"int"},{name:"SeparateAdditionSubtraction",type:"boolean"},{name:"averageImprovement"},{defaultValue:0,name:"expirationDate"},{name:"UseLogin",type:"boolean"},{name:"OperationOrder"},{name:"FriendlyMode",type:"boolean"},{name:"IL_Site_Code"}],validations:[{type:"presence",field:"id"},{type:"presence",field:"name"}]});Ext.define("BigBrainzLauncher.model.TestModel",{extend:"Ext.data.Model",fields:[{name:"percent",type:"int"},{name:"value",type:"int"}]});Ext.define("BigBrainzLauncher.view.AddStudentsWindow",{extend:"Ext.window.Window",height:400,itemId:"addStudentsWindow",width:700,layout:{align:"stretch",type:"vbox"},closeAction:"hide",title:"Add Students",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",flex:20,layout:{align:"stretch",type:"hbox"},title:"",items:[{xtype:"gridpanel",flex:1,title:"Preview",columnLines:true,store:"AddGameStore",columns:[{xtype:"gridcolumn",dataIndex:"name",text:"Name",flex:2,editor:{xtype:"textfield"}},{xtype:"gridcolumn",itemId:"username",dataIndex:"username",text:"Username"},{xtype:"gridcolumn",dataIndex:"password",text:"Password",flex:1,editor:{xtype:"textfield"}}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{listeners:{edit:{fn:a.onGridroweditingpluginEdit,scope:a}}})]},{xtype:"panel",flex:1,layout:{type:"fit"},title:"Type in or paste a list of students.",items:[{xtype:"textareafield",fieldLabel:"",emptyText:"Type in or paste a list of students. Unique passwords are not required.  If you DO include unique student passwords use a semicolon to separate student names from their passwords.  i.e. Suzy Smith; susm5",listeners:{change:{fn:a.onAdd_students_textareaChange,scope:a}}}]}]}],dockedItems:[{xtype:"toolbar",flex:1,dock:"bottom",style:"border: solid 1px #99BBE8; margin: 0",ui:"footer",items:[{xtype:"tbspacer",flex:2},{xtype:"button",handler:function(o,c){if("undefined"===typeof(o.up("window").down("textarea").value)||o.up("window").down("textarea").value===""){Ext.MessageBox.alert("Big Brainz","Enter in at least one student name.");return}var g=Ext.getCmp("school_tree").getSelectionModel().getSelection()[0];var h=g.data.id;if(g.isLeaf()){h=g.parentNode.data.id}var n=Ext.getStore("ClassStore").data.items[Ext.getStore("ClassStore").find("id",h)];var e=n.data.SizeLimit;var q=Ext.getStore("GameStore").data.items.length;var f=o.up("window").down("textarea").value.split(/\r\n?|\n/g);var d=f.length;if(d<1){Ext.MessageBox.alert("Big Brainz","Enter in at least one student name.");return}if(e&&(d>e-q)){Ext.MessageBox.show({title:"Could not add students",msg:"Could not add students because you are adding more than the maximum("+e+") is allowed for this class."});return}if(Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining>-1&&(d>Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining)){Ext.MessageBox.show({title:"Could not add students",msg:"Could not add students because your school does not have enough licenses remaining.  Your school can add "+Ext.util.Format.plural(Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining,"more student","more students")+"."});return}if(Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining>-1){Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining-=d}var m=[];for(i=0;i<d;i++){if(f[i]===""){continue}var l=f[i].split(";");if(l[0]===""){continue}var b=l[0];b=b.replace(/\t/g," ");if(!school_data.UseLogin&&!district_data.UseLogin){var p=l[1];if(p===undefined){p=""}else{p=Ext.util.Format.trim(p)}var r={DisplayableName:b,Password:p,ParentID:h};if(school_data.hasOwnProperty("sitecode")){r.IL_Site_Code=school_data.sitecode}m.push(r)}else{var k=l[1];if(k===undefined||k==""){alert("Usernames are required for each student at this school.");return}var p=l[2];if(p===undefined||p==""){alert("Passwords are required for each student at this school.");return}var r={DisplayableName:b,Username:k,Password:p,ParentID:h};if(school_data.hasOwnProperty("sitecode")){r.IL_Site_Code=school_data.sitecode}m.push(r)}}o.up("window").disable();Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/games",params:{new_games:Ext.encode(m)},success:function(s){var t=Ext.decode(s.responseText);o.up("window").enable();if(t.success){setTimeout(function(){var w;var u=Ext.getCmp("school_tree");var v=u.getSelectionModel().getSelection()[0];while(w=u.getRootNode().childNodes[0]){u.getRootNode().removeChild(w)}Ext.getStore("SchoolTreeStore").load({callback:function(){u.getSelectionModel().select(v)}});Ext.getStore("GameStore").load();o.up("window").down("textarea").setValue("");o.up("window").close()},1000)}else{Ext.MessageBox.show({title:"Could not add students",msg:t.error})}},failure:function(){Ext.Msg.alert("Could not add students.  Please try again.");o.up("window").enable()}})},disabled:true,height:50,width:200,text:"Add"},{xtype:"button",handler:function(b,c){b.up("window").close()},height:50,width:200,text:"Cancel"},{xtype:"tbspacer",flex:2}]}],listeners:{destroy:{fn:a.onAdd_students_windowDestroy,scope:a},afterrender:{fn:a.onAddStudentsWindowAfterRender,scope:a}}});a.callParent(arguments)},onGridroweditingpluginEdit:function(e,d,c){var a=this.down("grid").store.data.items;var f="";if(!school_data.UseLogin&&!district_data.UseLogin){for(var b=0;b<a.length;b++){f+=a[b].get("name")+"; "+a[b].get("password")+"\n"}}else{for(var b=0;b<a.length;b++){f+=a[b].get("name")+"; "+a[b].get("username")+"; "+a[b].get("password")+"\n"}}this.down("textarea").setValue(f)},onAdd_students_textareaChange:function(g,f,c,d){this.down("grid").store.removeAll();var b=f.split("\n");var e=b.length;if(e>0){this.down("button").enable()}else{this.down("button").disable()}for(i=0;i<e;i++){if(b[i]===""){continue}var a=b[i].split(";");if(!school_data.UseLogin&&!district_data.UseLogin){if(a[1]===undefined||Ext.util.Format.trim(a[1])===""){a[1]=Ext.getStore("SchoolStore").data.items[0].data.DefaultStudentPassword}game=Ext.create("BigBrainzLauncher.model.GameModel",{name:Ext.util.Format.trim(a[0]),id:i,password:Ext.util.Format.trim(a[1])});this.down("grid").store.add(game)}else{if(a[1]===undefined||Ext.util.Format.trim(a[1])===""){a[1]="Username required"}if(a[2]===undefined||Ext.util.Format.trim(a[2])===""){a[2]="Password required"}game=Ext.create("BigBrainzLauncher.model.GameModel",{name:Ext.util.Format.trim(a[0]),id:i,username:Ext.util.Format.trim(a[1]),password:Ext.util.Format.trim(a[2])});this.down("grid").store.add(game)}}},onAdd_students_windowDestroy:function(a,b){Ext.getStore("AddGameStore").removeAll()},onAddStudentsWindowAfterRender:function(a,b){if(!school_data.UseLogin&&!district_data.UseLogin){a.down("#username").hide();a.down("textarea").emptyText="Type in or paste a list of students. Unique passwords are not required.  If you DO include unique student passwords use a semicolon to separate student names from their passwords.  i.e. Suzy Smith; susm5";a.down("textarea").applyEmptyText()}else{a.down("#username").show();a.down("textarea").emptyText="Type in or paste a list of students with unique usernames and passwords combinations.  Use a semicolon to separate student names, usernames, and passwords.  i.e. Suzy Smith;ssmith;susm5";a.down("textarea").applyEmptyText()}}});Ext.define("BigBrainzLauncher.view.AddClassesWindow",{extend:"Ext.window.Window",height:400,itemId:"addClassesWindow",width:700,layout:{align:"stretch",type:"vbox"},closeAction:"hide",title:"Add Classes",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",flex:20,layout:{align:"stretch",type:"hbox"},title:"",items:[{xtype:"gridpanel",flex:1,id:"add_classes_grid",title:"Preview",columns:[{xtype:"gridcolumn",dataIndex:"name",text:"Class Name",flex:1}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{listeners:{edit:{fn:a.onGridroweditingpluginEdit,scope:a}}})]},{xtype:"panel",flex:1,layout:{type:"fit"},title:"Type in or paste a list of class names",items:[{xtype:"textareafield",id:"add_classes_textarea",fieldLabel:"",emptyText:"Type in or paste a list of classes",listeners:{change:{fn:a.onAdd_students_textareaChange,scope:a}}}]}]}],dockedItems:[{xtype:"toolbar",flex:1,dock:"bottom",style:"border: solid 1px #99BBE8; margin: 0",ui:"footer",items:[{xtype:"tbspacer",flex:2},{xtype:"button",handler:function(g,c){var k=g.up("window");if("undefined"===typeof(Ext.getCmp("add_classes_textarea").value)||Ext.getCmp("add_classes_textarea").value===""){Ext.MessageBox.alert("Big Brainz","Enter in at least one class name.");return}var e=Ext.getCmp("add_classes_textarea").value.split(/\r\n?|\n/g);var d=e.length;if(d<1){Ext.MessageBox.alert("Big Brainz","Enter in at least one class name.");return}var l=[];var h=school_data.id;if(h===""||h===undefined){h=Ext.util.Cookies.get("__school_id_saved")}for(i=0;i<d;i++){if(e[i]===""){continue}var f=e[i];f=f.replace(/\t/g," ");var b={};b.DisplayableName=f;b.ParentID=h;if(school_data.hasOwnProperty("sitecode")){b.sitecode=school_data.sitecode}l.push(b)}k.disable();Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/classes",params:{new_classes:Ext.encode(l)},success:function(m){var n=Ext.decode(m.responseText);if(n.success){setTimeout(function(){var p;var o=Ext.getCmp("school_tree");while(p=o.getRootNode().childNodes[0]){o.getRootNode().removeChild(p)}Ext.getStore("ClassStore").load();Ext.getStore("SchoolTreeStore").load();k.enable();k.down("textarea").setValue("");k.close()},1000)}else{k.enable();Ext.MessageBox.show({title:"Could not add classes",msg:n.error})}},failure:function(){Ext.Msg.alert("Could not add classes.  Please try again.");k.enable()}})},height:50,width:200,text:"Add"},{xtype:"button",handler:function(b,c){b.up("window").down("textarea").setValue("");b.up("window").close()},height:50,width:200,text:"Cancel"},{xtype:"tbspacer",flex:2}]}],listeners:{afterrender:{fn:a.onAdd_classes_windowAfterRender,scope:a},destroy:{fn:a.onAddClassesWindowDestroy,scope:a},hide:{fn:a.onAddClassesWindowHide,scope:a}}});a.callParent(arguments)},onGridroweditingpluginEdit:function(f,e,d){var a=Ext.getCmp("add_classes_grid").store.data.items;var c="";for(var b=0;b<a.length;b++){c+=a[b].get("name")+"\n"}Ext.getCmp("add_classes_textarea").setValue(c)},onAdd_students_textareaChange:function(e,d,a,b){Ext.getCmp("add_classes_grid").store.removeAll();records=d.split("\n");var c=records.length;for(i=0;i<c;i++){if(records[i]===""){continue}_class=Ext.create("BigBrainzLauncher.model.ClassModel",{name:Ext.util.Format.trim(records[i]),id:i});Ext.getCmp("add_classes_grid").store.add(_class)}},onAdd_classes_windowAfterRender:function(a,b){setTimeout(function(){Ext.getCmp("add_classes_textarea").focus();Ext.getCmp("add_classes_grid").store.removeAll()},250)},onAddClassesWindowDestroy:function(a,b){Ext.getStore("AddClassStore").removeAll()},onAddClassesWindowHide:function(a,b){Ext.getCmp("add_classes_grid").store.removeAll()}});Ext.define("BigBrainzLauncher.view.UnlockDeluxeWindow",{extend:"Ext.window.Window",height:576,hidden:false,id:"unlock_deluxe_free_window",width:796,layout:{type:"fit"},title:"Unlock Your Deluxe License",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",layout:{align:"stretch",type:"vbox"},title:"",items:[{xtype:"panel",flex:1,layout:{align:"stretch",type:"hbox"},title:"",items:[{xtype:"container",flex:1,margins:"10",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"checkboxfield",handler:function(c,b){if(Ext.getCmp("cnInput").validate()&&Ext.getCmp("ceInput").validate()&&Ext.getCmp("cpInput").validate()&&Ext.getCmp("contactResponsibleCheckbox").value&&Ext.getCmp("principalAwareCheckbox").value&&Ext.getCmp("runningCheckbox").value&&Ext.getCmp("scheduleCheckbox").value){Ext.getCmp("pilotBtn").enable()}else{Ext.getCmp("pilotBtn").disable()}},flex:1,id:"contactResponsibleCheckbox",fieldLabel:"",boxLabel:"Yes"}]},{xtype:"container",flex:10,layout:{align:"stretch",type:"vbox"},items:[{xtype:"label",flex:1,margins:"10",padding:"20 0 0 0",style:"font-weight:bold;",text:"#1 Is this the person responsible for fluency at your school?"},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"textfield",validator:function(b){if(b===""){return false}else{return true}},flex:1,id:"cnInput",fieldLabel:"",emptyText:"Contact's Name",listeners:{change:{fn:a.onTextfieldChange,scope:a}}},{xtype:"textfield",validator:function(b){if(b===""){return false}else{return true}},flex:1,id:"ceInput",fieldLabel:"",emptyText:"Contact's Email",regex:/^([\w\-\'\-]+)(\.[\w-\'\-]+)*@([\w\-]+\.){1,5}([A-Za-z]){2,4}$/,listeners:{change:{fn:a.onCeInputChange,scope:a}}},{xtype:"textfield",validator:function(b){if(b===""){return false}else{return true}},flex:1,id:"cpInput",fieldLabel:"",emptyText:"Contact's Phone Number",maskRe:/[\(\)\d-]/,listeners:{change:{fn:a.onCpInputChange,scope:a}}}]}]}]},{xtype:"panel",flex:1,layout:{align:"stretch",type:"hbox"},title:"",items:[{xtype:"container",flex:1,margins:"10",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"checkboxfield",handler:function(c,b){if(Ext.getCmp("cnInput").validate()&&Ext.getCmp("ceInput").validate()&&Ext.getCmp("cpInput").validate()&&Ext.getCmp("contactResponsibleCheckbox").value&&Ext.getCmp("principalAwareCheckbox").value&&Ext.getCmp("runningCheckbox").value&&Ext.getCmp("scheduleCheckbox").value){Ext.getCmp("pilotBtn").enable()}else{Ext.getCmp("pilotBtn").disable()}},flex:1,id:"principalAwareCheckbox",fieldLabel:"",boxLabel:"Yes"}]},{xtype:"container",flex:10,margins:"10",layout:{align:"stretch",pack:"center",type:"vbox"},items:[{xtype:"label",flex:1,style:"font-weight:bold;\ncursor:pointer;",text:"#2 Has the Principal watched the â€œPrincipalâ€™s Videoâ€? at http://www.bigbrainz.com/Implementation.php?",listeners:{afterrender:{fn:a.onLabelAfterRender,scope:a}}}]}]},{xtype:"panel",flex:1.13,layout:{align:"stretch",type:"hbox"},title:"",items:[{xtype:"container",flex:1,margins:"10",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"checkboxfield",handler:function(c,b){if(Ext.getCmp("cnInput").validate()&&Ext.getCmp("ceInput").validate()&&Ext.getCmp("cpInput").validate()&&Ext.getCmp("contactResponsibleCheckbox").value&&Ext.getCmp("principalAwareCheckbox").value&&Ext.getCmp("runningCheckbox").value&&Ext.getCmp("scheduleCheckbox").value){Ext.getCmp("pilotBtn").enable()}else{Ext.getCmp("pilotBtn").disable()}},flex:1,id:"runningCheckbox",fieldLabel:"",boxLabel:"Yes"}]},{xtype:"container",flex:10,margins:"10",layout:{align:"stretch",type:"vbox"},items:[{xtype:"label",style:"font-weight:bold;",text:"#3 Is Timez Attack installed and functioning smoothly on your system?"},{xtype:"label",flex:1,text:"(If you need any help, please email support@bigbrainz.com or call us (877) 356-7040!)"}]}]},{xtype:"panel",flex:1.5,layout:{align:"stretch",type:"hbox"},title:"",items:[{xtype:"container",flex:1,margins:"10",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"checkboxfield",handler:function(c,b){if(Ext.getCmp("cnInput").validate()&&Ext.getCmp("ceInput").validate()&&Ext.getCmp("cpInput").validate()&&Ext.getCmp("contactResponsibleCheckbox").value&&Ext.getCmp("principalAwareCheckbox").value&&Ext.getCmp("runningCheckbox").value&&Ext.getCmp("scheduleCheckbox").value){Ext.getCmp("pilotBtn").enable()}else{Ext.getCmp("pilotBtn").disable()}},flex:1,id:"scheduleCheckbox",fieldLabel:"",boxLabel:"Yes"}]},{xtype:"container",flex:10,margins:"10",layout:{align:"stretch",type:"vbox"},items:[{xtype:"label",style:"font-weight:bold;",text:"#4 Have you scheduled enough computer time for students to play 30 minutes per week until finished?"},{xtype:"label",flex:1,padding:"5 0 0 0",text:"(You can obviously adapt this step to your needs, but it's proven far more effective to let one class or grade finish at a time rather than unleashing an entire school at once.)"},{xtype:"textareafield",flex:2,id:"implementaionImput",padding:"20 0 0 0",hideLabel:true,emptyText:"Please share your school's implementation strategy., e.g. 30 minutes every Tuesday for the 5th graders, 4th graders each Wednesday beggining September 17th."}]}]},{xtype:"panel",flex:1.5,layout:{align:"stretch",type:"vbox"},title:"",items:[{xtype:"label",flex:2,id:"deluxe_offer_title",padding:"10 0 0 0",style:'text-align:center;\nfont-size:200%;\nfont-weight:bold;\nfont-family: Calibri, Candara, Segoe, "Segoe UI", Optima, Arial, sans-serif;',text:"Unlock Your Deluxe License"},{xtype:"label",flex:0.6,id:"intro_one",style:"text-align:center",text:"Because you have invested precious dollars in this program, we now share an obligation to ensure your students become fluent."},{xtype:"label",flex:0.6,id:"intro_two",style:"text-align:center",text:"Please follow these 4 simple steps to ensure we accomplish that goal."},{xtype:"label",flex:0.6,id:"intro_three",style:"text-align:center",text:"Teachers will also be invited to unlock their own class.  This feature can be disabled under options if necessary."},{xtype:"label",flex:0.25,style:"text-align:center",text:""}]}],dockedItems:[{xtype:"toolbar",flex:1,dock:"bottom",items:[{xtype:"tbspacer",flex:1},{xtype:"buttongroup",title:"",columns:2,layout:{columns:2,type:"table"},items:[{xtype:"button",handler:function(k,b){var c=school_data.id;var p=Ext.getCmp("cnInput").value;var n=Ext.getCmp("cpInput").value;var q=Ext.getCmp("ceInput").value;var d=Ext.getCmp("implementaionImput").value;var l=new Date().getTime();var e=Math.floor(l/1000);var o=Ext.getStore("SchoolStore");var h=o.data.items[o.find("id",c)];var m="Unlocking School";var r="Please unlock the deluxe version for:  http://james-pc:4567/schools/"+c+"\n\nAlso, here is their implementation strategy: "+d;if(h.data.status=="offer_pilot"){m="Unlocking Free School";r="Please unlock deluxe version for as a pilot:  http://james-pc:4567/schools/"+c+"\n\nAlso, here is their implementation strategy: "+d}Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/emails",params:{to:"jessica@bigbrainz.com",from:q,subject:m,message:r},success:function(s){},failure:function(){}});var g={ItemName:c,Contacts_EmailAddress:q,Contacts_Name:p,Contacts_PhoneNumber:n,UnlockedDateTheir:e,ImplementationStrategy:d};if(h.data.status=="offer_pilot"){g.UnlockedDateOur=e}Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/schools",params:g,success:function(s){if(Ext.getDom("deluxe")){Ext.getDom("deluxe").id="deluxeunlocked";Ext.get("deluxeunlocked").on("click",function(u,v){})}if(Ext.getDom("pilotdeluxe")){Ext.getDom("pilotdeluxe").id="pilotunlocked";Ext.get("pilotunlocked").on("click",function(u,v){})}res=Ext.decode(s.responseText);Ext.getCmp("unlock_deluxe_free_window").destroy();var t='<div style="text-align:center">Congratulations-your Deluxe License is now unlocked!<br />Once your students begin, please ensure they get roughly 30 minutes per week, until they are finished.</div>';if(h.data.status=="offer_pilot"){t='<div styel="text-align:center">Congratulations-you now have a Deluxe â€œPILOT CLASSâ€? with slots for up to 30 students.<br />Please ensure that Pilot students play roughly 30 min each week until finished.<br /><br />(To Pilot our Deluxe Version with more than these 30 students, please call us.)</div>'}Ext.Msg.show({title:"Big Brainz",msg:t,button:Ext.Msg.OK,icon:Ext.Msg.INFO,width:500})},failure:function(){Ext.Msg.alert("Could not unlock deluxe version.  Please try again.")}});if(h.data.status=="offer_pilot"){h.data.status="deluxe";var f="[";f+='{"DisplayableName":"Pilot Class", "PilotClass":"true","SizeLimit":"30", "ParentID":"'+c+'"}';f+="]";Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/classes",params:{new_classes:f},success:function(s){var t=Ext.decode(s.responseText);if(t.success){setTimeout(function(){var v;var u=Ext.getCmp("school_tree");while(v=u.getRootNode().childNodes[0]){u.getRootNode().removeChild(v)}Ext.getStore("ClassStore").load();Ext.getStore("SchoolTreeStore").load()},1000)}else{Ext.MessageBox.show({title:"Could not add classes",msg:t.error})}},failure:function(){Ext.Msg.alert("Could not unlock deluxe version.  Please try again.")}})}},disabled:true,id:"pilotBtn",text:"Unlock Deluxe License"},{xtype:"button",handler:function(b,c){Ext.getCmp("unlock_deluxe_free_window").destroy()},text:"Finish Later"}]},{xtype:"tbspacer",flex:1}]}],listeners:{afterrender:{fn:a.onPanelAfterRender,scope:a}}}]});a.callParent(arguments)},onTextfieldChange:function(d,c,a,b){if(Ext.getCmp("cnInput").validate()&&Ext.getCmp("ceInput").validate()&&Ext.getCmp("cpInput").validate()&&Ext.getCmp("contactResponsibleCheckbox").value&&Ext.getCmp("principalAwareCheckbox").value&&Ext.getCmp("runningCheckbox").value&&Ext.getCmp("scheduleCheckbox").value){Ext.getCmp("pilotBtn").enable()}else{Ext.getCmp("pilotBtn").disable()}},onCeInputChange:function(d,c,a,b){if(Ext.getCmp("cnInput").validate()&&Ext.getCmp("ceInput").validate()&&Ext.getCmp("cpInput").validate()&&Ext.getCmp("contactResponsibleCheckbox").value&&Ext.getCmp("principalAwareCheckbox").value&&Ext.getCmp("runningCheckbox").value&&Ext.getCmp("scheduleCheckbox").value){Ext.getCmp("pilotBtn").enable()}else{Ext.getCmp("pilotBtn").disable()}},onCpInputChange:function(d,c,a,b){if(Ext.getCmp("cnInput").validate()&&Ext.getCmp("ceInput").validate()&&Ext.getCmp("cpInput").validate()&&Ext.getCmp("contactResponsibleCheckbox").value&&Ext.getCmp("principalAwareCheckbox").value&&Ext.getCmp("runningCheckbox").value&&Ext.getCmp("scheduleCheckbox").value){Ext.getCmp("pilotBtn").enable()}else{Ext.getCmp("pilotBtn").disable()}},onLabelAfterRender:function(a,b){a.getEl().on({click:function(c){var d=window.open("/Implementation.php");if(window.focus){d.focus()}return false},scope:a})},onPanelAfterRender:function(d,e){var b="";var a="";var g="";var f=Ext.getStore("SchoolStore").find("id",school_data.id);var c=Ext.getStore("SchoolStore").data.items[f];Ext.getCmp("cnInput").setValue(c.data.cName);Ext.getCmp("ceInput").setValue(c.data.cEmail);Ext.getCmp("cpInput").setValue(c.data.cPhone);if(c.data.status=="offer_pilot"){Ext.getCmp("deluxe_offer_title").setText("Pilot the Deluxe Version");Ext.getCmp("intro_one").setText("Welcome! Our Pilot program will upgrade an entire class, up to 30 students, to our Deluxe Version.");Ext.getCmp("intro_two").setText("Please follow these 4 simple steps to begin your Pilot and ensure it will be successful.");Ext.getCmp("intro_three").setText("Students who play roughly 30 minutes per week will remain unlocked until they finish!")}}});Ext.define("BigBrainzLauncher.view.BigBrainzSetup",{extend:"Ext.window.Window",height:290,hidden:false,id:"setup_school_window",width:492,layout:{type:"fit"},title:"Big Brainz Setup",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",layout:{type:"accordion"},title:"",items:[{xtype:"panel",height:200,collapsed:false,title:"1. Contact Info",items:[{xtype:"container",height:200,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"textfield",validator:function(b){if(b.length<1){return"Required"}return true},id:"name_txt",itemId:"name_text",fieldLabel:"Name",listeners:{change:{fn:a.onName_txtChange,scope:a}}},{xtype:"textfield",validator:function(b){if(b.length<1){return"Required"}return true},id:"role_txt",itemId:"role_txt",fieldLabel:"Role",listeners:{change:{fn:a.onRole_txtChange,scope:a}}},{xtype:"textfield",validator:function(b){if(b.length<1){return"Required."}return true},id:"email_txt",fieldLabel:"Email",regex:/^([\w\-\'\-]+)(\.[\w-\'\-]+)*@([\w\-]+\.){1,5}([A-Za-z]){2,4}$/,listeners:{change:{fn:a.onEmail_txtChange,scope:a}}},{xtype:"textfield",id:"phone_txt",fieldLabel:"Phone #",emptyText:"(optional)",maskRe:/[\(\)\d-]/,listeners:{change:{fn:a.onPhone_txtChange,scope:a}}},{xtype:"container",flex:1,padding:"0 0 0 200",items:[{xtype:"button",handler:function(b,c){Ext.getCmp("password_setup").enable();Ext.getCmp("password_setup").expand()},disabled:true,id:"next_btn",padding:"",text:"Next"}]}]}]},{xtype:"panel",disabled:true,id:"password_setup",collapsed:true,title:"2. Password Setup",items:[{xtype:"container",height:200,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"textfield",validator:function(b){if(b.length<1){return false}return true},id:"edu_pass",fieldLabel:"Educator Password",labelAlign:"right",labelWidth:160,emptyText:"(at least 6 characters)",minLength:6,listeners:{change:{fn:a.onEdu_passChange,scope:a}}},{xtype:"textfield",validator:function(b){if(Ext.getCmp("edu_pass").value!=b){return"Mismatch Passwords"}else{return true}},id:"edu_pass_conf",fieldLabel:"Confirm Educator Password",labelAlign:"right",labelWidth:160,minLength:6,listeners:{change:{fn:a.onEdu_pass_confChange,scope:a}}},{xtype:"textfield",validator:function(b){if(b.length<3){return false}return true},id:"stu_pass",fieldLabel:"Student Password",labelAlign:"right",labelWidth:160,emptyText:"(at least 3 characters)",minLength:3,listeners:{change:{fn:a.onStu_passChange,scope:a}}},{xtype:"textfield",validator:function(b){if(Ext.getCmp("stu_pass").value!=b){return"Mismatch Passwords"}else{return true}},id:"stu_pass_conf",fieldLabel:"Confirm Student Password",labelAlign:"right",labelWidth:160,minLength:3,listeners:{change:{fn:a.onStu_pass_confChange,scope:a}}},{xtype:"container",flex:1,padding:"0 0 0 275",items:[{xtype:"button",handler:function(e,b){var c=Ext.util.Cookies.get("__school_id_saved");var m=Ext.getCmp("name_txt").value;var d=Ext.getCmp("role_txt").value;var l=Ext.getCmp("phone_txt").value;var n=Ext.getCmp("email_txt").value;var f=Ext.getCmp("edu_pass").value;var k=Ext.getCmp("stu_pass").value;var h=new Date().getTime();var g=Math.floor(h/1000);Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/schools",params:{ItemName:c,Contacts_EmailAddress:n,Contacts_Role:d,Contacts_Name:m,Contacts_PhoneNumber:l,Timestamp_PasswordFirstSet:g,DefaultStudentPassword:k,Password:f},success:function(o){school_data.id=c;school_data.name=Ext.util.Cookies.get("__school_name_saved");res=Ext.decode(o.responseText);Ext.getCmp("school_selection_window").destroy();Ext.getCmp("setup_school_window").destroy();var q=Ext.create("BigBrainzLauncher.view.EducatorTreeViewport");var p=Ext.getStore("SchoolStore").data.items[Ext.getStore("SchoolStore").find("id",c)].data;p.cName=m;p.cEmail=n;p.cPhone=l;p.Password=f;p.DefaultStudentPassword=k},failure:function(){Ext.Msg.alert("Could not setup school. Please try again.")}})},disabled:true,id:"finish_btn",text:"Finish"}]}]}]}]}]});a.callParent(arguments)},onName_txtChange:function(d,c,a,b){var e=true;if(!Ext.getCmp("name_txt").validate()){e=false}if(!Ext.getCmp("role_txt").validate()){e=false}if(!Ext.getCmp("email_txt").validate()){e=false}if(!Ext.getCmp("phone_txt").validate()){e=false}if(e){Ext.getCmp("next_btn").enable()}else{Ext.getCmp("next_btn").disable();Ext.getCmp("password_setup").disable()}},onRole_txtChange:function(d,c,a,b){var e=true;if(!Ext.getCmp("name_txt").validate()){e=false}if(!Ext.getCmp("role_txt").validate()){e=false}if(!Ext.getCmp("email_txt").validate()){e=false}if(!Ext.getCmp("phone_txt").validate()){e=false}if(e){Ext.getCmp("next_btn").enable()}else{Ext.getCmp("next_btn").disable();Ext.getCmp("password_setup").disable()}},onEmail_txtChange:function(d,c,a,b){var e=true;if(!Ext.getCmp("name_txt").validate()){e=false}if(!Ext.getCmp("role_txt").validate()){e=false}if(!Ext.getCmp("email_txt").validate()){e=false}if(!Ext.getCmp("phone_txt").validate()){e=false}if(e){Ext.getCmp("next_btn").enable()}else{Ext.getCmp("next_btn").disable();Ext.getCmp("password_setup").disable()}},onPhone_txtChange:function(d,c,a,b){var e=true;if(!Ext.getCmp("name_txt").validate()){e=false}if(!Ext.getCmp("role_txt").validate()){e=false}if(!Ext.getCmp("email_txt").validate()){e=false}if(!Ext.getCmp("phone_txt").validate()){e=false}if(e){Ext.getCmp("next_btn").enable()}else{Ext.getCmp("next_btn").disable()}},onEdu_passChange:function(d,c,a,b){var e=true;if(!Ext.getCmp("edu_pass").validate()){e=false}if(!Ext.getCmp("edu_pass_conf").validate()){e=false}if(!Ext.getCmp("stu_pass").validate()){e=false}if(!Ext.getCmp("stu_pass_conf").validate()){e=false}if(!Ext.getCmp("name_txt").validate()){e=false}if(!Ext.getCmp("role_txt").validate()){e=false}if(!Ext.getCmp("email_txt").validate()){e=false}if(!Ext.getCmp("phone_txt").validate()){e=false}if(e){Ext.getCmp("finish_btn").enable()}else{Ext.getCmp("finish_btn").disable()}},onEdu_pass_confChange:function(d,c,a,b){var e=true;if(!Ext.getCmp("edu_pass").validate()){e=false}if(!Ext.getCmp("edu_pass_conf").validate()){e=false}if(!Ext.getCmp("stu_pass").validate()){e=false}if(!Ext.getCmp("stu_pass_conf").validate()){e=false}if(!Ext.getCmp("name_txt").validate()){e=false}if(!Ext.getCmp("role_txt").validate()){e=false}if(!Ext.getCmp("email_txt").validate()){e=false}if(!Ext.getCmp("phone_txt").validate()){e=false}if(e){Ext.getCmp("finish_btn").enable()}else{Ext.getCmp("finish_btn").disable()}},onStu_passChange:function(d,c,a,b){var e=true;if(!Ext.getCmp("edu_pass").validate()){e=false}if(!Ext.getCmp("edu_pass_conf").validate()){e=false}if(!Ext.getCmp("stu_pass").validate()){e=false}if(!Ext.getCmp("stu_pass_conf").validate()){e=false}if(!Ext.getCmp("name_txt").validate()){e=false}if(!Ext.getCmp("role_txt").validate()){e=false}if(!Ext.getCmp("email_txt").validate()){e=false}if(!Ext.getCmp("phone_txt").validate()){e=false}if(e){Ext.getCmp("finish_btn").enable()}else{Ext.getCmp("finish_btn").disable()}},onStu_pass_confChange:function(d,c,a,b){var e=true;if(!Ext.getCmp("edu_pass").validate()){e=false}if(!Ext.getCmp("edu_pass_conf").validate()){e=false}if(!Ext.getCmp("stu_pass").validate()){e=false}if(!Ext.getCmp("stu_pass_conf").validate()){e=false}if(!Ext.getCmp("name_txt").validate()){e=false}if(!Ext.getCmp("role_txt").validate()){e=false}if(!Ext.getCmp("email_txt").validate()){e=false}if(!Ext.getCmp("phone_txt").validate()){e=false}if(e){Ext.getCmp("finish_btn").enable()}else{Ext.getCmp("finish_btn").disable()}}});Ext.define("BigBrainzLauncher.view.StudentNeedPassword",{extend:"Ext.window.Window",height:220,id:"student_need_password",width:400,title:"Need Password?",initComponent:function(){var a=this;Ext.applyIf(a,{listeners:{beforeadd:{fn:a.onStudent_need_passwordBeforeAdd,scope:a}},items:[{xtype:"container",height:200,layout:{align:"center",type:"vbox"},items:[{xtype:"label",flex:1,id:"contact_intro_label",text:"You will need to contact your school contact person who is"},{xtype:"label",flex:1,id:"contact_info",text:"[Contact Info]"},{xtype:"label",flex:1,id:"contact_ending_label",text:"to get this schools password."}]}]});a.callParent(arguments)},onStudent_need_passwordBeforeAdd:function(b,d,c,e){var g=Ext.util.Cookies.get("__school_id_saved");var a=Ext.getStore("SchoolStore").find("id",g);var f=Ext.getStore("SchoolStore").data.items[a].data;Ext.getCmp("contact_info").setText(f.cName+" at "+f.cEmail)}});Ext.define("BigBrainzLauncher.model.GameModel",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"name"},{name:"progress",type:"int"},{name:"password"},{name:"progress_report"},{name:"to_play_data"},{name:"retest_data"},{name:"username"},{name:"OperationOrder"},{name:"FriendlyMode",type:"boolean"}]});Ext.define("BigBrainzLauncher.view.StartupMessageWindow",{extend:"Ext.window.Window",height:291,id:"startup_message_window",width:813,layout:{align:"center",type:"vbox"},title:"Startup Message",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",flex:1,style:"{font-size:250%;}",text:"Welcome to the newest version of Big Brainz"},{xtype:"container",flex:4,width:731,layout:{type:"vbox"},items:[{xtype:"label",flex:1,text:"1.  If you're starting a new school year, we suggest deleting all your old classes and starting fresh."},{xtype:"label",flex:1,text:"2.  Pasting in your classes and students is quick and easy, but we can also import an Excel or .csv file for you. "},{xtype:"label",flex:1,width:674,text:"3.  Unlock your Deluxe License / Pilot the Deluxe Version / by pressing the red button above and following the simple checklist that will ensure an effective implementation at your school."}]}],dockedItems:[{xtype:"toolbar",flex:1,dock:"bottom",items:[{xtype:"tbspacer",flex:1},{xtype:"tbseparator"},{xtype:"button",handler:function(d,e){var g=Ext.util.Cookies.get("__school_id_saved");var b=Ext.getStore("SchoolStore");var c=Ext.decode(Ext.getStore("SchoolStore").data.items[0].data.messages_read);c.push(0);var f={ItemName:g,messages_read:JSON.stringify(c)};Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/schools",params:f,success:function(h){Ext.getCmp("startup_message_window").destroy()},failure:function(){Ext.Msg.alert("Could not dave preference.  Please try again.")}})},text:"Okay, I've read and understand this"},{xtype:"tbseparator"},{xtype:"button",handler:function(b,c){Ext.getCmp("startup_message_window").destroy()},text:"Remind me next time I log in."},{xtype:"tbseparator"},{xtype:"tbspacer",flex:1}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.ReportErrorWindow",{extend:"Ext.window.Window",height:690,id:"report_error_window",width:670,layout:{align:"center",type:"vbox"},title:"Report Error",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",style:"text-align:center;\r\nfont-weight:bold;\r\nfont-size:200%;",text:"Oops!"},{xtype:"container",height:30},{xtype:"label",style:"text-align:center",text:"Your last internet message didn't go through.  This could be due to a network issue.  If it is a network issue you should close and restart this program in about 5-10 minutes and it should work."},{xtype:"container",height:25},{xtype:"label",style:"text-align:center",text:"If this error pops up every time, you may have a firewall or a filter blocking our communications.  Please email the following report to support@bigbrainz.com:"},{xtype:"container",height:12},{xtype:"textareafield",flex:1,id:"error_report_textarea",width:500,fieldLabel:"",labelWidth:0},{xtype:"container",height:30,width:630,layout:{pack:"end",type:"hbox"},items:[{xtype:"button",handler:function(b,c){Ext.getCmp("report_error_window").close()},text:"Close"}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.LoginWindow",{extend:"Ext.window.Window",statics:{CreateForSchools:function(){var a=Ext.create("BigBrainzLauncher.view.LoginWindow");a.forSchools=true;a.forDistricts=false;a.down("label").setText("This school requires you to use a username and password.");a.setTitle("Login for "+Ext.getStore("SchoolStore").first().get("name"));a.ancestorID=Ext.getStore("SchoolStore").first().get("id");school_data.UseLogin=true;a.show()},CreateForDistricts:function(){var a=Ext.create("BigBrainzLauncher.view.LoginWindow");a.forSchools=false;a.forDistricts=true;a.down("label").setText("This District requires you to use a username and password.");a.setTitle("Login for "+district_data.name);a.ancestorID=district_data.id;school_data.UseLogin=true;a.show()}},height:222,id:"login_window",width:488,layout:{align:"center",pack:"center",type:"vbox"},title:"Login",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",padding:"20 20 0 20",style:"text-align:center;",text:"This district requires you to use a username and password."},{xtype:"label",padding:"5 20 0 20",text:"If you do not have this information, please ask your teacher."},{xtype:"label",padding:"5 20 0 20",text:"Teachers trying to log in to the administrative portal"},{xtype:"label",padding:"5 20 20 20",text:"should use 'school' as their username and their unique school password."},{xtype:"textfield",id:"login_username",fieldLabel:"Username",tabIndex:1},{xtype:"textfield",id:"login_password",fieldLabel:"Password",inputType:"password",tabIndex:2,minLength:1,minLengthText:"Password field must not be blank.",listeners:{specialkey:{fn:a.onLogin_passwordSpecialkey,scope:a}}},{xtype:"container",width:250,layout:{type:"hbox"},items:[{xtype:"container",flex:1},{xtype:"button",login_school:function(b){var c=this.up("window");if(c.forDistricts){Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/school",params:{id:district_data.id,password:b},success:function(d){var f=Ext.decode(d.responseText);if(f.success){if(Ext.getCmp("login_window")===undefined){}else{Ext.getCmp("login_window").destroy()}school_data.id=f.school_id;school_data.name=f.school_name;var e=new Date();var g=new Date(e.getFullYear()+1,e.getMonth(),e.getDay());Ext.util.Cookies.set("__school_id_saved",school_data.id,g);Ext.util.Cookies.set("__school_name_saved",school_data.name,g);Ext.getStore("ClassStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/children";Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/login_info";Ext.getStore("SchoolStore").load({callback:function(k,h,l){Ext.getStore("ClassStore").load({callback:function(n,m,p){var o=Ext.create("BigBrainzLauncher.view.EducatorTreeViewport")}})}})}else{if(f.message.indexOf("Too many")>=0){Ext.Msg.alert("Not a unique password","This district has multiple schools with the same password.<br />To protect student's privacy, each school needs a unique password.<br />Please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776<br />to setup a unique password for your school")}else{Ext.Msg.alert("Could not log in.  Please try again.")}}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}})}else{Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/school/"+c.ancestorID,params:{password:b},success:function(d){var f=Ext.decode(d.responseText);if(f.success){if(Ext.getCmp("login_window")===undefined){}else{Ext.getCmp("login_window").destroy()}school_data.id=f.school_id;school_data.name=f.school_name;var e=new Date();var g=new Date(e.getFullYear()+1,e.getMonth(),e.getDay());Ext.util.Cookies.set("__school_id_saved",school_data.id,g);Ext.util.Cookies.set("__school_name_saved",school_data.name,g);Ext.getStore("ClassStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/children";Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/login_info";Ext.getStore("SchoolStore").load({callback:function(k,h,l){Ext.getStore("ClassStore").load({callback:function(n,m,p){var o=Ext.create("BigBrainzLauncher.view.EducatorTreeViewport")}})}})}else{Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}})}},login_district:function(b){Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/district",params:{id:district_data.id,password:b},success:function(c){var d=Ext.decode(c.responseText);if(d.success){window.setShowAdditionAndSubtraction();if(Ext.getCmp("login_window")===undefined){}else{Ext.getCmp("login_window").destroy()}Ext.getCmp("school_selection_window").destroy();Ext.create("BigBrainzLauncher.view.DistrictOverview")}else{Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}})},tabIndex:3,text:"Login",listeners:{click:{fn:a.onButtonClick,scope:a}}}]},{xtype:"container",width:450,layout:{type:"hbox"},items:[{xtype:"container",flex:1},{xtype:"button",handler:function(b,c){var d=Ext.MessageBox.prompt("District Password","Please enter your district password.  If you don't know it, please call Big Brainz:",function(f,e){if(f=="ok"){Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/district",params:{id:district_data.id,password:e},success:function(g){var h=Ext.decode(g.responseText);if(h.success){Ext.getCmp("login_window").destroy();Ext.create("BigBrainzLauncher.view.DistrictOverview")}else{Ext.Msg.alert("Incorrect Password",h.message);Ext.getCmp("comboSchool").setValue("")}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.");Ext.getCmp("comboSchool").setValue("")}})}else{Ext.getCmp("comboSchool").setValue("")}});d.textField.inputEl.dom.type="password";return},hidden:true,text:"View District Progress"}]}],listeners:{beforeclose:{fn:a.onLogin_windowBeforeClose,scope:a},afterrender:{fn:a.onLogin_windowAfterRender,scope:a}}});a.callParent(arguments)},onLogin_passwordSpecialkey:function(c,b,a){if(b.getKey()==b.ENTER){this.down("button").fireEvent("click",{})}},onButtonClick:function(c,d,b){Ext.define("student_data",{singleton:true,id:"",name:"",username:""});var f=Ext.getCmp("login_username").value;var a=Ext.getCmp("login_password").value;if(f==="district"){this.down("button").login_district(a);return}if(f==="school"){this.down("button").login_school(a);return}Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/student",params:{username:f,password:a,ancestor_id:this.ancestorID},success:function(e){var g=Ext.decode(e.responseText);if(g.success){if(Ext.getCmp("login_window")===undefined){}else{Ext.getCmp("login_window").destroy()}if(Ext.getCmp("school_selection_window")===undefined){}else{Ext.getCmp("school_selection_window").destroy()}student_data.id=g.data[0].id;student_data.name=g.data[0].name;student_data.username=g.data[0].name;school_data.id=g.data[0].school_id;Ext.getStore("GameStore").loadRawData(g);Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+g.data[0].school_id+"/login_info";Ext.getStore("SchoolStore").load({callback:function(){var h=Ext.create("BigBrainzLauncher.view.StudentLoginViewport");BigBrainzLauncher.getApplication().fireEvent("studentSelected",student_data.id)}})}else{Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.","If you need help logging in, please text: 866-457-8776<br />or chat: https://help.imaginelearning.com/, or call 866-457-8776")}})},onLogin_windowBeforeClose:function(a,b){if(this.forSchools){Ext.getCmp("selectSchool").collapse();setTimeout(function(){Ext.getCmp("selectSchool").expand();Ext.getCmp("school_selection_window").show()},500)}else{Ext.getCmp("selectDistrict").expand();Ext.getCmp("school_selection_window").show()}},onLogin_windowAfterRender:function(a,b){setTimeout(function(){a.down("textfield").focus()},100)}});Ext.define("BigBrainzLauncher.view.PizzaPartySignup",{extend:"Ext.window.Window",height:718,id:"PizzaPartySignup",width:815,title:"Pizza Party",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",height:800,layout:{align:"center",type:"vbox"},items:[{xtype:"label",padding:10,style:"font-size:300%;text-align:center;font-weight:bold;",text:"Finish Timez Attackâ€”Get a Pizza Party!"},{xtype:"label",padding:10,style:"font-size:150%;text-align:justify;font-weight:bold;",text:"Big Brainz and Little Caesars have teamed up to help every 3rd-grader in Utah master their multiplication facts this year by giving a free pizza party to the first 3rd-grade class in the school to finish Timez Attack!"},{xtype:"form",height:147,padding:10,width:766,layout:{align:"stretch",pack:"center",padding:"",type:"vbox"},bodyPadding:10,items:[{xtype:"textfield",id:"principal_name",fieldLabel:"Principal Name"},{xtype:"textfield",id:"principal_email",fieldLabel:"Principal Email"},{xtype:"textfield",id:"address",width:600,fieldLabel:"Address to mail pizza party certificate to",labelWidth:250},{xtype:"fieldcontainer",layout:{align:"stretchmax",type:"hbox"},fieldLabel:"",labelAlign:"right",items:[{xtype:"textfield",id:"city",width:266,fieldLabel:"City",labelWidth:50},{xtype:"textfield",id:"state",width:227,fieldLabel:"State",labelAlign:"right",labelWidth:50},{xtype:"textfield",id:"zip",width:230,fieldLabel:"Zip",labelAlign:"right",labelWidth:50}]}],listeners:{afterrender:{fn:a.onFormAfterRender,scope:a}}},{xtype:"form",height:200,id:"class_list_checkbox",width:747,layout:{align:"stretchmax",type:"vbox"},bodyPadding:10,title:"",items:[{xtype:"label",style:"font-size:150%;text-align:center;",width:710,text:"Classes that will need to become fluent:"},{xtype:"label",style:"color:red;text-align:center;",width:710,text:"Please ensure that all 3rd-grade classes are set up and selected before submitting."},{xtype:"container",flex:1,id:"class_list_signup",style:"border-style:solid;\r\nborder-width:1px;",tpl:['<table style="margin-left: auto;margin-right: auto;">','  <tpl for=".">','    <tpl if="(xindex - 1) &lt; (xcount / 2)">',"      <tr>","        <td>",'          <input type="checkbox" id ="{id}_checkbox" /> {name}',"        </td>",'        <tpl if="parent[xindex - 1 + Math.ceil(xcount / 2)] != undefined">','          <td width = "20"></td>',"          <td>",'            <input type="checkbox" id ="{[parent[xindex - 1 + Math.ceil(xcount / 2)].id]}_checkbox" /> {[parent[xindex - 1 + Math.ceil(xcount / 2)].name]} ',"          </td>","        </tpl>      ","      </tr>			","    </tpl>","  </tpl>","</table>"],width:722,autoScroll:true,listeners:{afterrender:{fn:a.onContainerAfterRender,scope:a}}}]},{xtype:"checkboxfield",id:"principal_checkbox",fieldLabel:"",boxLabel:"I am the Principal and we would like to shoot for the pizza party.  Thanks!"},{xtype:"container",minHeight:30,width:778,layout:{align:"stretchmax",pack:"center",type:"hbox"},items:[{xtype:"button",handler:function(k,c){var d=Ext.getCmp("principal_name").value;var l=Ext.getCmp("principal_email").value;var m=Ext.getCmp("address").value;var g=Ext.getCmp("city").value;var b=Ext.getCmp("state").value;var e=Ext.getCmp("zip").value;if(d===""||l===""||m===""||g===""||b===""||e===""||d===undefined||l===undefined||m===undefined||g===undefined||b===undefined||e===undefined){Ext.Msg.show({title:"Big Brainz",msg:"Oops, we're missing some contact info.",buttons:Ext.Msg.OK,animEl:"elId"});return}var h=[];Ext.each(Ext.query("input[id^=BB]"),function(p){if(p.checked){h.push(p.id.substring(0,p.id.length-9));var q=p.id.substring(0,p.id.length-9);var o=Ext.getStore("SchoolTreeStore").getNodeById(q);var n=Ext.get(Ext.getCmp("school_tree").view.getNode(o));Ext.get(n.id).addCls("pizzaclassred")}});if(h.length<1){Ext.Msg.show({title:"Big Brainz",msg:"Oops, please select all your 3rd-grade classes.",buttons:Ext.Msg.OK,animEl:"elId"});return}if(h.length<1){Ext.Msg.show({title:"Big Brainz",msg:"Oops, please confirm that you are the principal.",buttons:Ext.Msg.OK,animEl:"elId"});return}if(!Ext.getCmp("principal_checkbox").checked){Ext.Msg.show({title:"Big Brainz",msg:"Please check off that you are the principal of this school.",buttons:Ext.Msg.OK,animEl:"elId"});return}var f={};f.id=school_data.id;f.school_name=school_data.name;if(f.school_name===""){f.school_name=Ext.util.Cookies.get("__school_name_saved")}f.name=d;f.email=l;f.address=m;f.city=g;f.state=b;f.zip=e;f.class_ids=Ext.encode(h);Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/pizzapartysignup",params:f,callback:function(o,p,n){if(!p){}else{Ext.getDom("pizza").id="deluxeunlocked";Ext.Msg.show({title:"Big Brainz",msg:"Congratulations--You're on your way to a pizza party!",buttons:Ext.Msg.OK,animEl:"elId"});Ext.getCmp("PizzaPartySignup").close()}}})},text:"Submit"},{xtype:"container",width:30},{xtype:"button",handler:function(b,c){Ext.getCmp("PizzaPartySignup").close()},text:"Cancel"}]},{xtype:"label",padding:"10 0 0 0",style:"font-size:90%",text:"DETAILS AND CUSTOMIZATION"},{xtype:"label",padding:"0 10 10 10",style:"font-size:90%;text-align:justify;",text:"Little Caesars is donating a pizza party for one 3rd-grade class to invited schools only. Consolation parties for the other classes are strongly encouraged, but are at your own discretion. You may adapt these requirements as you see fit if some students in the class have special needs. Also, if you are still targeting fluency in 4th-grade you may switch these requirements to that grade. When youâ€™re done, call Big Brainz (877) 356-7040 to verify your success and claim your pizza certificates. This promotion assumes normal class sizes of roughly 20 to 30 students. Please allow 2 to 4 weeks for processing your pizza certificates before the end of the school year. Schools will be responsible for picking up the pizzas from participating franchises, so please double-check that there is a Little Caesars close enough to you."}]}]});a.callParent(arguments)},onFormAfterRender:function(b,c){var a="routes/routes.php?url=/pizzapartysignup/"+school_data.id+"&method=get";Ext.Ajax.request({method:"GET",url:a,success:function(d){var e=Ext.decode(d.responseText);Ext.getCmp("principal_name").setValue(e.principal_name);Ext.getCmp("principal_email").setValue(e.principal_email);Ext.getCmp("address").setValue(e.address);Ext.getCmp("city").setValue(e.city);Ext.getCmp("state").setValue(e.state);Ext.getCmp("zip").setValue(e.zip)}})},onContainerAfterRender:function(b,d){var e=[];var a=Ext.getStore("ClassStore");var f=a.data.items.length;for(var c=0;c<f;c++){e.push({id:a.data.items[c].data.id,name:a.data.items[c].data.name})}Ext.getCmp("class_list_signup").update(e)}});Ext.define("BigBrainzLauncher.model.SubjectModel",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"name"},{name:"appid"}]});Ext.define("BigBrainzLauncher.view.WeeklyUsageGraph",{extend:"Ext.container.Container",alias:"widget.WeeklyUsageGraph",itemId:"usageChart",layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",style:"text-align:center;font-size:200%;font-style:normal",text:"Weekly Usage (All Operations)"},{xtype:"chart",flex:1,animate:true,insetPadding:20,store:"WeeklyProgressStore",theme:"WeeklyUsage",axes:[{type:"Category",fields:["date"],label:{renderer:function(b){if(this.date_seen===undefined){this.date_seen=[]}if(this.month_seen===undefined){this.month_seen=[]}monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var c=b.split("/");if(this.date_seen.indexOf(b)===-1){this.date_seen.push(b);return""}else{if(this.month_seen.indexOf(c[1])===-1){this.month_seen.push(c[1]);return monthNames[c[1]-1]}else{return""}}}},position:"bottom"},{type:"Numeric",title:"# of Operations",decimals:0,position:"left"}],legend:{position:"float",x:90,y:-15},series:[a.processofOperationsFluentPlaying({type:"area",renderer:function(f,b,d,e,c){return Ext.apply(d,{fill:"#66CC00"})},highlight:true,tips:{trackMouse:true,width:185,height:55,renderer:function(g,f){var e=["January","February","March","April","May","June","July","August","September","October","November","December"];var c="f";var h=g.data[c];var b="students";if(h===1){b="student"}if(Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id()==="all"){b="operations";if(h===1){b="operation"}}var d=g.data.timestamp;d=e[d.getMonth()]+" "+d.getDate();var k="";switch(c){case"f":k=h+" "+b+" finished by<br />"+d;break;case"p":k=(h+g.data.np)+" "+b+" playing <br /> on the week of<br />"+d;break;case"np":k=(h+g.data.p)+" "+b+" playing <br /> on the week of<br />"+d;break}this.setTitle(k)}},title:["# of Operations Fluent","Playing"],xField:"timestamp",yField:["f","0"]}),a.processMyColumnSeries({type:"column",showInLegend:false,tips:{trackMouse:true,width:200,height:55,renderer:function(g,f){var e=["January","February","March","April","May","June","July","August","September","October","November","December"];var c=f.yField;if(g.data===undefined){return}var h=g.data[c];var b="students";if(h===1){b="student"}if(Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id()==="all"){b="operations";if(h===1){b="operation"}}var d=g.data.timestamp;d=e[d.getMonth()]+" "+d.getDate();var k="";switch(c){case"f":k=h+" "+b+" finished by<br />"+d;break;case"p":k=(h+g.data.np)+" "+b+" playing <br /> on the week of<br />"+d;break;case"np":k=(h+g.data.p)+" "+b+" playing <br /> on the week of<br />"+d;break}this.setTitle(k)}},axis:"left",xField:"timestamp",yField:["p","np"],stacked:true})],listeners:{refresh:{fn:a.onChartRefresh,scope:a}}}]});a.callParent(arguments)},processofOperationsFluentPlaying:function(a){a.getLegendColor=function(b){var c=["#0088dd","#66CC00"];return c[(b+1)%c.length]};return a},processMyColumnSeries:function(a){return a},onChartRefresh:function(b,a){b.axes.items[0].label.date_seen=[];b.axes.items[0].label.month_seen=[]}});Ext.define("BigBrainzLauncher.view.AvgerageImprovementGraphs",{extend:"Ext.container.Container",alias:"widget.avgerageimprovementgraphs",itemId:"",width:400,layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",style:"text-align:center;font-size:200%;font-style:normal",text:"Average Pre/Post Test"},{xtype:"chart",flex:1,height:270,itemId:"improvementChart",width:400,animate:true,store:"AverageImprovementStore",theme:"ImprovementChart",axes:[{type:"Category",fields:["grade"],label:{renderer:function(b){var c=b+"th";if(b===3){c=b+"rd"}if(b===2){c=b+"nd"}if(b===1){c=b+"st"}if(b==="K"){c=b}if(b==="all"){c="All"}return c}},position:"bottom"},{type:"Numeric",fields:["pretest_avg","posttest_avg"],title:"",maximum:100,minimum:0,position:"left"}],series:[{type:"column",highlight:true,label:{field:["pretest_avg","posttest_avg"],display:"middle",renderer:function(b){if(b>0){return b+"%"}return""},color:"#333",font:"14px Helvetica, sans-serif"},tips:{trackMouse:true,width:225,height:35,renderer:function(d,c){var b=c.yField;if(d.data===undefined){return}var e=d.data[b.split("_")[0]+"_count"];var f=Ext.util.Format.plural(e,"student","students")+" for an average of "+d.data[b]+"%";if(Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id()==="all"){f=Ext.util.Format.plural(e,"operation","operations")+" for an average of "+d.data[b]+"%"}this.setTitle(f)}},title:"['Pre-Test Averages', 'Post-Test Averages']",xField:"grade",yField:["pretest_avg","posttest_avg"]}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.PretestGraph",{extend:"Ext.container.Container",alias:"widget.pretestgraph",height:250,itemId:"pretestChart",width:400,layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",style:"text-align:center;font-size:200%;font-style:normal",text:"Pre-Test Scores"},{xtype:"chart",flex:1,height:250,width:450,animate:true,insetPadding:20,store:"PretestChartStore",axes:[{type:"Category",fields:["percent"],label:{renderer:function(b){return b+"%"}},position:"bottom"},{type:"Numeric",fields:["value"],majorTickSteps:7,title:"# of Operations",decimals:0,minimum:0,position:"left"}],series:[{type:"column",renderer:function(f,b,d,e,c){return Ext.apply(d,{fill:"#ff0000"})},tips:{trackMouse:true,width:100,height:28,renderer:function(d,c){var b="students";if(d.get("value")=="1"){b="student"}if(Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id()==="all"){b="operations";if(d.get("value")=="1"){b="operation"}}this.setTitle(d.get("value")+" "+b+".")}},xField:"percent",yField:"value"}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.PosttestGraph",{extend:"Ext.container.Container",alias:"widget.posttestgraph",height:250,itemId:"posttestChart",width:400,layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",style:"text-align:center;font-size:200%;font-style:normal",text:"Post-Test Scores"},{xtype:"chart",flex:1,height:250,width:450,animate:true,insetPadding:20,store:"PosttestChartStore",axes:[{type:"Category",fields:["percent"],label:{renderer:function(b){return b+"%"}},position:"bottom"},{type:"Numeric",fields:["value"],majorTickSteps:7,title:"# of Operations",decimals:0,minimum:0,position:"left"}],series:[{type:"column",renderer:function(f,b,d,e,c){return Ext.apply(d,{fill:"#0066cc"})},tips:{trackMouse:true,width:100,height:28,renderer:function(d,c){var b="students";if(d.get("value")=="1"){b="student"}if(Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id()==="all"){b="operations";if(d.get("value")=="1"){b="operation"}}this.setTitle(d.get("value")+" "+b+".")}},xField:"percent",yField:"value"}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.OverviewReportGrid",{extend:"Ext.container.Container",alias:"widget.overviewreportgrid",layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"progressbar",itemId:"overviewReportGridProgressBar"},{xtype:"gridpanel",renderNumber:function(b){if(b<1){return""}return b},renderPercentage:function(b){if(b<1||b===""){return""}return b+"%"},colorCell:function(h,f,c,b,e,k,g){if(h===0){return""}var d=this.get_color(h,f,k,g);setTimeout(function(){var n=c.getNode(b);try{var l=Ext.fly(Ext.fly(n).query(".x-grid-cell")[e]).down("div");try{l.dom.style.setProperty("background-color","#"+d)}catch(m){l.dom.style.backgroundColor="#"+d}}catch(m){return}},50)},get_color:function(b,o,c,h){if(b===0||b===" "||b===""){return""}c=typeof c!=="undefined"?c:[255,255,255];h=typeof h!=="undefined"?h:[0,176,240];var m=(b/o)*100;if(m>100){m=100}var r=(h[0]-c[0])/100;var q=(h[1]-c[1])/100;var e=(h[2]-c[2])/100;var d=Math.floor(c[0]+m*r);var g=Math.floor(c[1]+m*q);var p=Math.floor(c[2]+m*e);var l=pad(d.toString(16),2);var n=pad(g.toString(16),2);var k=pad(p.toString(16),2);var f=l+n+k;return f},toHTMLTable:function(){var e="";var f=this.getStore().data.length;for(var b=0;b<=Math.floor(f/30);b++){var h='<table style = "margin: 0 auto;" border = "1" cellpadding="0" cellspacing="0">';var d=this.columns;h+=c(d);h+=g(this.getStore(),d,this,b);h+="</table>";if(b<Math.floor(f/30)){h+='<div class="page-break"></div>'}e+=h}return e;function c(l){var m=l.length;var n="<tr>";for(var k=0;k<m;k++){if(k>=3&&k<=11){continue}n+="<th>"+l[k].text+"</th>"}n+="</tr>";return n}function g(w,n,k,t){var q=n.length;var y="";var m=0;for(var s=t*30;s<t*30+30;s++){if(k.store.data.items.length<=s){break}var p=k.store.data.items[s];var u="gray";if(m%1===0){u="white"}m+=1;var x='<tr style = "bgcolor:'+u+';" >';var l=p.data.pretest_taken;for(var v=0;v<q;v++){if(v>=3&&v<=11){continue}x+='<td style = "';if(v==13){var o=k.get_color(p.data[k.columns[v].dataIndex],l);x+="background-color:#"+o+";"}if(v===14){var o=k.get_color(p.data[k.columns[v].dataIndex],100,[255,255,255],[102,204,0]);x+="background-color:#"+o+";"}if(v===0){x+='">'}else{x+='text-align:center;">'}var r=p.data[k.columns[v].dataIndex];if(v==12){r=Ext.get("summary-"+p.data.id).dom.innerHTML}if(r===0||r===-1||r==="0:00"){r="&nbsp;"}if(r===null){r="&nbsp;"}if(r===undefined){r="&nbsp;"}if(v!=12){x+=Ext.util.Format.ellipsis(r,15)}else{x+=r}if((v===2||v===14)&&r!=="&nbsp;"){x+="%"}x+="</td>"}x+="</tr>";y+=x}return y}},print:function(){var e=document.createElement("form");e.target="";e.method="POST";e.action="routes/routes.php?url=/pdf";e.appendChild(b("method","post"));var c=cb=Ext.ComponentQuery.query("#reportYearSelector")[0].valueModels[0].data.field2;if(c=="CurrentYear"){c="2017-2018"}e.appendChild(b("name",Ext.getStore("SchoolStore").data.items[0].data.name+" "+c));e.appendChild(b("html",escape(this.toHTMLTable())));e.appendChild(b("svg",escape(Ext.encode(f()))));var d=Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id();if(d=="all"){d="Summary"}if(d=="ta9"){d="Multiplication"}if(d=="division"){d="Division"}if(d=="addition"){d="Addition"}if(d=="subtraction"){d="Subtraction"}e.appendChild(b("appid",d));document.body.appendChild(e);e.submit();function b(h,k){var g=document.createElement("input");g.type="text";g.name=h;g.value=k;return g}function f(){var h=Ext.ComponentQuery.query("chart");var l=h.length;var k=[];var g={};g.heading="Usage";g.graphs=[Ext.ComponentQuery.query("#usageChart")[0].down("chart").save()];k.push(g);g={};g.heading="Average Pre/Post Test";g.graphs=[Ext.ComponentQuery.query("#improvementChart")[0].save()];k.push(g);g={};g.heading="Pretest";g.graphs=[Ext.ComponentQuery.query("#pretestChart")[0].down("chart").save()];k.push(g);g={};g.heading="Posttest";g.graphs=[Ext.ComponentQuery.query("#posttestChart")[0].down("chart").save()];k.push(g);return k}},flex:1,itemId:"overviewReportGrid",autoScroll:true,title:"",store:"DistrictReportStore",columns:[{xtype:"gridcolumn",id:"region_text_name",dataIndex:"name",text:"School"},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){return this.renderNumber(g)},width:65,align:"center",dataIndex:"pretest_taken",text:"Pretest<br />Taken"},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){return this.renderPercentage(g)},width:65,align:"center",dataIndex:"pretest_avg",text:"Pretest<br />Avg"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},hidden:true,width:35,align:"center",dataIndex:"_10",text:"10%"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},hidden:true,width:35,align:"center",dataIndex:"_20",text:"20%"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},hidden:true,width:35,align:"center",dataIndex:"_30",text:"30%"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},hidden:true,width:35,align:"center",dataIndex:"_40",text:"40%"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},hidden:true,width:35,align:"center",dataIndex:"_50",text:"50%"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},hidden:true,width:35,align:"center",dataIndex:"_60",text:"60%"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},hidden:true,width:35,align:"center",dataIndex:"_70",text:"70%"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},hidden:true,width:35,align:"center",dataIndex:"_80",text:"80%"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},hidden:true,width:35,align:"center",dataIndex:"_90",text:"90%"},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){return'<div id = "summary-'+c.get("id")+'"></div>'},align:"center",renderTpl:['<div id="{id}-titleEl" {tipMarkup}class="x-column-header-inner"><span style = "width:100%;" id="{id}-textEl" class="x-column-header-text{childElCls}">{text}</span><tpl if="!menuDisabled"><div id="{id}-triggerEl" class="x-column-header-trigger{childElCls}"></div></tpl></div>{%this.renderContainer(out,values)%}'],text:"<table style = 'text-align:center;width:100%;'><tr><td style = 'width:90%;font-size:1.5em;'>Instant Overview</td><td><table id='legendPopupText' onmouseenter = \"BigBrainzLauncher.getApplication().getController('OverviewReportGrid').popupLegend();\"><tr><td><div style = 'width:15px;background-color:rgb(0,102,203);float:left;'>&nbsp;</div></td><td><div style = 'width:15px;background-color:rgb(0,255,0);float:left;'>&nbsp;</div></td><td><button onclick = \"BigBrainzLauncher.getApplication().getController('OverviewReportGrid').showLegend()\">Legend</button></td></tr></table></td></tr></table>",flex:1},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=Ext.getStore("DistrictReportStore").data.items[k].data.pretest_taken;this.colorCell(h,g,b,c,f);return this.renderNumber(h)},width:65,align:"center",dataIndex:"posttest_taken",text:"Posttest<br />Taken"},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){this.colorCell(g,100,b,c,f,[255,255,255],[102,204,0]);return this.renderPercentage(g)},width:65,align:"center",dataIndex:"posttest_avg",text:"Posttest<br />Avg"},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){if(g==""||g<0){return""}return g+"%"},width:92,align:"center",dataIndex:"avg_improvement",text:"Average<br />Improvement"},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){if(g===0){return""}return Math.round(g).toString()+"%"},hidden:true,width:65,align:"center",dataIndex:"progressPerHour",text:"Progress<br />Per Hour"},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){if(g=="0:00"||g==0){return this.renderNumber()}return g},width:65,align:"center",dataIndex:"total_hours",text:"Total<br />Hours"},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){if(g=="0:00"||g==0){return this.renderNumber()}return g},width:65,align:"center",dataIndex:"avg_hours",text:"Avg<br />Hours"}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.StudentReportPage",{extend:"Ext.container.Container",alias:"widget.studentreportpage",hidden:true,itemId:"studentReportPage",autoScroll:true,layout:{type:"fit"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",itemId:"studentReportPageData",items:[{xtype:"container",height:250,layout:{align:"center",type:"vbox"},items:[{xtype:"container",height:150,html:"<div id = 'play_game' align='center'>  \r\n  <img src=\"images/Button_PlayMultiplication_150.png\" onmouseover=\"this.src='images/Button_PlayMultiplicationHover_150.png'\" onmouseout=\"this.src='images/Button_PlayMultiplication_150.png'\"/>\r\n</div>",width:300,layout:{align:"stretch",type:"vbox"}},{xtype:"label",hidden:true,id:"new_york_proxy_label",itemId:"newYorkProxyLabel",style:"color:red;",text:"Please note that many New York Schools have proxies that may interfere with gameplay.  We can quickly solve this problem if you call us at (877) 356-7040"}]},{xtype:"container",itemId:"studentMinutesChart",layout:{align:"stretch",type:"hbox"},items:[{xtype:"chart",height:250,width:400,animate:true,insetPadding:20,store:"StudentWeeklyMinutes",axes:[{type:"Category",fields:["week_number"],title:"Date",position:"bottom"},{type:"Numeric",fields:["minutes"],title:"Minutes Played",position:"left"}],series:[{type:"area",xField:"week_number",yField:"minutes"}]},{xtype:"chart",flex:1,data:[],height:300,width:500,animate:true,insetPadding:20,store:"ProgressGaugeStore",axes:[{position:"gauge",type:"Gauge",label:{renderer:function(b){return b+"%"}},margin:8,maximum:100,minimum:0}],series:[{type:"gauge",angleField:"progress",donut:50}]}]},{xtype:"tabpanel",activeTab:0,items:[{xtype:"panel",layout:{type:"hbox"},title:"Pretest",items:[{xtype:"container",width:250,layout:{columns:2,type:"table"},items:[{xtype:"container",items:[{xtype:"image",src:"images/FactProgressButton80_Green.png"}]},{xtype:"container",items:[{xtype:"label",text:"Correct"}]},{xtype:"container",items:[{xtype:"image",itemId:"partialImage",src:"images/FactProgressButton80_Yellow.png"}]},{xtype:"container",itemId:"",items:[{xtype:"label",html:"Correct, but will review because<br />inverse pair was missed",itemId:"partialLabel"}]},{xtype:"container",itemId:"missedImage",items:[{xtype:"image",src:"images/FactProgressButton80_Red.png"}]},{xtype:"container",items:[{xtype:"label",itemId:"missedLabel",text:"Missed"}]}]},{xtype:"container",flex:1,id:"pretest_grid_tpl",tpl:['<table class = "progressGrid">','  <tpl for=".">',"    <tr>",'      <tpl for=".">','        <td class = "{status}">{fact}</td>',"      </tpl>","    </tr>","  </tpl>","</table>  "]}]},{xtype:"panel",layout:{type:"hbox"},title:"Progress",items:[{xtype:"container",width:250,layout:{columns:2,type:"table"},items:[{xtype:"container",items:[{xtype:"image",src:"images/FactProgressButton80_Green.png"}]},{xtype:"container",items:[{xtype:"label",text:"Passed"}]},{xtype:"container",hidden:true,items:[{xtype:"image",src:"images/FactProgressButton80_Blue.png"}]},{xtype:"container",hidden:true,items:[{xtype:"label",text:"Ready to pass off"}]},{xtype:"container",items:[{xtype:"image",src:"images/FactProgressButton80_Yellow.png"}]},{xtype:"container",items:[{xtype:"label",text:"In progress"}]},{xtype:"container",items:[{xtype:"image",src:"images/FactProgressButton80_Red.png"}]},{xtype:"container",items:[{xtype:"label",text:"Missed"}]}]},{xtype:"container",flex:1,id:"progress_grid_tpl",tpl:['<table class = "progressGrid">','  <tpl for=".">',"    <tr>",'      <tpl for=".">','        <td class = "{status}">{fact}</td>',"      </tpl>","    </tr>","  </tpl>","</table>  "]}]},{xtype:"panel",layout:{type:"hbox"},title:"Posttest",items:[{xtype:"container",width:250,layout:{columns:2,type:"table"},items:[{xtype:"container",items:[{xtype:"image",src:"images/FactProgressButton80_Green.png"}]},{xtype:"container",items:[{xtype:"label",text:"Passed"}]},{xtype:"container",items:[{xtype:"image",src:"images/FactProgressButton80_Red.png"}]},{xtype:"container",items:[{xtype:"label",text:"Missed"}]}]},{xtype:"container",flex:1,id:"posttest_grid_tpl",tpl:['<table class = "progressGrid">','  <tpl for=".">',"    <tr>",'      <tpl for=".">','        <td class = "{status}">{fact}</td>',"      </tpl>","    </tr>","  </tpl>","</table>  "]}]}]}]},{xtype:"container",hidden:true,itemId:"selectSubjectExplaination",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"label",style:"{\r\n  font-weight:bold;\r\n}",text:"Please select a subject to view a detailed report of this student."}]}]});a.callParent(arguments)},print:function(){var f=document.createElement("form");f.target="";f.method="POST";f.action="routes/routes.php?url=/pdf";f.appendChild(a("method","post"));f.appendChild(a("type","student"));var c=d();f.appendChild(a("name",c.data.name));var e=Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id();if(e=="all"){e="Summary"}if(e=="ta9"){e="Multiplication"}if(e=="division"){e="Division"}if(e=="addition"){e="Addition"}if(e=="subtraction"){e="Subtraction"}f.appendChild(a("appid",e));var b={};b.pretest=Ext.getCmp("pretest_grid_tpl").data;b.progress=Ext.decode(Ext.getStore("GameDataStore").data.items[0].data.fact_grid)[Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id()];b.posttest=Ext.getCmp("posttest_grid_tpl").data;b=Ext.encode(b).replace(/&divide;/g,"/");f.appendChild(a("data",b));document.body.appendChild(f);f.submit();function a(h,k){var g=document.createElement("input");g.type="text";g.name=h;g.value=k;return g}function d(){var g=Ext.getCmp("school_tree").getSelectionModel().getSelection()[0].data.id;var h=Ext.getStore("GameStore").data.findBy(function(k,l){if(k.data.id===g){return true}else{return false}});return h}}});Ext.define("BigBrainzLauncher.view.FluencyTimeGraph",{extend:"Ext.container.Container",alias:"widget.fluencytimegraph",layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",style:"text-align:center;font-size:200%;font-style:normal",text:"Current Fluency & Time Invested"},{xtype:"chart",flex:1,animate:true,insetPadding:20,store:"FluencyTimeStore",theme:"FluencyTimeGraph",axes:[{type:"Category",fields:["percent_complete"],title:"",position:"bottom"},{type:"Numeric",fields:["greather_than_360","between_180_360","between_60_180","less_than_60"],title:"# of Students",decimals:0,maximum:200,minimum:0,position:"left"}],series:[{type:"column",highlight:true,tips:{trackMouse:true,width:100,height:28,renderer:function(d,c){var b="students";if(c.value[1]===1){b="student"}this.setTitle(c.value[1]+" "+b)}},title:["Played < 1 Hour","Played 1-3 Hours","Played 3-6 Hours","Played > 6 Hours"],xField:"date",yField:["less_than_60","between_60_180","between_180_360","greather_than_360"],stacked:true}],legend:{position:"float",x:90,y:-15}}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.DeleteMultipleWindow",{extend:"Ext.window.Window",height:500,itemId:"deleteMultipleWindow",minHeight:300,width:400,layout:{type:"fit"},closeAction:"hide",title:"Delete Multiple Students",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{dockedItems:[{xtype:"toolbar",dock:"top",style:"border: solid 1px #99BBE8; margin: 0;background-color:#D9E5F3;",ui:"footer",items:[{xtype:"button",itemId:"deleteMultipleBtn",text:"Delete"}]}],items:[{xtype:"gridpanel",itemId:"multipleDeletionGrid",autoScroll:true,store:"ClassStore",columns:[{xtype:"gridcolumn",dataIndex:"name",text:"Name",flex:1}],selModel:Ext.create("Ext.selection.CheckboxModel",{})}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.ImportClassWindow",{extend:"Ext.window.Window",height:584,hidden:false,itemId:"importClassWindow",width:786,layout:{align:"stretch",type:"vbox"},closeAction:"hide",title:"Class List Importer",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",flex:20,layout:{align:"stretch",type:"hbox"},title:"",items:[{xtype:"gridpanel",flex:1,id:"import_grid",title:"Preview",columnLines:true,store:"ImportClassListStore",columns:[{xtype:"gridcolumn",dataIndex:"class_name",text:"Class Name",flex:1,editor:{xtype:"textfield"}},{xtype:"gridcolumn",dataIndex:"student_name",text:"Student Name",flex:1,editor:{xtype:"textfield"}},{xtype:"gridcolumn",itemId:"username",dataIndex:"username",text:"Username",flex:1,editor:{xtype:"textfield"}},{xtype:"gridcolumn",dataIndex:"password",text:"Password",flex:1,editor:{xtype:"textfield"}}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{listeners:{edit:{fn:a.onGridroweditingpluginEdit,scope:a}}})]},{xtype:"panel",flex:1,layout:{type:"fit"},title:"Class List",items:[{xtype:"textareafield",id:"add_students_textarea",fieldLabel:"",emptyText:"<class name>;<student name>;<password>",listeners:{change:{fn:a.onAdd_students_textareaChange,scope:a}}}]}]}],dockedItems:[{xtype:"toolbar",flex:1,dock:"bottom",style:"border: solid 1px #99BBE8; margin: 0",ui:"footer",items:[{xtype:"tbspacer",flex:2},{xtype:"button",handler:function(d,b){var h=Ext.getStore("ImportClassListStore");if(!c(h)){Ext.MessageBox.alert("Big Brainz","Enter in at least one student name.");return}if(f(h)){Ext.MessageBox.show({title:"Could not add students",msg:"Could not add students because your school does not have enough licenses remaining.  Your school can add "+Ext.util.Format.plural(Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining,"more student","more students")+"."});return}var l={};h.each(function(n){var p=n.get("class_name");var m=n.get("student_name");var o=n.get("password");var q=n.get("username");if(p===""){return}if(m===""){return}m=m.replace(/\t/g," ");if(l[p]===undefined){l[p]=[]}if(!school_data.UseLogin&&!district_data.UseLogin){if(o===undefined||o==="default"){o=""}else{o=Ext.util.Format.trim(o)}l[p].push([m,o])}else{if(o===""){return}if(q===""){return}l[p].push([m,q,o])}});var k=[];for(class_name in l){k.push(class_name)}var e=this.up("window");e.disable();if(!school_data.UseLogin&&!district_data.UseLogin){this.import_list(k,l,g)}else{this.import_list_with_username(k,l,g)}function c(m){return m.count()>0}function f(m){return(Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining>-1&&(m.count()>Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining))}function g(m){e.enable();if(m.length>0){Ext.MessageBox.alert("Big Brainz","At least one class failed to import.  Please check over the list to see.")}else{Ext.Msg.show({title:"Big Brainz",msg:"Classes and Students added.",buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}if(Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining>-1){Ext.getStore("SchoolStore").data.items[0].data.IndividualLicensesRemaining-=(length-m.length)}e.close();setTimeout(function(){var o;var n=Ext.getCmp("school_tree");while(o=n.getRootNode().childNodes[0]){n.getRootNode().removeChild(o)}Ext.getStore("ClassStore").load();Ext.getStore("SchoolTreeStore").load()},500)}},import_list:function(e,b,f){var d=[];c(e);function c(p){if(p.length){var o=p.shift();var l=b[o];var m=l.length;var k="[";for(i=0;i<m;i++){if(l[i]===""){continue}var n=l[i];var h=n[0];if(h===""){continue}var g=n[1];if(g===undefined){g=""}else{g=Ext.util.Format.trim(g)}h=h.replace(/\t/g," ");k+='{"DisplayableName":"'+h+'", "Password":"'+g+'"},'}k=k.slice(0,-1);k+="]";Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/schools/"+school_data.id+"/class_with_student",params:{class_name:o,student_names_passwords:k},callback:function(r,s,q){if(!s){d.push(o)}c(p)}})}else{f(d)}}},import_list_with_username:function(e,b,f){var d=[];c(e);function c(p){if(p.length){var l=p.shift();var h=b[l];var k=h.length;var o="[";for(i=0;i<k;i++){if(h[i]===""){continue}var n=h[i];var g=n[0];if(g===""){continue}var m=n[1];if(m===undefined){continue}else{m=Ext.util.Format.trim(m)}var q=n[2];if(q===undefined){continue}else{q=Ext.util.Format.trim(q)}g=g.replace(/\t/g," ");if(school_data.hasOwnProperty("sitecode")){o+='{"DisplayableName":"'+g+'", "Password":"'+q+'", "Username":"'+m+'", "IL_Site_Code":"'+school_data.sitecode+'"},'}else{o+='{"DisplayableName":"'+g+'", "Password":"'+q+'", "Username":"'+m+'"},'}}o=o.slice(0,-1);o+="]";Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/schools/"+school_data.id+"/class_with_student",params:{class_name:l,student_names_passwords:o},callback:function(s,t,r){if(!t){d.push(l)}c(p)}})}else{f(d)}}},height:50,itemId:"classImporterAddBtn",width:200,text:"Add"},{xtype:"button",handler:function(b,c){b.up("window").close()},height:50,width:200,text:"Cancel"},{xtype:"tbspacer",flex:2}]}],listeners:{beforeclose:{fn:a.onImportClassWindowBeforeClose,scope:a},afterrender:{fn:a.onImportClassWindowAfterRender,scope:a}}});a.callParent(arguments)},onGridroweditingpluginEdit:function(e,d,c){var a=Ext.getCmp("import_grid").store.data.items;var f="";for(var b=0;b<a.length;b++){if(!school_data.UseLogin&&!district_data.UseLogin){f+=a[b].get("class_name")+"; "+a[b].get("student_name")+"; "+a[b].get("password")+"\n"}else{f+=a[b].get("class_name")+"; "+a[b].get("student_name")+"; "+a[b].get("username")+"; "+a[b].get("password")+"\n"}}Ext.getCmp("add_students_textarea").setValue(f)},onAdd_students_textareaChange:function(k,b,a,h){Ext.getStore("ImportClassListStore").removeAll();var e=b.split("\n");var c=e.length;var d=Ext.ComponentQuery.query("#classImporterAddBtn")[0];if(c>0){d.enable()}else{d.disable()}var f=[];for(i=0;i<c;i++){if(e[i]===""){continue}var g=e[i].split(";");if(!school_data.UseLogin&&!district_data.UseLogin){if(g.length<2){continue}if(g[2]===undefined||Ext.util.Format.trim(g[2])===""){g[2]="default"}f.push({class_name:Ext.util.Format.trim(g[0]),student_name:Ext.util.Format.trim(g[1]),password:Ext.util.Format.trim(g[2])})}else{if(g.length<3){continue}if(g[2]===undefined||Ext.util.Format.trim(g[2])===""){continue}if(g[3]===undefined||Ext.util.Format.trim(g[3])===""){continue}f.push({class_name:Ext.util.Format.trim(g[0]),student_name:Ext.util.Format.trim(g[1]),username:Ext.util.Format.trim(g[2]),password:Ext.util.Format.trim(g[3])})}}Ext.getStore("ImportClassListStore").loadRawData(f)},onImportClassWindowBeforeClose:function(a,b){Ext.getStore("ImportClassListStore").removeAll();Ext.getCmp("add_students_textarea").setValue("")},onImportClassWindowAfterRender:function(a,b){if(!school_data.UseLogin&&!district_data.UseLogin){a.down("#username").hide();a.down("textarea").emptyText="<class name>;<student name>;<password>";a.down("textarea").applyEmptyText()}else{a.down("textarea").emptyText="<class name>;<student name>;<student username>;<password>";a.down("textarea").applyEmptyText()}}});Ext.define("BigBrainzLauncher.view.GamePanel",{extend:"Ext.container.Container",alias:"widget.gamepanel",layout:{align:"center",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",hidden:true,itemId:"expiredLabel",style:"color:red;",text:"Subscription not found. To upgrade or pilot please contact Quincie Weight at quincie.weight@imaginelearning.com or call her at (801) 616-4422."},{xtype:"container",flex:1,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",itemId:"multiplicationDivisionContainer",layout:{pack:"center",type:"hbox"},items:[{xtype:"container",flex:1,height:300,itemId:"multiplicationContainer",width:350,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",html:"<img id = 'multiplicationPlayImage' style = 'cursor: pointer;' src = 'images/Button_PlayMultiplication_150.png' onmouseover = 'this.src = \"images/Button_PlayMultiplicationHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlayMultiplication_150.png\"' />\r\n<img id = 'multiplicationReplayImage' style = 'cursor: pointer;display:none;' src = 'images/Button_OnlineReplayMulti.png' onmouseover = 'this.src = \"images/Button_OnlineReplayMultiHover.png\"' onmouseout = 'this.src = \"images/Button_OnlineReplayMulti.png\"' />",itemId:"multiplicationPlayContainer",listeners:{afterrender:{fn:a.onContainerAfterRender,scope:a}}},{xtype:"container",itemId:"multiplicationReplayContainer",layout:{align:"center",type:"vbox"},items:[{xtype:"label",style:"font-weight:bold;\r\nfont-size:200%;",text:"MULTIPLICATION"},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"container",margins:"20 0 0 0",layout:{align:"center",type:"vbox"},items:[{xtype:"container",items:[{xtype:"label",text:"Post-Test:"},{xtype:"label",itemId:"multiplicationScoreLabel",margin:"0 0 0 5",style:"font-weight:bold;",text:"83%"}]},{xtype:"container",items:[{xtype:"label",text:"Level Earned:"},{xtype:"label",itemId:"multiplicationLevelLabel",margin:"0 0 0 5",style:"font-weight:bold;",text:"Apprentice"}]},{xtype:"label",margins:"10 0 10 0",itemId:"multiplicationPraiseLabel",minWidth:127,style:"font-weight : bold;\r\nfont-size : 200%;",text:"Great Job !"},{xtype:"container",margins:"",html:'<img id = "multiplicationReplayRetestImage" src="images/replay_characters/Retest_50.png" />',style:"cursor: pointer;",listeners:{afterrender:{fn:a.onContainerAfterRender4,scope:a}}},{xtype:"label",itemId:"multiplicationReplyMessageLabel",style:"color:red;",text:'Score > 95% to become a "Master"'},{xtype:"container",html:'<img id = "multiplicationNextMasteryLevelCharacter" src="images/replay_characters/Scratch_Ninja2_h75.png" />'}]},{xtype:"container",margins:"20 0 0 0",html:"<img id = \"multiplicationMasteryLevelCharacter\" src = 'images/replay_characters/Scratch_White_h200.png' />"}]}]},{xtype:"container",hidden:true,html:"<img src = 'images/subjects/Button_PlayMultiplication_150Disabled.png' />",itemId:"multiplicationExpired"}]},{xtype:"container",flex:1,height:300,itemId:"divisionContainer",width:350,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",html:"<img id = 'divisionPlayImage' style = 'cursor: pointer;' src = 'images/Button_PlayDivision_150.png' onmouseover = 'this.src = \"images/Button_PlayDivisionHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlayDivision_150.png\"' />",itemId:"divisionPlayContainer",listeners:{afterrender:{fn:a.onContainerAfterRender1,scope:a}}},{xtype:"container",itemId:"divisionReplayContainer",layout:{align:"center",type:"vbox"},items:[{xtype:"label",style:"font-weight:bold;\r\nfont-size:200%;",text:"DIVISION"},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"container",margins:"20 0 0 0",layout:{align:"center",type:"vbox"},items:[{xtype:"container",items:[{xtype:"label",text:"Post-Test:"},{xtype:"label",itemId:"divisionScoreLabel",margin:"0 0 0 5",style:"font-weight:bold;",text:"83%"}]},{xtype:"container",items:[{xtype:"label",text:"Level Earned:"},{xtype:"label",itemId:"divisionLevelLabel",margin:"0 0 0 5",style:"font-weight:bold;",text:"Apprentice"}]},{xtype:"label",margins:"10 0 10 0",itemId:"divisionPraiseLabel",minWidth:127,style:"font-weight : bold;\r\nfont-size : 200%;",text:"Great Job !"},{xtype:"container",margins:"",html:'<img id = "divisionReplayRetestImage" src="images/replay_characters/Retest_50.png" />',style:"cursor: pointer;",listeners:{afterrender:{fn:a.onContainerAfterRender5,scope:a}}},{xtype:"label",itemId:"divisionReplyMessageLabel",style:"color:red;",text:'Score > 95% to become a "Master"'},{xtype:"container",html:'<img id = "divisionNextMasteryLevelCharacter" src="images/replay_characters/Scratch_Ninja2_h75.png" />'}]},{xtype:"container",margins:"20 0 0 0",html:"<img id = \"divisionMasteryLevelCharacter\" src = 'images/replay_characters/Scratch_White_h200.png' />"}]}]},{xtype:"container",hidden:true,html:"<img src = 'images/subjects/Button_PlayDivision_150Disabled.png' />",itemId:"divisionExpired"}]}]},{xtype:"container",hidden:true,html:"<img id = 'addSubtractPlayImage' style = 'cursor: pointer;' src='images/Button_PlayAddSub_150.png' onmouseover = 'this.src = \"images/Button_PlayAddSubHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlayAddSub_150.png\"' />",itemId:"addSubtractContainer",listeners:{afterrender:{fn:a.onAddSubtractContainerAfterRender,scope:a}}},{xtype:"container",itemId:"additionSubtractionContainer",layout:{pack:"center",type:"hbox"},items:[{xtype:"container",flex:1,height:300,itemId:"additionContainer",width:350,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",html:"<img id = 'additionPlayImage' style = 'cursor: pointer;' src='images/Button_PlayAdd_150.png' onmouseover = 'this.src = \"images/Button_PlayAddHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlayAdd_150.png\"' />\r\n<img id = 'additionReplayImage' style = 'cursor: pointer;display:none' src='images/Button_OnlineReplayPlus.png' onmouseover = 'this.src = \"images/Button_OnlineReplayPlusHover.png\"' onmouseout = 'this.src = \"images/Button_OnlineReplayPlus.png\"' />",itemId:"additionPlayContainer",listeners:{afterrender:{fn:a.onContainerAfterRender2,scope:a}}},{xtype:"container",itemId:"additionReplayContainer",layout:{align:"center",type:"vbox"},items:[{xtype:"label",style:"font-weight:bold;\r\nfont-size:200%;",text:"ADDITION"},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"container",margins:"20 0 0 0",layout:{align:"center",type:"vbox"},items:[{xtype:"container",items:[{xtype:"label",text:"Post-Test:"},{xtype:"label",itemId:"additionScoreLabel",margin:"0 0 0 5",style:"font-weight:bold;",text:"83%"}]},{xtype:"container",items:[{xtype:"label",text:"Level Earned:"},{xtype:"label",itemId:"additionLevelLabel",margin:"0 0 0 5",style:"font-weight:bold;",text:"Apprentice"}]},{xtype:"label",margins:"10 0 10 0",itemId:"additionPraiseLabel",minWidth:127,style:"font-weight : bold;\r\nfont-size : 200%;",text:"Great Job !"},{xtype:"container",margins:"",html:'<img id = "additionReplayRetestImage" src="images/replay_characters/Retest_50.png" />',style:"cursor: pointer;",listeners:{afterrender:{fn:a.onContainerAfterRender6,scope:a}}},{xtype:"label",itemId:"additionReplyMessageLabel",style:"color:red;",text:'Score > 95% to become a "Master"'},{xtype:"container",html:'<img id = "additionNextMasteryLevelCharacter" src="images/replay_characters/Scratch_Ninja2_h75.png" />'}]},{xtype:"container",margins:"20 0 0 0",html:"<img id = 'additionMasteryLevelCharacter' src = 'images/replay_characters/Scratch_White_h200.png' />"}]}]},{xtype:"container",hidden:true,html:"<img src = 'images/subjects/Button_PlayAdd_150Disabled.png' />",itemId:"additionExpired"}]},{xtype:"container",flex:1,height:300,itemId:"subtractionContainer",width:350,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",html:"<img id = 'subtractionPlayImage' style = 'cursor: pointer;' src='images/Button_PlaySub_150.png' onmouseover = 'this.src = \"images/Button_PlaySubHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlaySub_150.png\"' />\r\n<img id = 'subtractionReplayImage' style = 'cursor: pointer;display:none' src='images/Button_OnlineReplaySub.png' onmouseover = 'this.src = \"images/Button_OnlineReplaySubHover.png\"' onmouseout = 'this.src = \"images/Button_OnlineReplaySubHover.png\"' />",itemId:"subtractionPlayContainer",listeners:{afterrender:{fn:a.onContainerAfterRender3,scope:a}}},{xtype:"container",itemId:"subtractionReplayContainer",layout:{align:"center",type:"vbox"},items:[{xtype:"label",style:"font-weight:bold;\r\nfont-size:200%;",text:"SUBTRACTION"},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"container",margins:"20 0 0 0",layout:{align:"center",type:"vbox"},items:[{xtype:"container",items:[{xtype:"label",text:"Post-Test:"},{xtype:"label",itemId:"subtractionScoreLabel",margin:"0 0 0 5",style:"font-weight:bold;",text:"83%"}]},{xtype:"container",items:[{xtype:"label",text:"Level Earned:"},{xtype:"label",itemId:"subtractionLevelLabel",margin:"0 0 0 5",style:"font-weight:bold;",text:"Apprentice"}]},{xtype:"label",margins:"10 0 10 0",itemId:"subtractionPraiseLabel",minWidth:127,style:"font-weight : bold;\r\nfont-size : 200%;",text:"Great Job !"},{xtype:"container",margins:"",html:'<img id = "subtractionReplayRetestImage" src="images/replay_characters/Retest_50.png" />',style:"cursor: pointer;",listeners:{afterrender:{fn:a.onContainerAfterRender7,scope:a}}},{xtype:"label",itemId:"subtractionReplyMessageLabel",style:"color:red;",text:'Score > 95% to become a "Master"'},{xtype:"container",html:'<img id = "subtractionNextMasteryLevelCharacter" src="images/replay_characters/Scratch_Ninja2_h75.png" />'}]},{xtype:"container",margins:"20 0 0 0",html:"<img id = \"subtractionMasteryLevelCharacter\" src = 'images/replay_characters/Scratch_White_h200.png' />"}]}]},{xtype:"container",hidden:true,html:"<img src = 'images/subjects/Button_PlaySub_150Disabled.png' />",itemId:"subtractionExpired"}]}]}]}]});a.callParent(arguments)},onContainerAfterRender:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playMultiplication")})},onContainerAfterRender4:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playMultiplication")})},onContainerAfterRender1:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playDivision")})},onContainerAfterRender5:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playDivision")})},onAddSubtractContainerAfterRender:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playAddSubtract")})},onContainerAfterRender2:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playAddition")})},onContainerAfterRender6:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playAddition")})},onContainerAfterRender3:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playSubtraction")})},onContainerAfterRender7:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playSubtraction")})}});Ext.define("BigBrainzLauncher.view.SchoolTree",{extend:"Ext.tree.Panel",alias:"widget.mytreepanel",id:"school_tree",itemId:"schoolTree",header:false,iconCls:"apple-icon",title:"",store:"SchoolTreeStore",folderSort:true,initComponent:function(){var a=this;Ext.applyIf(a,{viewConfig:{itemId:"schoolTreeView",padding:"",plugins:[Ext.create("Ext.tree.plugin.TreeViewDragDrop",{})]}});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.DistrictOverviewLoginWindow",{extend:"Ext.window.Window",height:222,id:"login_window1",width:488,layout:{align:"center",pack:"center",type:"vbox"},title:"District Password",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",padding:"20 20 0 20",style:"text-align:center;",text:"Please enter your district password. "},{xtype:"label",padding:"5 20 20 20",text:" If you don't know it, please call Big Brainz."},{xtype:"textfield",id:"",itemId:"districtLoginPassword",fieldLabel:"Password",inputType:"password",minLength:1,minLengthText:"Password field must not be blank.",listeners:{specialkey:{fn:a.onDistrictLoginPasswordSpecialkey,scope:a}}},{xtype:"container",width:250,layout:{type:"hbox"},items:[{xtype:"container",flex:1},{xtype:"button",text:"Login",listeners:{click:{fn:a.onButtonClick,scope:a}}}]}],listeners:{beforeclose:{fn:a.onLogin_windowBeforeClose,scope:a},afterrender:{fn:a.onLogin_window1AfterRender,scope:a}}});a.callParent(arguments)},onDistrictLoginPasswordSpecialkey:function(c,b,a){if(b.getKey()==b.ENTER){this.down("button").fireEvent("click",{})}},onButtonClick:function(c,f,b){var d=this;var a=Ext.ComponentQuery.query("#districtLoginPassword")[0].value;Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login/district",params:{id:district_data.id,password:a},success:function(e){var g=Ext.decode(e.responseText);if(g.success){if(Ext.getCmp("login_window")===undefined){}else{Ext.getCmp("login_window").destroy()}d.destroy();Ext.create("BigBrainzLauncher.view.DistrictOverview")}else{Ext.Msg.alert("Could not log in.  Please try again.")}},failure:function(){Ext.Msg.alert("Could not log in.  Please try again.")}})},onLogin_windowBeforeClose:function(a,b){Ext.getCmp("selectSchool").down("combobox").setValue("");Ext.getCmp("school_selection_window").show()},onLogin_window1AfterRender:function(a,b){setTimeout(function(){a.down("textfield").focus()},100)}});Ext.define("BigBrainzLauncher.view.ClassReportGrid",{extend:"Ext.container.Container",alias:"widget.classreportgrid2",height:250,itemId:"classReportGrid",width:400,layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",html:'<table style="margin-left:auto;margin-right:auto;">\r\n	<tr>\r\n		<!-- <td width = \'20\' style = "background-color:red;">&nbsp;</td>\r\n    <td style = "padding-right:15px;">Initial Placement</td> -->\r\n    <td width = \'20\' style = "background-color:blue;">&nbsp;</td>\r\n    <td style = "padding-right:15px;">Passed Off</td>\r\n    <td width = \'20\' style = "background-color:yellow;">&nbsp;</td>\r\n    <td>In Progress or Awaiting Review</td>\r\n	</tr>\r\n</table>'},{xtype:"gridpanel",get_color:function(b,o,c,h){if(b===0||b===" "||b===""){return""}c=typeof c!=="undefined"?c:[255,255,255];h=typeof h!=="undefined"?h:[0,176,240];var m=(b/o)*100;if(m>100){m=100}var r=(h[0]-c[0])/100;var q=(h[1]-c[1])/100;var e=(h[2]-c[2])/100;var d=Math.floor(c[0]+m*r);var g=Math.floor(c[1]+m*q);var p=Math.floor(c[2]+m*e);var l=pad(d.toString(16),2);var n=pad(g.toString(16),2);var k=pad(p.toString(16),2);var f=l+n+k;return f},toHTMLTable:function(){var m=this;var r="";var o=this.getStore().data.length;var d=Math.floor(o/30);for(var q=0;q<=d;q++){var t='<table style="margin: auto;width:100%;" border = "1" cellpadding="0" cellspacing="0">';var e=this.columns;t+=p(e);t+=n(this.getStore(),e,this,q);t+="</table>";if(q<d){t+='<div class="page-break"></div>'}r+=t}return r;function p(v){var w=v.length;var y="<tr>";for(var u=0;u<w;u++){var x=v[u].text;if(x=="Overall Progress<br />(including review & retention)"||x=='Adjusted<br />Pre-Test<img src = "images/icon-question.gif" />'||x=="Current Progress"||x=="&#160;"){continue}if(x=="Progress"){x='<table width = "100%"><tr><td align = "left">0%</td><td width = "90%" align = "center">Progress</td><td align = "right">100%</td></tr></table>'}y+="<th>"+x+"</th>"}y+="</tr>";return y}function n(C,w,u,A){var y=w.length;var E="";var v=0;for(var z=A*30;z<A*30+30;z++){if(u.store.data.items.length<=z){break}var x=u.store.data.items[z];var B="gray";if(v%1===0){B="white"}v+=1;var D='<tr style = "background-color:'+B+';" >';D+=g(x);D+=f(x);D+=b(x,u);D+=l(x);D+=s(x);D+=c(x);D+=k(x);D+=h(x);D+="</tr>";E+=D}return E}function g(u){return'<td width = "20%">'+u.get("name")+"</td>"}function f(v){var u=m.up("classreportgrid2").calculatePretestValue(v.get("adj_pretest"),v);if(u!==""){u=u+"%"}return'<td style = "text-align:center;">'+Ext.util.Format.ellipsis(u,15)+"</td>"}function b(z,v){var y=z.get("progress");var w='<td width = "30%"><table width = "100%" cellspacing = "0"><tr>';for(var u=10;u<=90;u+=10){var x="white";if(y>=u){x="blue"}w+='<td style = "background-color:'+x+';">&nbsp;</td>'}w+="</tr></table></td>";return w}function l(v){var u=v.get("posttest");if(u<0){u="&nbsp;"}else{u+="%"}return'<td style = "text-align:center;">'+u+"</td>"}function s(x){var y=x.get("progress");var w=x.get("posttest");if(y<1&&w<1){return'<td style = "text-align:center;">&nbsp;</td>'}var v=x.get("pretest");var u=w;if(w<=0){if(x.get("adj_pretest")>=0){v=x.get("adj_pretest")}u=y}var z=Math.floor((u-v)/v*100);if(z<0){z=0}return'<td style = "text-align:center;">'+z+"%</td>"}function c(v){var w=v.get("progress");var y=v.get("adj_pretest");var x=v.get("minutes");if(x<60){return'<td style = "text-align:center;">&nbsp;</td>'}var z=w-y;var u=z/(x/60);return'<td style = "text-align:center;">'+Math.round(u)+"%</td>"}function k(x){var w=x.get("minutes");if(w<1){return'<td style = "text-align:center;">&nbsp;</td>'}var v=("00"+w%60).slice(-2);var u=Math.floor(w/60);w=u+":"+v;return'<td style = "text-align:center;">'+w+"</td>"}function h(x){if(x.get("progress")>=90){return'<td style = "text-align:center;">&nbsp;</td>'}var w=600-Math.floor(600*(x.get("progress")/100));if(w<1){return""}var v=("00"+w%60).slice(-2);var u=Math.floor(w/60);data=u+":"+v;return'<td style = "text-align:center;">'+data+"</td>"}},print:function(){var e=document.createElement("form");e.target="";e.method="POST";e.action="routes/routes.php?url=/pdf";e.appendChild(b("method","post"));var c=Ext.ComponentQuery.query("#reportYearSelector")[0].valueModels[0].data.field2;if(c=="CurrentYear"){c="2017-2018"}e.appendChild(b("name",Ext.getCmp("school_tree").getSelectionModel().selected.items[0].data.text+" "+c));e.appendChild(b("html",escape(this.toHTMLTable())));e.appendChild(b("svg",escape(Ext.encode(f()))));var d=Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id();if(d=="all"){d="Summary"}if(d=="ta9"){d="Multiplication"}if(d=="division"){d="Division"}if(d=="addition"){d="Addition"}if(d=="subtraction"){d="Subtraction"}e.appendChild(b("appid",d));document.body.appendChild(e);e.submit();function b(h,k){var g=document.createElement("input");g.type="text";g.name=h;g.value=k;return g}function f(){var h=Ext.ComponentQuery.query("chart");var l=h.length;var k=[];var g={};g.heading="Usage";g.graphs=[Ext.ComponentQuery.query("#usageChart")[0].down("chart").save()];k.push(g);g={};g.heading="Average Pre/Post Test";g.graphs=[Ext.ComponentQuery.query("#improvementChart")[0].save()];k.push(g);g={};g.heading="Pretest";g.graphs=[Ext.ComponentQuery.query("#pretestChart")[0].down("chart").save()];k.push(g);g={};g.heading="Posttest";g.graphs=[Ext.ComponentQuery.query("#posttestChart")[0].down("chart").save()];k.push(g);return k}},renderProgressBars:function(){for(var f in this.progressbars){var e=Ext.util.Format.number(this.progressbars[f].value,"00.0%");var c=this.progressbars[f].pretest+"%";var b=this.progressbars[f].inProgress+"%";if(this.progressbars[f].pretest<0){c="N/A"}var d=Ext.get(f);if(d!==undefined&&d!==null){d.set({"data-qtip":"Adjusted Pre-Test score: "+c+"<br />Current progress: "+e+"<br />In progress: "+b})}}},flex:1,itemId:"classReportGridGrid",padding:"5 5 5 5",title:"",columnLines:true,forceFit:true,store:"GameProgressStore",columns:[{xtype:"gridcolumn",dataIndex:"name",tdCls:"center-cell",text:"Name"},{xtype:"gridcolumn",renderer:function(h,d,c,k,f,e,b){var g=b.up("classreportgrid2").calculatePretestValue(h,c);if(g!==""){g=g+"%"}return g},defaultWidth:75,align:"center",dataIndex:"adj_pretest",tdCls:"center-cell",text:'Pre-Test<img src = "images/icon-question.gif" />',tooltip:"If a student misses either iteration of a matching fact pair, both facts are included for review and marked as incorrect for the purpose of pre-test placement scoring. For example, if Timmy correctly answers 4 X 6, but misses 6 X 4, both facts will be included for review and be counted as incorrect in pre-test placement scoring."},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){if(c.data.pretest<0){return""}if(g!==""&&g!==undefined&&g>-1){if(c.get("posttest")>0){return c.get("pretest")+"%"}return g+"%"}return""},hidden:true,width:123,align:"center",dataIndex:"adj_pretest",tdCls:"center-cell",text:'Adjusted<br />Pre-Test<img src = "images/icon-question.gif" />',tooltip:"Factors in necessary review."},{xtype:"gridcolumn",renderer:function(l,b,f,h,n,m,k){if(this.progressbars===undefined){this.progressbars={}}var c=Ext.id();var g=f.data.in_progress;var o=Ext.String.format('<table style = "width:100%;border-collapse:collapse;"><tr><td style = "width:90%;"><table id = "{0}" style = "width:100%;border-collapse:collapse;"><tr>',c);for(var e=0;e<100;e++){if(e<f.data.adj_pretest){o+='<td width = "1%" style="background-color:#0066CC;">&nbsp;</td>'}else{if(e<l){o+='<td width = "1%" style="background-color:#0066CC;">&nbsp;</td>'}else{if(e<g){o+='<td width = "1%" style="background-color:yellow;">&nbsp;</td>'}else{if(e<f.data.pretest){o+='<td width = "1%" style="background-color:yellow;">&nbsp;</td>'}else{o+='<td width = "1%" >&nbsp;</td>'}}}}}var d="&nbsp;";if(l>0){d=Math.round(l)+"%"}o+="</tr></table></td><td width = '20px' style = 'font-weight:bold;'>"+d+"</td></tr></table>";this.progressbars[c]={value:l,pretest:f.data.adj_pretest,inProgress:g};return o},minWidth:590,align:"center",dataIndex:"progress",text:"Combined Progress<br />(including review & retention)",tooltip:"Factors in necessary review.",flex:10},{xtype:"gridcolumn",hidden:true,text:"Overall Progress<br />(including review & retention)",tooltip:"Factors in necessary review.",flex:10,columns:[{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){if(g<0){return""}return Math.round(g)+"%"},hidden:true,width:123,align:"center",dataIndex:"progress",tdCls:"center-cell"}]},{xtype:"gridcolumn",renderer:function(h,d,c,k,g,f,b){if(h<1){return""}var e=this.get_color(h,100,[255,255,255],[102,204,0]);setTimeout(function(){var n=b.getNode(c);try{var l=Ext.fly(Ext.fly(n).query(".x-grid-cell")[g]).down("div")}catch(m){return h}try{l.dom.style.setProperty("background-color","#"+e)}catch(m){l.dom.style.backgroundColor="#"+e}},50);return h+"%"},defaultWidth:75,align:"center",dataIndex:"posttest",text:"Post-Test"},{xtype:"gridcolumn",renderer:function(m,c,g,k,o,n,l){var h=g.get("progress");var d=g.get("posttest");if(h<1&&d<1){return""}var e=g.get("pretest");var f=d;if(d<=0){if(g.get("adj_pretest")>=0){e=g.get("adj_pretest")}f=h}var b=Math.floor((f-e)/e*100);if(b<0){b=0}return b+"%"},defaultWidth:75,align:"center",tdCls:"center-cell",text:"Improvement"},{xtype:"gridcolumn",renderer:function(m,d,g,k,o,n,l){var c=g.get("progress");var e=g.get("adj_pretest");var f=g.get("minutes");if(f<60){return""}var b=c-e;var h=b/(f/60);if(h<=0){return""}return Math.round(h)+"%"},align:"center",tdCls:"center-cell",text:"Progress<br />Per Hour"},{xtype:"gridcolumn",renderer:function(h,b,d,e,l,k,f){if(h<1){return""}var c=("00"+h%60).slice(-2);var g=Math.floor(h/60);return g+":"+c},defaultWidth:75,align:"center",dataIndex:"minutes",tdCls:"center-cell",text:"Hours"},{xtype:"gridcolumn",renderer:function(k,b,d,f,m,l,g){if(d.get("progress")>=99){return""}if(d.get("name")=="&nbsp;"){return""}var e=10*60;var n=e-Math.floor(e*(d.get("progress")/100));if(n<1){return""}var c=("00"+n%60).slice(-2);var h=Math.floor(n/60);return h+":"+c},defaultWidth:110,align:"center",dataIndex:"minutes",tdCls:"center-cell",text:"Est. Time<br />Remaining"}],listeners:{afterlayout:{fn:a.onClassReportGridAfterLayout,scope:a}}}]});a.callParent(arguments)},onClassReportGridAfterLayout:function(a,c,b){this.down("grid").renderProgressBars();this.progressbars={};setTimeout(function(){if(Ext.ComponentQuery.query("#classReportGrid")[0].autoSized!==true&&Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id()!=="all"){Ext.ComponentQuery.query("#classReportGrid")[0].bbAutoSize()}},1000)},bbAutoSize:function(){Ext.ComponentQuery.query("#classReportGrid")[0].autoSized=true;var c=this.down("grid");c.suspendLayout=true;var b=c.columns;var d=b.length;for(var a=0;a<d;a++){b[a].autoSize()}c.suspendLayout=false;c.doLayout()},calculatePretestValue:function(b,a){if(b!==""&&b!==undefined&&b>-1){if(a.get("posttest")>0){return a.get("pretest")}return b}if(a.data.pretest<0||a.data.pretest===""){return""}else{return a.data.pretest}}});Ext.define("BigBrainzLauncher.view.LoginViewport",{extend:"Ext.container.Viewport",itemId:"loginViewport",layout:{align:"center",pack:"center",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",height:480,itemId:"schoolSelectionPanel",width:640,layout:{type:"card"},title:"",items:[{xtype:"panel",itemId:"selectCountryPanel",layout:{align:"center",pack:"center",type:"vbox"},title:"Big Brainz: Select Your Country",items:[{xtype:"combobox",fieldLabel:"",displayField:"name",forceSelection:true,queryMode:"local",store:"CountryStore",triggerAction:"query",valueField:"id"}]},{xtype:"panel",itemId:"selectStatePanel",layout:{align:"center",pack:"center",type:"vbox"},title:"Big Brainz: Select Your State",items:[{xtype:"container",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"button",flex:1,itemId:"countryButton",text:"MyButton"}]},{xtype:"button",itemId:"back",text:"Back"},{xtype:"combobox",fieldLabel:"",displayField:"name",forceSelection:true,queryMode:"local",store:"StateStore",triggerAction:"query",valueField:"id"}]},{xtype:"panel",itemId:"selectDistrictPanel",layout:{align:"center",pack:"center",type:"vbox"},title:"Big Brainz: Select Your District",items:[{xtype:"container",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"button",flex:1,itemId:"countryButton",text:"MyButton"},{xtype:"button",flex:1,itemId:"stateButton",text:"MyButton"}]},{xtype:"button",itemId:"back",text:"Back"},{xtype:"combobox",fieldLabel:"",displayField:"name",forceSelection:true,queryMode:"local",store:"DistrictStore",triggerAction:"query",valueField:"id"}]},{xtype:"panel",itemId:"selectSchoolPanel",layout:{align:"center",pack:"center",type:"vbox"},title:"Big Brainz: Select Your School",items:[{xtype:"container",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"button",flex:1,itemId:"countryButton",text:"MyButton"},{xtype:"button",flex:1,itemId:"stateButton",text:"MyButton"},{xtype:"button",flex:1,itemId:"districtButton",text:"MyButton"}]},{xtype:"button",itemId:"back",text:"Back"},{xtype:"combobox",fieldLabel:"",displayField:"name",forceSelection:true,queryMode:"local",store:"SchoolStore",triggerAction:"query",valueField:"id"}]},{xtype:"panel",itemId:"loginPanel",layout:{align:"center",pack:"center",type:"vbox"},title:"My Panel",items:[{xtype:"container",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"button",flex:1,itemId:"countryButton",text:"MyButton"},{xtype:"button",flex:1,itemId:"stateButton",text:"MyButton"},{xtype:"button",flex:1,itemId:"districtButton",text:"MyButton"},{xtype:"button",flex:1,itemId:"schoolButton",text:"MyButton"}]},{xtype:"button",itemId:"back",text:"Back"}]}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.DailyUsageChart",{extend:"Ext.container.Container",alias:"widget.dailyusagechart",itemId:"dailyUsageChart",width:600,layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",style:"text-align:center;font-size:200%;font-style:normal",text:"Daily Usage (All Operations)"},{xtype:"chart",flex:1,animate:true,insetPadding:20,store:"DailyProgressStore",theme:"WeeklyUsage",axes:[{type:"Category",fields:["date"],label:{renderer:function(b){if(this.showDate===undefined){this.showDate=2}this.showDate=(this.showDate+1)%3;monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var c=b.split("-");if(this.showDate===0){return monthNames[parseInt(c[1])-1]+" "+c[2]}else{return""}}},position:"bottom"},{type:"Numeric",fields:["f","p","np"],title:"# of Operations",decimals:0,position:"left"}],legend:{position:"float",x:90,y:-15},series:[a.processofOperationsFluentPlaying({type:"area",renderer:function(f,b,d,e,c){return Ext.apply(d,{fill:"#66CC00"})},highlight:true,tips:{trackMouse:true,width:185,height:55,renderer:function(d,l){var c=["January","February","March","April","May","June","July","August","September","October","November","December"];var k=l.storeField;if(d.data===undefined){return}var e=d.data[k];var h="students";if(e===1){h="student"}if(Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id()==="all"){h="operations";if(e===1){h="operation"}}var b=d.data.timestamp;var g=c[b.getMonth()]+" "+b.getDate();var f="";switch(k){case"f":f=e+" "+h+" finished by<br />"+g;break;case"p":f=e+" "+h+" playing more than<br /> 20 minutes on "+g;break;case"np":f=e+" "+h+" playing less than<br /> 20 minutes on "+g;break}this.setTitle(f)}},title:["# of Operations Fluent","Playing"],xField:"timestamp",yField:["f","0"]}),a.processMyColumnSeries1({type:"column",showInLegend:false,tips:{trackMouse:true,width:200,height:55,renderer:function(g,f){var e=["January","February","March","April","May","June","July","August","September","October","November","December"];var c=f.yField;if(g.data===undefined){return}var h=g.data[c];var b="students";if(h===1){b="student"}if(Ext.ComponentQuery.query("#schoolReportTabs")[0].active_app_id()==="all"){b="operations";if(h===1){b="operation"}}var d=g.data.timestamp;d=e[d.getMonth()]+" "+d.getDate();var k="";switch(c){case"f":k=h+" "+b+" finished by<br />"+d;break;case"p":k=(h+g.data.np)+" "+b+" playing <br /> on the week of<br />"+d;break;case"np":k=(h+g.data.p)+" "+b+" playing <br /> on the week of<br />"+d;break}this.setTitle(k)}},axis:"left",xField:"timestamp",yField:["p","np"],stacked:true})]}]});a.callParent(arguments)},processofOperationsFluentPlaying:function(a){a.getLegendColor=function(b){var c=["#0088dd","#66CC00"];return c[(b+1)%c.length]};return a},processMyColumnSeries1:function(a){return a}});Ext.define("BigBrainzLauncher.view.ReplayDialog",{extend:"Ext.window.Window",height:144,itemId:"replayDialog",width:537,title:"Teacher Authorization Required",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",itemId:"fluentContainer",items:[{xtype:"radiogroup",width:400,fieldLabel:"Mode",items:[{xtype:"radiofield",name:"multiplicationMode",boxLabel:"Normal",checked:true,inputValue:"normal"},{xtype:"radiofield",name:"multiplicationMode",boxLabel:"Ninja 1",inputValue:"ninja1"},{xtype:"radiofield",fieldLabel:"",name:"multiplicationMode",boxLabel:"Ninja 2",inputValue:"ninja2"},{xtype:"radiofield",fieldLabel:"",name:"multiplicationMode",boxLabel:"Ninja 3",inputValue:"ninja3"}],listeners:{change:{fn:a.onRadiogroupChange,scope:a}}}]},{xtype:"container",itemId:"notFluentContainer",items:[{xtype:"label",itemId:"notFluentLabel",text:"This student only score a **%.  We would like students to score a minumum of 95% to be considered fluent."}]},{xtype:"container",itemId:"retestContainer",items:[{xtype:"label",text:"You may retest 2 more times just in case you had a bad day during the test.  This will take you till right before the post test."}]},{xtype:"checkboxfield",itemId:"pretestFromPosttestCB",fieldLabel:"Use Post Test score as new Pre Test score",labelWidth:250,name:"pretestFromPosttest",boxLabel:"",checked:true},{xtype:"container",hidden:true,layout:{align:"stretch",type:"hbox"},items:[{xtype:"textfield",fieldLabel:"Educator Password",labelWidth:110},{xtype:"button",handler:function(c,e){var d=this.up("window");var b=d.down("textfield").value;Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login",params:{id:school_data.id,password:b},success:function(f){var g=Ext.decode(f.responseText);if(g.success){if(g.access=="educator"){d.addReplayGame()}else{Ext.MessageBox.alert("Password Incorrect","You have entered in a student password.  Please enter in an educator password.")}}else{Ext.MessageBox.alert("Password Incorrect","you have entered an incorrect password.  Please try again.")}},failure:function(){Ext.MessageBox.alert("Server Error","We could not process your password request.  Please try again.")}})},text:"Authorize"}]},{xtype:"container",layout:{align:"stretch",pack:"end",type:"hbox"},items:[{xtype:"button",itemId:"addReplayGameButton",width:50,text:"OK"},{xtype:"button",handler:function(b,c){this.up("window").close()},width:50,text:"Cancel"}]}]});a.callParent(arguments)},onRadiogroupChange:function(d,c,a,b){if(c.multiplicationMode==="normal"){Ext.ComponentQuery.query("#pretestFromPosttestCB")[0].enable()}else{Ext.ComponentQuery.query("#pretestFromPosttestCB")[0].disable()}}});Ext.define("BigBrainzLauncher.view.PlanoGamePanel",{extend:"Ext.container.Container",alias:"widget.planogamepanel",layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",flex:1,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",itemId:"multiplicationDivisionContainer",layout:{pack:"center",type:"hbox"},items:[{xtype:"container",flex:1,height:300,itemId:"multiplicationContainer",width:350,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",html:"<img id = 'multiplicationPlayImage' style = 'cursor: pointer;' src = 'images/Button_PlayMultiplication_150.png' onmouseover = 'this.src = \"images/Button_PlayMultiplicationHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlayMultiplication_150.png\"' />\r\n<img id = 'multiplicationReplayImage' style = 'cursor: pointer;display:none;' src = 'images/Button_OnlineReplayMulti.png' onmouseover = 'this.src = \"images/Button_OnlineReplayMultiHover.png\"' onmouseout = 'this.src = \"images/Button_OnlineReplayMulti.png\"' />",itemId:"multiplicationPlayContainer",listeners:{afterrender:{fn:a.onContainerAfterRender,scope:a}}}]},{xtype:"container",flex:1,height:300,itemId:"divisionContainer",width:350,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",html:"<img id = 'divisionPlayImage' style = 'cursor: pointer;' src = 'images/Button_PlayDivision_150.png' onmouseover = 'this.src = \"images/Button_PlayDivisionHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlayDivision_150.png\"' />",itemId:"divisionPlayContainer",listeners:{afterrender:{fn:a.onContainerAfterRender1,scope:a}}}]}]},{xtype:"container",hidden:true,html:"<img id = 'addSubtractPlayImage' style = 'cursor: pointer;' src='images/Button_PlayAddSub_150.png' onmouseover = 'this.src = \"images/Button_PlayAddSubHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlayAddSub_150.png\"' />",itemId:"addSubtractContainer",listeners:{afterrender:{fn:a.onAddSubtractContainerAfterRender,scope:a}}},{xtype:"container",itemId:"additionSubtractionContainer",layout:{pack:"center",type:"hbox"},items:[{xtype:"container",flex:1,height:300,itemId:"additionContainer",width:350,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",html:"<img id = 'additionPlayImage' style = 'cursor: pointer;' src='images/Button_PlayAdd_150.png' onmouseover = 'this.src = \"images/Button_PlayAddHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlayAdd_150.png\"' />\r\n<img id = 'additionReplayImage' style = 'cursor: pointer;display:none' src='images/Button_OnlineReplayPlus.png' onmouseover = 'this.src = \"images/Button_OnlineReplayPlusHover.png\"' onmouseout = 'this.src = \"images/Button_OnlineReplayPlus.png\"' />",itemId:"additionPlayContainer",listeners:{afterrender:{fn:a.onContainerAfterRender2,scope:a}}}]},{xtype:"container",flex:1,height:300,itemId:"subtractionContainer",width:350,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"container",html:"<img id = 'subtractionPlayImage' style = 'cursor: pointer;' src='images/Button_PlaySub_150.png' onmouseover = 'this.src = \"images/Button_PlaySubHover_150.png\"' onmouseout = 'this.src = \"images/Button_PlaySub_150.png\"' />\r\n<img id = 'subtractionReplayImage' style = 'cursor: pointer;display:none' src='images/Button_OnlineReplaySub.png' onmouseover = 'this.src = \"images/Button_OnlineReplaySubHover.png\"' onmouseout = 'this.src = \"images/Button_OnlineReplaySubHover.png\"' />",itemId:"subtractionPlayContainer",listeners:{afterrender:{fn:a.onContainerAfterRender3,scope:a}}}]}]}]}]});a.callParent(arguments)},onContainerAfterRender:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playMultiplication")})},onContainerAfterRender1:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playDivision")})},onAddSubtractContainerAfterRender:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playAddSubtract")})},onContainerAfterRender2:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playAddition")})},onContainerAfterRender3:function(a,b){a.getEl().on("click",function(c,d){BigBrainzLauncher.getApplication().fireEvent("playSubtraction")})}});Ext.define("BigBrainzLauncher.view.StudentDetails",{extend:"Ext.window.Window",alias:"widget.studentDetails",height:233,style:"opacity:.95;\r\nfilter: alpha(opacity=95);",width:282,layout:{align:"center",type:"vbox"},bodyStyle:"opacity:.95;\r\nfilter: alpha(opacity=95);",closeAction:"hide",title:"Student Details",titleAlign:"center",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",padding:"10 0 10 0",layout:{align:"stretch",type:"hbox"},items:[{xtype:"label",itemId:"studentDetailsName",style:"font-weight:bold;\r\nfonti-size:14px;",text:"name"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",itemId:"pretestLabel",text:"Pre-Test:"},{xtype:"label",itemId:"studentDetailsPretestScore",padding:"0 0 0 5",text:"43%"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"studentDetailsProgressPosttestLabel",text:"Current Progress/Post-Test:"},{xtype:"label",flex:1,itemId:"studentDetailsProgressPosttest",padding:"0 0 0 5",text:"94%"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"improvementLabel",text:"Improvement:"},{xtype:"label",flex:1,itemId:"studentDetailsImprovement",padding:"0 0 0 5",text:"75%"}]},{xtype:"container"},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"timeInvestedLabel",text:"Time Invested:"},{xtype:"label",flex:1,itemId:"studentDetailsTimeInvested",minWidth:58,padding:"0 0 0 5",text:"2.4 Hours"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"estTimeRemainingLabel",text:"Estimated Time Remaining:"},{xtype:"label",flex:1,itemId:"studentDetailsTimeRemaining",minWidth:58,padding:"0 0 0 5",text:"4.2 Hours"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"pphLabel",text:"Progress Per Hour:"},{xtype:"label",flex:1,itemId:"studentDetailsPPH",padding:"0 0 0 5",text:"10%"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"timeInvestedRecentlyLabel",text:"Time Invested Last 2 Weeks:"},{xtype:"label",flex:0,itemId:"studentDetailsTimeInvestedRecently",minWidth:58,padding:"0 0 0 5",text:"0 Hours"}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.BigBrainzMain",{extend:"Ext.container.Viewport",layout:{align:"center",pack:"center",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",height:362,id:"school_selection_window",width:400,layout:{type:"fit"},title:"Select Your School",titleAlign:"left",items:[{xtype:"panel",layout:{type:"accordion"},title:"",titleCollapse:true,items:[{xtype:"panel",id:"selectCountry",layout:{align:"stretch",type:"vbox"},collapsed:false,collapsible:true,title:"Select Your Country",items:[{xtype:"combobox",id:"comboCountry",displayField:"name",forceSelection:true,queryMode:"local",store:[["BB01NOIP82414221620080617T170530968Z","United States"],["BB026916914452205720209620081210223810622379","United Kingdom"],["BB02691691445291662038220090106194745652157","Canada"],["BB026916914452193149656120090202160345556342","Australia"],["BB026916914452151399866420090422213855180801","Norway"],["BB02691691445267732305620090423173903170257","Bermuda"],["BB02691691445299722125320090424192638154491","Abu Dhabi"],["BB026916914452161021777820090427181919843326","Singapore"],["BB02691691445236435256520090427202517302181","France"],["BB026916914452116609578620090501183642009183","Saudi Arabia"],["BB026916914452149844067020090507163723837097","India"],["BB02691691445245069001520090511165658628917","Mexico"],["BB026916914452178997944820090518162742588752","Qatar"],["BB026916914452126291158620090608201921339810","Jamaica"],["BB026916914452167078638520090909143200911137","Japan"],["BB026916914452147681252920091214191400260735","Israel"],["BB026916914452179629467220100114211852400148","Ireland"],["BB02691691445217615771320100128151946317650","Netherlands"],["BB026916914452134661534320100312165517949626","Sweden"],["BB02691691445247883200220100322175854507912","New Zealand"],["BB0266711213024011414420100325180805173515","Africa"],["BB02977516082204820273420100428170609406873","Thailand"],["BB0297751608293048022820100622192721816870","Switzerland"],["BB0297751608265070323820100917220918775008","Fiji"],["BB0297751608242732160620100923200942351984","Egypt"],["BB0297751608293959953220100930213549568273","Colombia"],["BB029775160826671368320101007170821811223","Pakistan"],["BB0297751608215136756720101101221534913851","United Arab Emirates"],["BB0297751608265432310120101104213202531509","Peru"],["BB02977516082132354899720110304161553546964","Hong Kong"],["BB02977516082112976460820110314200524803374","Argentina"],["BB02977516082190813679020110318172442554268","Dominican Republic"],["BB02977516082168601948820110325154120459652","Belgium"],["BB0297751608288361965020110405161241169163","Malaysia"],["BB0297751608280151533720110411200908663664","Chile"],["BB02977516082162279648720110502203753617078","Cayman Islands"],["BB02977516082107588092520110915225859093570","Iceland"],["BB0297751608282751499220111213232108027366","Finland"],["BB0297751608217862681520120517142748782917","Slovakia"],["BB02977516082174973427320121019182021964787","Costa Rica"],["BB02977516082126965213720121113225115794582","Greece"],["BB0297751608229728679720121129225835011413","Northern Mariana Islands"],["BB02977516082115244231520121207151514435955","Denmark"],["BB0297751608294903582520130111153648490371","Germany"],["BB0297751608269206075520130116221454388583","China"],["BB0297751608245401139720130305000250090282","Nigeria"],["BB0297751608234141322020130403142514763926","South Africa"],["BB0297751608234368642420130515225040936009","Burkina Faso"]],valueField:"id",listeners:{select:{fn:a.onComboCountrySelect,scope:a}}}],listeners:{expand:{fn:a.onSelectCountryExpand,scope:a}}},{xtype:"panel",disabled:true,id:"selectState",layout:{align:"stretch",type:"vbox"},collapsed:true,collapsible:true,title:"Select Your State",items:[{xtype:"combobox",id:"comboState",fieldLabel:"",displayField:"name",forceSelection:true,queryMode:"local",store:"StateStore",valueField:"id",listeners:{select:{fn:a.onComboStateSelect,scope:a}}}],listeners:{expand:{fn:a.onSelectStateExpand,scope:a}}},{xtype:"panel",disabled:true,id:"selectDistrict",layout:{align:"stretch",type:"vbox"},collapsed:true,collapsible:true,title:"Select Your District",listeners:{expand:{fn:a.onSelectDistrictExpand,scope:a},collapse:{fn:a.onSelectDistrictCollapse,scope:a}},items:[{xtype:"container",id:"district_select_container",layout:{type:"fit"},items:[{xtype:"combobox",id:"comboDistrict",fieldLabel:"",displayField:"name",forceSelection:true,queryMode:"local",store:"DistrictStore",valueField:"id",listeners:{select:{fn:a.onComboDistrictSelect,scope:a}}}]}]},{xtype:"panel",disabled:true,id:"selectSchool",layout:{align:"stretch",type:"vbox"},collapsed:true,collapsible:true,title:"Select Your School",items:[{xtype:"combobox",id:"comboSchool",fieldLabel:"",displayField:"name",forceSelection:true,queryMode:"local",store:"SchoolStore",valueField:"id",listeners:{select:{fn:a.onComboSchoolSelect,scope:a}}}],listeners:{expand:{fn:a.onSelectSchoolExpand,scope:a},collapse:{fn:a.onSelectSchoolCollapse,scope:a}}},{xtype:"panel",id:"school_login_panel",collapsed:true,collapsible:true,title:"",items:[{xtype:"container",height:198,id:"school_with_password",layout:{align:"center",type:"vbox"},items:[{xtype:"container",flex:1},{xtype:"textfield",validator:function(b){return(b.length>=1)?true:false},height:30,id:"school_password",padding:"",width:300,fieldLabel:"Password",labelWidth:60,inputType:"password",minLength:1,minLengthText:"You must enter in a password."},{xtype:"button",height:30,id:"login_btn",padding:"",width:100,text:"Login",listeners:{click:{fn:a.onLogin_btnClick,scope:a}}},{xtype:"container",padding:"10 0 0 0",width:400,items:[{xtype:"container",height:20,layout:{align:"center",type:"vbox"},items:[{xtype:"label",flex:1,height:14,style:"{text-align:center;}",text:"Please enter a teacher or student password."}]},{xtype:"container",height:20,layout:{align:"center",type:"vbox"},items:[{xtype:"label",flex:1,style:"{\ntext-align:center;\ncolor:blue;\n}",text:"If you don't know your password, click here.",listeners:{afterrender:{fn:a.onLabelAfterRender,scope:a}}}]}]},{xtype:"container",flex:1}],listeners:{afterlayout:{fn:a.onSchool_with_passwordAfterLayout,scope:a},afterrender:{fn:a.onSchool_with_passwordAfterRender,scope:a}}},{xtype:"container",hidden:true,id:"school_without_password",layout:{align:"middle",type:"hbox"},items:[{xtype:"container",flex:1,layout:{type:"hbox"},items:[{xtype:"container",flex:1,height:50,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"button",handler:function(c,d){var b=Ext.create("BigBrainzLauncher.view.BigBrainzSetup");b.show()},flex:1,id:"educator_without_password",text:"Educator"}]},{xtype:"container",flex:1,height:50,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"button",handler:function(b,c){Ext.MessageBox.alert("Big Brainz","Please contact your school and ask them to set a schoolwide password.  When a password is set, then you will be able to play.")},flex:1,id:"student_without_password",text:"Student"}]}]}]}]}]}],listeners:{afterrender:{fn:a.onSchool_selection_windowAfterRender,scope:a}}}]});a.callParent(arguments)},onComboCountrySelect:function(e,b,c){setTimeout(function(){Ext.getCmp("selectState").enable();Ext.getCmp("selectCountry").collapse()},250);var a=new Date();var d=new Date(a.getFullYear()+1,a.getMonth(),a.getDate());Ext.util.Cookies.set("__country_id_saved",b[0].raw[0],d);Ext.util.Cookies.set("__country_name_saved",b[0].raw[1],d);this.country_id=b[0].raw[0];this.country_name=b[0].raw[1];Ext.getCmp("selectCountry").setTitle(b[0].raw[1])},onSelectCountryExpand:function(c,a){Ext.getCmp("selectCountry").setTitle("Select Your Country");Ext.getCmp("selectState").setTitle("Select Your State");Ext.getCmp("selectDistrict").setTitle("Select Your District");Ext.getCmp("selectSchool").setTitle("Select Your School");Ext.getCmp("selectState").disable();Ext.getCmp("selectDistrict").disable();Ext.getCmp("selectSchool").disable();Ext.getCmp("school_login_panel").hide();Ext.getCmp("school_with_password").hide();Ext.getCmp("school_without_password").hide();Ext.util.Cookies.clear("__country_id_saved");Ext.util.Cookies.clear("__country_name_saved");Ext.util.Cookies.clear("__state_id_saved");Ext.util.Cookies.clear("__state_name_saved");Ext.util.Cookies.clear("__district_id_saved");Ext.util.Cookies.clear("__district_name_saved");Ext.util.Cookies.clear("__school_id_saved");Ext.util.Cookies.clear("__school_name_saved");try{var d=Ext.state.LocalStorageProvider.create();d.clear("school_id");d.clear("school_name");d.clear("district_id");d.clear("district_name");d.clear("state_id");d.clear("state_name");d.clear("country_id");d.clear("country_name")}catch(b){}Ext.getCmp("comboState").getStore().clearFilter()},onComboStateSelect:function(e,b,c){var a=new Date();var d=new Date(a.getFullYear()+1,a.getMonth(),a.getDate());Ext.util.Cookies.set("__state_id_saved",b[0].data.id,d);Ext.util.Cookies.set("__state_name_saved",b[0].data.name,d);this.state_id=b[0].data.id;this.state_name=b[0].data.name;Ext.getCmp("selectState").setTitle(b[0].data.name);setTimeout(function(){Ext.getCmp("selectDistrict").enable();Ext.getCmp("selectState").collapse()},250)},onSelectStateExpand:function(b,a){Ext.getCmp("selectState").setTitle("Select Your State");Ext.getCmp("selectDistrict").setTitle("Select Your District");Ext.getCmp("selectSchool").setTitle("Select Your School");Ext.getCmp("selectDistrict").disable();Ext.getCmp("selectSchool").disable();Ext.getCmp("school_login_panel").hide();Ext.getCmp("school_with_password").hide();Ext.getCmp("school_without_password").hide();Ext.util.Cookies.clear("__state_id_saved");Ext.util.Cookies.clear("__state_name_saved");Ext.util.Cookies.clear("__district_id_saved");Ext.util.Cookies.clear("__district_name_saved");Ext.util.Cookies.clear("__school_id_saved");Ext.util.Cookies.clear("__school_name_saved");Ext.getStore("StateStore").proxy.url="routes/routes.php?url=/countries/"+this.country_id+"/children";Ext.getCmp("comboState").expand();Ext.getCmp("comboState").focus();setTimeout(function(){Ext.getStore("StateStore").load({callback:function(d,c,e){Ext.getCmp("comboDistrict").setValue("")}})},250)},onSelectDistrictExpand:function(c,a){Ext.getCmp("selectDistrict").setTitle("Select Your District");Ext.getCmp("selectSchool").setTitle("Select Your School");Ext.util.Cookies.clear("__district_id_saved");Ext.util.Cookies.clear("__district_name_saved");Ext.util.Cookies.clear("__school_id_saved");Ext.util.Cookies.clear("__school_name_saved");try{var d=Ext.state.LocalStorageProvider.create();d.clear("district_id");d.clear("district_name");d.clear("school_id");d.clear("school_name")}catch(b){}Ext.getStore("DistrictStore").proxy.url="routes/routes.php?url=/states/"+this.state_id+"/children";Ext.getCmp("comboDistrict").expand();Ext.getCmp("comboDistrict").focus();setTimeout(function(){Ext.getStore("DistrictStore").load({callback:function(f,e,g){Ext.getCmp("comboSchool").setValue("")}})},250)},onSelectDistrictCollapse:function(b,a){Ext.getCmp("comboDistrict").setValue();Ext.getStore("DistrictStore").clearFilter();Ext.getStore("DistrictStore").clearData()},onComboDistrictSelect:function(g,b,c){district_data.UseLogin=false;var a=new Date();var d=new Date(a.getFullYear()+1,a.getMonth(),a.getDate());Ext.util.Cookies.set("__district_id_saved",b[0].data.id,d);Ext.util.Cookies.set("__district_name_saved",b[0].data.name,d);this.district_id=b[0].data.id;this.district_name=b[0].data.name;try{district_data.operation_order=JSON.parse((b[0].data.OperationOrder))}catch(f){district_data.operation_order=null}district_data.id=this.district_id;district_data.name=this.district_name;district_data.UseLogin=true;if(b[0].data.IL_Site_Code!==""){school_data.sitecode=b[0].data.IL_Site_Code}else{delete school_data.sitecode}if(b[0].data.UseLogin==="false"){district_data.UseLogin=false;setTimeout(function(){Ext.getCmp("selectSchool").enable();Ext.getCmp("selectDistrict").collapse()},250);Ext.getCmp("selectDistrict").setTitle(b[0].data.name);return}district_data.UseLogin=true;Ext.getCmp("school_selection_window").hide();BigBrainzLauncher.view.LoginWindow.CreateForDistricts()},onComboSchoolSelect:function(f,b,c){school_data.UseLogin=false;if(b[0].data.name==="District Overview"){Ext.getCmp("school_selection_window").hide();var e=Ext.create("BigBrainzLauncher.view.DistrictOverviewLoginWindow");e.show();return}var a=new Date();var d=new Date(a.getFullYear()+1,a.getMonth(),a.getDate());Ext.util.Cookies.set("__school_id_saved",b[0].data.id,d);this.school_id=b[0].data.id;Ext.util.Cookies.set("__school_name_saved",b[0].data.name,d);Ext.getStore("ClassStore").proxy.url="routes/routes.php?url=/schools/"+b[0].data.id+"/children";Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+b[0].data.id+"/login_info";Ext.getStore("SchoolStore").load({callback:function(k,h,l){var g=k[0];school_data.sitecode=g.data.IL_Site_Code;if(g.get("UseLogin")){Ext.getCmp("school_selection_window").hide();BigBrainzLauncher.view.LoginWindow.CreateForSchools();return}Ext.getCmp("school_login_panel").expand();Ext.getCmp("school_login_panel").expand();Ext.getCmp("school_login_panel").show();if(g.data.HasPassword){setTimeout(function(){Ext.getCmp("school_with_password").show();Ext.getCmp("school_without_password").hide()},250)}else{setTimeout(function(){Ext.getCmp("school_without_password").show();Ext.getCmp("school_with_password").hide()},250)}Ext.getCmp("selectSchool").setTitle(g.data.name)}})},onSelectSchoolExpand:function(c,a){Ext.getCmp("selectSchool").setTitle("Select Your School");Ext.getCmp("school_login_panel").hide();Ext.getCmp("school_with_password").hide();Ext.getCmp("school_without_password").hide();Ext.util.Cookies.clear("__school_id_saved");Ext.util.Cookies.clear("__school_name_saved");Ext.getCmp("comboSchool").setValue("");try{var d=Ext.state.LocalStorageProvider.create();d.clear("school_id");d.clear("school_name")}catch(b){}Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/districts/"+this.district_id+"/children";Ext.getCmp("comboSchool").expand();Ext.getCmp("comboSchool").focus();setTimeout(function(){Ext.getStore("SchoolStore").load({callback:function(f,e,g){}})},250)},onSelectSchoolCollapse:function(b,a){Ext.getCmp("comboSchool").setValue();Ext.getStore("SchoolStore").clearFilter()},onLogin_btnClick:function(c,d,b){if(!LoginAttempt.active){if(!Ext.getCmp("school_password").validate()){Ext.Msg.alert("Please enter in a password.");return}LoginAttempt.active=true;var a=Ext.getCmp("school_password").value;school_data.id=this.school_id;school_data.name=this.school_name;Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login",params:{id:school_data.id,password:a},success:function(e){var g=Ext.decode(e.responseText);if(g.success){if(Ext.getCmp("school_selection_window")===undefined){}else{Ext.getCmp("school_selection_window").destroy()}if(g.access=="educator"){Ext.getStore("ClassStore").load();var h=Ext.create("BigBrainzLauncher.view.EducatorTreeViewport")}else{Ext.define("StudentPassword",{singleton:true,password:a});var f=Ext.create("BigBrainzLauncher.view.StudentViewport")}}else{Ext.Msg.alert(g.errors.reason)}LoginAttempt.active=false},failure:function(e,f){LoginAttempt.active=false;Ext.Msg.alert("Could not log in.  Please try again.")}})}},onLabelAfterRender:function(a,b){a.getEl().on({click:function(c){var d=Ext.create("BigBrainzLauncher.view.StudentNeedPassword");d.show()},scope:a})},onSchool_with_passwordAfterLayout:function(a,c,b){Ext.getCmp("school_password").focus();Ext.getCmp("school_password").on("specialkey",function(d,f){if(f.keyCode==f.ENTER){Ext.getCmp("login_btn").fireEvent("click",{})}})},onSchool_with_passwordAfterRender:function(a,b){Ext.define("LoginAttempt",{singleton:true,active:false});try{var c=Ext.urlDecode(document.URL.split("?")[1]);school_pass=c.school_pass;if(school_pass!==""&&school_pass!==undefined){Ext.getCmp("school_password").setValue(school_pass);Ext.getCmp("login_btn").fireEvent("click",{})}}catch(d){}},onSchool_selection_windowAfterRender:function(a,b){this.initialize();if(Ext.util.Cookies.get("__district_overview")=="true"){this.load_district_overview();return}this.load_region_data_from_url();this.load_region_data_from_cookies();if(this.is_defined(this.school_id)&&this.district_id!="BB02691691445231259433720081208183020372969"){this.load_school_login()}else{if(this.is_defined(this.district_id)){this.load_district_login()}else{this.display_default()}}Ext.tip.QuickTipManager.init();Ext.define("App.overrides.ToolTip",{override:"Ext.tip.ToolTip",dismissDelay:0});window.setShowAdditionAndSubtraction()},initialize:function(){Ext.Ajax.useDefaultXhrHeader=false;Ext.define("country_data",{singleton:true,id:"",name:""});Ext.define("state_data",{singleton:true,id:"",name:""});Ext.define("district_data",{singleton:true,id:"",name:""});Ext.define("school_data",{singleton:true,id:"",name:""});Ext.define("class_data",{singleton:true,id:"",name:""});Ext.define("student_data",{singleton:true,id:"",name:"",username:""});Ext.define("Ext.chart.theme.Fancy",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#66CC00","#0066cc","#FFFF00","#FF0000"]},a)])}});Ext.define("Ext.chart.theme.WeeklyUsage",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#0088dd","#0088dd"]},a)])}});String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1};this.school_id="";this.district_id="";this.state_id="";this.country_id="";this.school_name="";this.district_name="";this.state_name="";this.country_name="";Ext.define("Ext.chart.theme.FluencyTimeGraph",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#0000ff","#4169E1","#1E90FF","#00BFFF"]},a)])}});Ext.define("Ext.chart.theme.ImprovementChart",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#FF0000","#0066cc"]},a)])}});Ext.Ajax.on("requestexception",function(c,a,b){if(b.retries>0){b.retries-=1;Ext.Ajax.request(b)}});window.showAdditionAndSubtraction=true},load_district_overview:function(){if(Ext.getCmp("school_selection_window")){Ext.getCmp("school_selection_window").hide()}district_data.id=Ext.util.Cookies.get("__district_id_saved");district_data.name=Ext.util.Cookies.get("__district_name_saved");Ext.util.Cookies.clear("__district_overview");Ext.create("BigBrainzLauncher.view.DistrictOverview")},load_region_data_from_url:function(){if(document.URL.split("?").length<2){return}try{var a=Ext.urlDecode(document.URL.split("?")[1]);this.school_id=a.school_id;this.district_id=a.district_id;this.state_id=a.state_id;this.country_id=a.country_id;this.school_name=a.school_name;this.district_name=a.district_name;this.state_name=a.state_name;this.country_name=a.country_name}catch(b){}},load_region_data_from_cookies:function(){if(!this.is_defined(this.school_id)){this.school_id=Ext.util.Cookies.get("__school_id_saved");this.school_name=Ext.util.Cookies.get("__school_name_saved")}if(!this.is_defined(this.district_id)){this.district_id=Ext.util.Cookies.get("__district_id_saved");this.district_name=Ext.util.Cookies.get("__district_name_saved")}if(!this.is_defined(this.state_id)){this.state_id=Ext.util.Cookies.get("__state_id_saved");this.state_name=Ext.util.Cookies.get("__state_name_saved")}if(!this.is_defined(this.country_id)){this.country_id=Ext.util.Cookies.get("__country_id_saved");this.country_name=Ext.util.Cookies.get("__country_name_saved")}},load_singleton_data:function(){school_data.id=this.school_id;school_data.name=this.school_name;district_data.id=this.district_id;district_data.name=this.district_name;state_data.id=this.state_id;state_data.name=this.state_name;country_data.id=this.country_id;country_data.name=this.country_name},is_defined:function(a){return(a!==""&&a!==null&&a!==undefined)},load_school_login:function(){Ext.getCmp("selectSchool").setTitle(this.school_name);Ext.getCmp("selectDistrict").setTitle(this.district_name);Ext.getCmp("selectState").setTitle(this.state_name);Ext.getCmp("selectCountry").setTitle(this.country_name);Ext.getCmp("selectCountry").enable();Ext.getCmp("selectState").enable();Ext.getCmp("selectDistrict").enable();Ext.getCmp("selectSchool").enable();district_data.id=this.district_id;var a=this.school_id;Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+a+"/login_info";Ext.getStore("SchoolStore").load({callback:function(d,c,e){Ext.getCmp("comboSchool").select(a);var b=Ext.getCmp("comboSchool").findRecord("id",a);school_data.sitecode=b.data.IL_Site_Code;if(b.data.SeparateAdditionSubtraction===false){window.unsetShowAdditionAndSubtraction()}if(b.get("UseLogin")){Ext.getCmp("school_selection_window").hide();BigBrainzLauncher.view.LoginWindow.CreateForSchools();return}Ext.getCmp("school_login_panel").expand();Ext.getCmp("school_login_panel").show();if(b.data.HasPassword){setTimeout(function(){Ext.getCmp("school_with_password").show()},250)}else{setTimeout(function(){Ext.getCmp("school_without_password").show()},250)}}});Ext.getStore("ClassStore").proxy.url="routes/routes.php?url=/schools/"+this.school_id+"/children"},load_district_login:function(){Ext.getCmp("selectDistrict").setTitle(this.district_name);Ext.getCmp("selectState").setTitle(this.state_name);Ext.getCmp("selectCountry").setTitle(this.country_name);Ext.getCmp("selectCountry").enable();Ext.getCmp("selectState").enable();Ext.getCmp("selectDistrict").enable();var a=this.district_id;district_data.id=this.district_id;district_data.name=this.district_name;Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/districts/"+a+"/login_info",success:function(b){var c=Ext.decode(b.responseText);school_data.sitecode=c.IL_Site_Code;if(c.use_login){Ext.getCmp("school_selection_window").hide();BigBrainzLauncher.view.LoginWindow.CreateForDistricts();return}else{Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/districts/"+a+"/children";setTimeout(function(){Ext.getCmp("selectSchool").enable();Ext.getCmp("selectSchool").expand()},500)}},failure:function(){Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/districts/"+a+"/children";setTimeout(function(){Ext.getCmp("selectSchool").enable();Ext.getCmp("selectSchool").expand()},500)}})},display_default:function(){Ext.getCmp("selectCountry").setTitle("United States");country_data.id="BB01NOIP82414221620080617T170530968Z";country_data.name="United States";this.country_id=country_data.id;this.country_name=country_data.name;var a=new Date();var b=new Date(a.getFullYear()+1,a.getMonth(),a.getDate());Ext.util.Cookies.set("__country_id_saved",country_data.id,b);Ext.util.Cookies.set("__country_name_saved",country_data.name,b);setTimeout(function(){Ext.getCmp("selectState").enable();Ext.getCmp("selectCountry").collapse()},250)}});Ext.define("BigBrainzLauncher.view.ComprehensiveSummaryLegend",{extend:"Ext.window.Window",height:261,width:566,layout:{align:"stretch",pack:"center",type:"vbox"},closeAction:"hide",titleCollapse:true,modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"label",padding:"10% 0 0 0",style:"font-weight: bold;\r\nfont-size: 16px;",text:"Instant Overview Legend"}]},{xtype:"container",layout:{align:"stretch",padding:"10% 0 10% 0",type:"hbox"},items:[{xtype:"container",flex:1,hidden:true,padding:"0 0 0 25%",layout:{align:"center",type:"vbox"},items:[{xtype:"label",padding:"0 0 30px 0",style:"font-weight: bold;",text:"Untested"},{xtype:"container",height:15,style:"background-color: #808080;",width:15}]},{xtype:"container",flex:1,hidden:true,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"label",style:"font-weight: bold;",text:"Not Progressing"},{xtype:"label",padding:"0 0 15px 0",text:"(Hasn't played in 30 days)"},{xtype:"container",style:"background-color: white;",width:100,layout:{pack:"center",type:"hbox"},items:[{xtype:"container",margins:"0 5px 0 0",height:15,style:"background-color:red;",width:15},{xtype:"container",margins:"0 5px 0 0",height:15,padding:"0 5px 0 0",style:"background-color:red;\r\nopacity: 0.80;\r\nfilter: alpha(opacity=80);",width:15},{xtype:"container",margins:"0 5px 0 0",height:15,padding:"0 5px 0 0",style:"background-color:red;\r\nopacity: 0.60;\r\nfilter: alpha(opacity=60);",width:15},{xtype:"container",margins:"0 5px 0 0",height:15,padding:"0 5px 0 0",style:"background-color:red;\r\nopacity: 0.40;\r\nfilter: alpha(opacity=40);",width:15},{xtype:"container",height:15,padding:"0 5px 0 0",style:"background-color:red;\r\nopacity: 0.20;\r\nfilter: alpha(opacity=20);",width:15}]},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"image",padding:"0 65 0 0",src:"images/up_arrow.png"},{xtype:"image",padding:"",src:"images/up_arrow.png"}]},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"label",text:"0%"},{xtype:"label",margin:"0 20 0 20",text:"-"},{xtype:"label",text:"100%"}]},{xtype:"label",flex:1,text:"Fluency"}]},{xtype:"container",flex:1,layout:{align:"center",type:"vbox"},items:[{xtype:"label",style:"font-weight: bold;",text:"Progressing"},{xtype:"label",padding:"0 0 15px 0",text:""},{xtype:"container",style:"background-color: white;",width:100,layout:{pack:"center",type:"hbox"},items:[{xtype:"container",margins:"0 5px 0 0",height:15,style:"background-color:#0066CB;\r\nopacity: 0.20;\r\nfilter: alpha(opacity=20);",width:15},{xtype:"container",margins:"0 5px 0 0",height:15,padding:"0 5px 0 0",style:"background-color:#0066CB;\r\nopacity: 0.40;\r\nfilter: alpha(opacity=40);",width:15},{xtype:"container",margins:"0 5px 0 0",height:15,padding:"0 5px 0 0",style:"background-color:#0066CB;\r\nopacity: 0.60;\r\nfilter: alpha(opacity=60);",width:15},{xtype:"container",margins:"0 5px 0 0",height:15,padding:"0 5px 0 0",style:"background-color:#0066CB;\r\nopacity: 0.80;\r\nfilter: alpha(opacity=80);",width:15},{xtype:"container",height:15,padding:"0 5px 0 0",style:"background-color:#0066CB;",width:15}]},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"image",padding:"0 65 0 0",src:"images/up_arrow.png"},{xtype:"image",padding:"",src:"images/up_arrow.png"}]},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"label",text:"0%"},{xtype:"label",margin:"0 20 0 20",text:"-"},{xtype:"label",text:"100%"}]},{xtype:"label",flex:1,text:"Fluency"}]},{xtype:"container",flex:1,padding:"",layout:{align:"center",type:"vbox"},items:[{xtype:"label",padding:"0 0 30px 0",style:"font-weight: bold;",text:"Finished"},{xtype:"container",height:15,style:"background-color: #00ff00;",width:15}]}]},{xtype:"label",padding:"0 25 0 25",text:"Each dot represents one student at the school.  If they're blue, they're playing, but not finished yet. Green means they're finished. The darkness of blue how fluent they are."},{xtype:"label",hidden:true,padding:"0 0 0 550",text:"*Summary tab shows their most-finished operation."}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.EmailSpecificReport",{extend:"Ext.window.Window",height:500,width:712,autoScroll:true,layout:{align:"stretch",type:"vbox"},title:"Specifi Reports",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"gridpanel",flex:1,margin:10,header:false,title:"Edit Individual Classes",store:"ClassStore",columns:[{xtype:"gridcolumn",dataIndex:"name",text:"Name",flex:1,editor:{xtype:"textfield"}},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){if(g=="0"){return"K"}if(g=="8"){return"8+"}if(g=="9"){return"Pre-K"}return g},dataIndex:"grade",text:"Grade",editor:{xtype:"combobox",displayField:"display",store:["Pre-K","K","1","2","3","4","5","6","7","8+"],valueField:"value"}}],selModel:Ext.create("Ext.selection.CheckboxModel",{})},{xtype:"container",flex:0,layout:{align:"stretch",type:"hbox"},items:[{xtype:"textfield",flex:1,fieldLabel:"Email"},{xtype:"button",text:"Send",listeners:{click:{fn:a.onButtonClick,scope:a}}}]}]});a.callParent(arguments)},onButtonClick:function(d,f,c){var b=d.prev("textfield").value;if(!Ext.String.endsWith(b,"@bigbrainz.com",true)){alert("bad");return}var a="Class_Index";if(d.up("window").down("grid").store.storeId=="SchoolStore"){a="School_Index"}var h=[];Ext.Array.forEach(d.up("window").down("grid").getSelectionModel().getSelection(),function(e){h.push({id:e.get("id"),name:e.get("name"),index:a})});var g={year:"current",regions:JSON.stringify(h),email:b};Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/schools/summaries",params:g,success:function(e){},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})}});Ext.define("BigBrainzLauncher.view.ReportYearSelector",{extend:"Ext.form.field.ComboBox",alias:"widget.reportyearselector",itemId:"reportYearSelector",fieldLabel:"Year",labelAlign:"right",value:"current",allowBlank:false,editable:false,forceSelection:true,queryMode:"local",initComponent:function(){var a=this;Ext.applyIf(a,{store:[["current","Current Year"],["2015_2016","2015-2016"],["2014_2015","2014-2015"],["2013_2014","2013-2014"],["2012_2013","2012-2013"],["alltime","All Time"]]});a.callParent(arguments)},getTimestamps:function(){var e=[];var d=Ext.ComponentQuery.query("#reportYearSelector")[0].value;if(d=="current"){var a=new Date();var c=a.getFullYear();if(new Date().getMonth()<7){c-=1}e[0]=Math.ceil(new Date(c,6,1).getTime()/1000);e[1]=Math.ceil(new Date(c+1,7,1).getTime()/1000)}else{var b=d.split("_");e[0]=Math.ceil(new Date(b[0],7,1).getTime()/1000);e[1]=Math.ceil(new Date(b[1],7,1).getTime()/1000)}return e}});Ext.define("BigBrainzLauncher.view.StudentMultipleDetails",{extend:"Ext.window.Window",alias:"widget.studentMultipleDetails",height:270,style:"opacity:.95;\r\nfilter: alpha(opacity=95);",width:282,bodyStyle:"opacity:.95;\r\nfilter: alpha(opacity=95);",closeAction:"hide",title:"Student Details",titleAlign:"center",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",padding:"10 0 0 0",layout:{align:"stretch",pack:"center",type:"hbox"},items:[{xtype:"label",itemId:"studentDetailsName",style:"font-weight:bold;\r\nfonti-size:14px;",text:"name"}]},{xtype:"container",itemId:"studentMultipleDetailsTA9",layout:{align:"center",padding:"0 0 10 0",type:"vbox"},items:[{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",itemId:"pretestLabel",text:"Multiplication Pre-Test:"},{xtype:"label",itemId:"pretestScore",padding:"0 0 0 5",text:"43%"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"progressPosttestLabel",text:"Multiplicaiton Post-test:"},{xtype:"label",flex:1,itemId:"progressPosttestScore",padding:"0 0 0 5",text:"94%"}]}]},{xtype:"container",itemId:"studentMultipleDetailsDivision",layout:{align:"center",padding:"0 0 10 0",type:"vbox"},items:[{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",itemId:"pretestLabel",text:"Division Pre-Test:"},{xtype:"label",itemId:"pretestScore",padding:"0 0 0 5",text:"43%"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"progressPosttestLabel",text:"Division Post-test:"},{xtype:"label",flex:1,itemId:"progressPosttestScore",padding:"0 0 0 5",text:"94%"}]}]},{xtype:"container",itemId:"studentMultipleDetailsAddition",layout:{align:"center",padding:"0 0 10 0",type:"vbox"},items:[{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",itemId:"pretestLabel",text:"Addition Pre-Test:"},{xtype:"label",itemId:"pretestScore",padding:"0 0 0 5",text:"43%"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"progressPosttestLabel",text:"Addition Post-test:"},{xtype:"label",flex:1,itemId:"progressPosttestScore",padding:"0 0 0 5",text:"94%"}]}]},{xtype:"container",itemId:"studentMultipleDetailsSubtraction",layout:{align:"center",type:"vbox"},items:[{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",itemId:"pretestLabel",text:"Subtraction Pre-Test:"},{xtype:"label",itemId:"pretestScore",padding:"0 0 0 5",text:"43%"}]},{xtype:"container",layout:{align:"stretch",padding:"5 0 0 0",type:"hbox"},items:[{xtype:"label",flex:1,itemId:"progressPosttestLabel",text:"Subtraction Post-test:"},{xtype:"label",flex:1,itemId:"progressPosttestScore",padding:"0 0 0 5",text:"94%"}]}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.OperationOrderEditor",{extend:"Ext.container.Container",alias:"widget.operationOrderEditor",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",layout:{align:"stretch",type:"hbox"},items:[{xtype:"checkboxfield",handler:function(c,b){if(b){c.up("window").down("#operationOrderingEditable").enable();c.next().enable()}else{c.up("window").down("#operationOrderingEditable").disable();c.next().disable()}},fieldLabel:"Force Operation Ordering:",labelWidth:145,boxLabel:""},{xtype:"button",handler:function(c,d){var b=c.up("operationOrderEditor").ooLevel;var e=c.up("operationOrderEditor").id;if(b===null||b===undefined||b==="school"){Ext.Ajax.request({method:"DELETE",url:"routes/routes.php?url=/schools/"+school_data.id+"/attribute/OperationOrder",success:function(f){var g=Ext.decode(f.responseText);if(g.success){Ext.Msg.alert("Success","Forced Operation Order has been removed.");c.up().down("checkbox").setValue(false)}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})}if(b==="class"){Ext.Ajax.request({method:"DELETE",url:"routes/routes.php?url=/classes/"+e+"/attribute/OperationOrder",success:function(f){var g=Ext.decode(f.responseText);if(g.success){Ext.Msg.alert("Success","Forced Operation Order has been removed.");c.up().down("checkbox").setValue(false)}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})}if(b==="student"){Ext.Ajax.request({method:"DELETE",url:"routes/routes.php?url=/games/"+e+"/attribute/OperationOrder",success:function(f){var g=Ext.decode(f.responseText);if(g.success){Ext.Msg.alert("Success","Forced Operation Order has been removed.");c.up().down("checkbox").setValue(false)}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})}},disabled:true,text:"Remove Operation Ordering"}]},{xtype:"container",disabled:true,itemId:"operationOrderingEditable",items:[{xtype:"label",text:"Drag and drop to set operation order."},{xtype:"gridpanel",height:25,width:280,title:"",columns:[{xtype:"gridcolumn",width:70,resizable:false,defaultWidth:50,sortable:false,align:"center",hideable:false,text:"Addition"},{xtype:"gridcolumn",width:70,resizable:false,defaultWidth:50,sortable:false,align:"center",hideable:false,text:"Subtraction"},{xtype:"gridcolumn",width:70,resizable:false,defaultWidth:50,sortable:false,align:"center",hideable:false,text:"Multiplication"},{xtype:"gridcolumn",width:70,resizable:false,defaultWidth:50,sortable:false,align:"center",hideable:false,text:"Division"}]},{xtype:"button",handler:function(l,c){var b=l.prev();var n=b.columns[0].x/70;var m=b.columns[1].x/70;var o=b.columns[2].x/70;var f=b.columns[3].x/70;var h=[];h[n]="a";h[m]="s";h[o]="m";h[f]="d";var g={};g.a=[];g.s=[];g.m=[];g.d=[];for(var k=n-1;k>=0;k--){g.a.push(h[k])}for(k=m-1;k>=0;k--){g.s.push(h[k])}for(k=o-1;k>=0;k--){g.m.push(h[k])}for(k=f-1;k>=0;k--){g.d.push(h[k])}var e=l.up("operationOrderEditor").ooLevel;var d=l.up("operationOrderEditor").id;if(e==="school"||e===null||e===undefined){Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/schools",params:{ItemName:school_data.id,OperationOrder:Ext.JSON.encode(g)},success:function(p){var q=Ext.decode(p.responseText);if(q.success){Ext.getStore("SchoolStore").data.items[0].data.OperationOrder=Ext.JSON.encode(g);Ext.Msg.alert("Success","The operation order has been updated.")}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})}if(e==="class"){Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/classes",params:{ItemName:d,OperationOrder:Ext.JSON.encode(g)},success:function(p){var q=Ext.decode(p.responseText);if(q.success){Ext.Msg.alert("Success","The operation order has been updated.");Ext.getStore("SchoolTreeStore").getNodeById(d).data.OperationOrder=Ext.JSON.encode(g)}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})}if(e==="student"){Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/games",params:{ItemName:d,OperationOrder:Ext.JSON.encode(g)},success:function(p){var q=Ext.decode(p.responseText);if(q.success){Ext.Msg.alert("Success","The operation order has been updated.");Ext.getStore("SchoolTreeStore").getNodeById(d).data.OperationOrder=Ext.JSON.encode(g)}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})}},text:"Set Order"}]}]});a.callParent(arguments)},setOrdering:function(b,d){this.ooLevel=b;this.id=d;var a=null;if(b==="student"){a=Ext.JSON.decode(Ext.getStore("SchoolTreeStore").getNodeById(d).data.OperationOrder)}if(b==="class"){a=Ext.JSON.decode(Ext.getStore("SchoolTreeStore").getNodeById(d).data.OperationOrder)}if(b==="school"){a=Ext.JSON.decode(Ext.getStore("SchoolStore").first().get("OperationOrder"))}var c=this.down("grid");if(a===null){c.up("window").down("checkbox").setValue(false);return}setTimeout(function(){c.up("operationOrderEditor").down("checkbox").setValue(true);var h=c.columns[0].x/70;c.headerCt.moveHeader(h,a.a.length);var e=c.columns[1].x/70;c.headerCt.moveHeader(e,a.s.length);var g=c.columns[2].x/70;c.headerCt.moveHeader(g,a.m.length);var f=c.columns[3].x/70;c.headerCt.moveHeader(f,a.d.length)},500)}});Ext.define("BigBrainzLauncher.view.FriendlyModeCheckbox",{extend:"Ext.container.Container",alias:"widget.friendlyModeCheckbox",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"checkboxfield",itemId:"friendlyModeCheckbox",padding:"10px",style:"text-align:center;",fieldLabel:"Friendly Mode<br />(Available in version 8.16 and later)",labelWidth:200,boxLabel:"",listeners:{change:{fn:a.onFriendlyModeCheckboxChange,scope:a}}}]});a.callParent(arguments)},onFriendlyModeCheckboxChange:function(e,d,b,c){var a="";if(window.fmc.index==="School_Index"){a="/schools"}if(window.fmc.index==="Class_Index"){a="/classes"}if(window.fmc.index==="Student_Index"){a="/games"}Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url="+a,params:{ItemName:window.fmc.id,FriendlyMode:d},success:function(f){var g=Ext.decode(f.responseText);if(g.success){Ext.Msg.alert("Success","The friendly mode has been updated.")}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})}});Ext.define("BigBrainzLauncher.view.SetMultSchoolYear",{extend:"Ext.window.Window",height:500,itemId:"setMultSchoolYear",minHeight:300,width:400,layout:{type:"fit"},closeAction:"hide",title:"Set School Year For Multiple Classes",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{dockedItems:[{xtype:"toolbar",dock:"top",style:"border: solid 1px #99BBE8; margin: 0;background-color:#D9E5F3;",ui:"footer",items:[{xtype:"combobox",emptyText:"Set Year...",store:["Current Year","Last Year"]},{xtype:"button",disabled:true,itemId:"setYearMultipleBtn",text:"Set Year"}]}],items:[{xtype:"gridpanel",itemId:"multipleClassGrid",autoScroll:true,store:"ClassStore",columns:[{xtype:"gridcolumn",dataIndex:"name",text:"Name",flex:1}],selModel:Ext.create("Ext.selection.CheckboxModel",{})}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.store.CountryStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.CountryModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({autoLoad:true,model:"BigBrainzLauncher.model.CountryModel",storeId:"CountryStore",sorters:{sorterFn:function(d,c){d=d.get("name");c=c.get("name");if(d=="United States"){return -1}if(c=="United States"){return 1}if(d=="United Kingdom"){return -1}if(c=="United Kingdom"){return 1}if(d=="Canada"){return -1}if(c=="Canada"){return 1}return d>c?1:(d<c?-1:0)}},proxy:{type:"ajax",url:"routes/routes.php?url=/countries",reader:{type:"json",root:"data"}},listeners:{beforeload:{fn:b.onJsonstoreBeforeLoad,scope:b}}},a)])},onJsonstoreBeforeLoad:function(b,a,c){return false}});Ext.define("BigBrainzLauncher.store.StateStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.StateModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.StateModel",storeId:"StateStore",proxy:{type:"ajax",url:"",reader:{type:"json",root:"data"}},sorters:{property:"name"}},a)])}});Ext.define("BigBrainzLauncher.store.DistrictStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.DistrictModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.DistrictModel",storeId:"DistrictStore",proxy:{type:"ajax",url:"",reader:{type:"json",root:"data"}},sorters:{property:"name"}},a)])}});Ext.define("BigBrainzLauncher.store.SchoolStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.SchoolModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.SchoolModel",storeId:"SchoolStore",proxy:{type:"ajax",url:"",reader:{type:"json",root:"data"}},sorters:{sorterFn:function(d,c){d=d.get("name");c=c.get("name");if(d=="District Overview"){return -1}if(c=="District Overview"){return 1}return d>c?1:(d<c?-1:0)},property:"name"}},a)])}});Ext.define("BigBrainzLauncher.store.ClassStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.ClassModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.ClassModel",storeId:"ClassStore",proxy:{type:"ajax",url:"",reader:{type:"json",root:"data"}},sorters:{property:"name"},listeners:{beforeload:{fn:b.onJsonstoreBeforeLoad,scope:b}}},a)])},onJsonstoreBeforeLoad:function(d,c,e){a(d);var g=[];var b=new Date();var f=b.getFullYear();if(new Date().getMonth()<7){f-=1}g[0]=Math.ceil(new Date(f,6,1).getTime()/1000);g[1]=Math.ceil(new Date(f+1,7,1).getTime()/1000);if(Ext.ComponentQuery.query("#reportYearSelector")[0]!==undefined&&Ext.ComponentQuery.query("#reportYearSelector")[0].getTimestamps!==undefined){g=Ext.ComponentQuery.query("#reportYearSelector")[0].getTimestamps()}d.proxy.url+="/"+g[0]+","+g[1];function a(k){var h=k.proxy.url;k.proxy.url=h.replace(/\/[0-9]{10},[0-9]{10}/,"")}}});Ext.define("BigBrainzLauncher.store.GameStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.GameModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.GameModel",storeId:"GameStore",proxy:{type:"ajax",url:"",reader:{type:"json",root:"data"}},sorters:{property:"name"}},a)])},loadFrom:function(b,e){var f={};f.data=[];var d=b.length;for(var c=0;c<d;c++){f.data.push(b[c].data.data);if(b[c].data.data.progress_report.ninja2!==undefined){var a={};a.id=b[c].data.data.id+"_ninja";a.name=b[c].data.data.name+" (Ninja)";a.password=b[c].data.data.password;a.username=b[c].data.data.username;a.to_play_data=b[c].data.data.to_play_data;a.retest_data=b[c].data.data.retest_data;a.fluency_test_scores=b[c].data.data.fluency_test_scores;a.progress_report={};a.progress_report.ta9=b[c].data.data.progress_report.ninja2;a.progress_report.ta9.name+=" (Ninja)";f.data.push(a)}}f.total=f.data.length;Ext.getStore("GameStore").loadRawData(f);BigBrainzLauncher.getApplication().fireEvent("studentsLoaded",e)}});Ext.define("BigBrainzLauncher.store.AddGameStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.GameModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.GameModel",storeId:"MyArrayStore",proxy:{type:"ajax",reader:{type:"array"}}},a)])}});Ext.define("BigBrainzLauncher.store.AddClassStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.ClassModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.ClassModel",storeId:"MyArrayStore1",proxy:{type:"ajax",url:"",reader:{type:"array"}}},a)])}});Ext.define("BigBrainzLauncher.store.SchoolTreeStore",{extend:"Ext.data.TreeStore",requires:["BigBrainzLauncher.model.TreeModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({autoLoad:false,model:"BigBrainzLauncher.model.TreeModel",storeId:"school_tree_store",folderSort:true,root:{text:"School",id:"0",iconCls:"school-icon"},proxy:{type:"ajax",reader:{type:"json"}},sorters:{property:"text"},listeners:{beforeload:{fn:b.onTreeStoreBeforeLoad,scope:b},load:{fn:b.onTreeStoreLoad,scope:b}}},a)])},onTreeStoreBeforeLoad:function(c,b,d){var f=[];var a=new Date();var e=a.getFullYear();if(new Date().getMonth()<7){e-=1}f[0]=Math.ceil(new Date(e,6,1).getTime()/1000);f[1]=Math.ceil(new Date(e+1,7,1).getTime()/1000);if(Ext.ComponentQuery.query("#reportYearSelector")[0]!==undefined){f=Ext.ComponentQuery.query("#reportYearSelector")[0].getTimestamps()}b.params.dates=Ext.encode(f);if(typeof StudentPassword!=="undefined"){b.params.pass=StudentPassword.password}},onTreeStoreLoad:function(a,d,b,e,c){if(d.data.id=="0"){return}if(b===null){return}Ext.getStore("GameStore").loadFrom(b,d.data.id)}});Ext.define("BigBrainzLauncher.store.WeeklyProgressStore",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"MyArrayStore2",fields:[{dateFormat:"timestamp",name:"timestamp",type:"date"},{name:"f",type:"int"},{name:"p",type:"int"},{name:"np",type:"int"},{name:"dnp"},{name:"date",type:"string"}]},a)])}});Ext.define("BigBrainzLauncher.store.PosttestScoresStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.TestModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"SchoolPosttestScoresStore",model:"BigBrainzLauncher.model.TestModel"},a)])}});Ext.define("BigBrainzLauncher.store.StudentWeeklyMinutes",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"StudentWeeklyMinutes",fields:[{name:"week_number"},{name:"minutes"}]},a)])}});Ext.define("BigBrainzLauncher.store.GameDataStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.GameDataModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.GameDataModel",storeId:"GameDataStore",proxy:{type:"ajax",reader:{type:"json",root:"data"}}},a)])}});Ext.define("BigBrainzLauncher.store.ClassPasswordsStore",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"ClassPasswordsStore",proxy:{type:"ajax",reader:{type:"json",root:"data"}},fields:[{name:"name"},{name:"password"}]},a)])}});Ext.define("BigBrainzLauncher.store.DistrictReportStore",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"DistrictReportStore",fields:[{name:"name"},{name:"pretest_taken"},{name:"pretest_avg"},{name:"_10"},{name:"_20"},{name:"_30"},{name:"_40"},{name:"_50"},{name:"_60"},{name:"_70"},{name:"_80"},{name:"_90"},{name:"posttest_taken"},{name:"posttest_avg"},{name:"total_hours",type:"int"},{name:"avg_hours"},{name:"id"},{name:"purchase_status"},{name:"not_playing"},{name:"progressPerHour"},{name:"avg_improvement"}],sorters:{direction:"DESC",property:"total_hours"}},a)])}});Ext.define("BigBrainzLauncher.store.PretestChartStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.TestModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.TestModel",storeId:"PretestChartStore",proxy:{type:"ajax",reader:{type:"json"}}},a)])}});Ext.define("BigBrainzLauncher.store.PosttestChartStore",{extend:"Ext.data.Store",requires:["BigBrainzLauncher.model.TestModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({model:"BigBrainzLauncher.model.TestModel",storeId:"PosttestChartStore",proxy:{type:"ajax",reader:{type:"json"}}},a)])}});Ext.define("BigBrainzLauncher.store.AverageImprovementStore",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"MyArrayStore8",fields:[{name:"grade"},{name:"pretest_avg"},{name:"posttest_avg"},{name:"pretest_count"},{name:"posttest_count"}]},a)])}});Ext.define("BigBrainzLauncher.store.GameProgressStore",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"MyArrayStore9",fields:[{name:"name"},{name:"pretest"},{name:"progress"},{name:"posttest"},{name:"minutes"},{name:"id"},{name:"adj_pretest"},{name:"in_progress"}],sorters:{property:"name"}},a)])}});Ext.define("BigBrainzLauncher.store.SchoolSummary",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"MyArrayStore10",fields:[{name:"school_id"},{name:"name"},{name:"hours"},{name:"fluent"},{name:"usage"},{name:"fluency"},{name:"not_fluent"}]},a)])}});Ext.define("BigBrainzLauncher.store.FluencyTimeStore",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"FluencyTimeStore",fields:[{name:"percent_complete",type:"int"},{name:"less_than_60",type:"int"},{name:"between_60_180",type:"int"},{name:"between_180_360",type:"int"},{name:"greather_than_360",type:"int"}]},a)])}});Ext.define("BigBrainzLauncher.store.ImportClassListStore",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"MyArrayStore12",fields:[{name:"class_name"},{name:"student_name"},{name:"password"},{name:"username"}]},a)])}});Ext.define("BigBrainzLauncher.store.DistrictTreeStore",{extend:"Ext.data.TreeStore",requires:["BigBrainzLauncher.model.TreeModel"],constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({autoLoad:false,model:"BigBrainzLauncher.model.TreeModel",storeId:"DistrictTreeStore",folderSort:true,root:{text:"District",id:"0",iconCls:"school-icon"},proxy:{type:"ajax",reader:{type:"json"}},sorters:{property:"text"}},a)])}});Ext.define("BigBrainzLauncher.store.DailyProgressStore",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"DailyProgressStore",fields:[{dateFormat:"timestamp",name:"timestamp",type:"date"},{name:"f",type:"int"},{name:"p",type:"int"},{name:"np",type:"int"},{name:"date",type:"string"}]},a)])}});Ext.define("BigBrainzLauncher.store.AutoReportEmail",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"MyJsonStore",proxy:{type:"ajax",reader:{type:"json"}},fields:[{name:"teacher_name"},{name:"email"},{name:"index"},{name:"frequency"},{name:"approved"},{name:"history"},{name:"region_id"},{name:"id"}]},a)])}});Ext.define("BigBrainzLauncher.controller.ImprovementChart",{extend:"Ext.app.Controller",refs:[{ref:"improvementChart",selector:"#improvementChart",xtype:"Ext.chart.Chart"},{ref:"schoolReportTabs",selector:"#schoolReportTabs",xtype:"Ext.tab.Panel"},{ref:"reportYearSelector",selector:"#reportYearSelector"}],onDistrictSelected:function(a){this.updateImprovementCharts(a)},onSchoolSelected:function(a){this.updateImprovementCharts(a)},onClassSelected:function(a){this.updateImprovementCharts(a)},onReportTabChange:function(a){this.update(a)},onReportYearSelected:function(a){var b=school_data.id;if(b===null||b===undefined||b===""){this.updateImprovementCharts(district_data.id)}else{this.updateImprovementCharts(school_data.id)}},updateImprovementCharts:function(e){var c=this.getImprovementChart();if(c===undefined||c===null){return}if(c.rendered){c.mask()}var b="current";if(this.getReportYearSelector()!==undefined&&this.getReportYearSelector()!==null){b=this.getReportYearSelector().value}var d=this.getSchoolReportTabs().active_app_id();var a=this;Ext.Ajax.request({retries:2,method:"GET",url:"routes/routes.php?url=/districts/"+e+"/avg_test_scores/"+b,success:function(f){c.data=Ext.decode(f.responseText);a.update(d)},failure:function(){Ext.Msg.alert("Could not load improvement report.  Please try again.")},callback:function(){c.unmask()}})},update:function(a){if(this.getImprovementChart().data===undefined||this.getImprovementChart().data===null){return}Ext.getStore("AverageImprovementStore").loadRawData(this.getImprovementChart().data[a]);setTimeout(function(){Ext.getStore("AverageImprovementStore").filterBy(function(b,c){if(b.get("pretest_count")<1){return false}if(b.get("grade")==="K"){return false}if(b.get("grade")==="all"){return true}if(b.get("grade")>=0&&b.get("grade")<=8){return true}else{return false}})},2000)},init:function(a){a.on({districtSelected:{fn:this.onDistrictSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},reportTabChange:{fn:this.onReportTabChange,scope:this},reportYearSelected:{fn:this.onReportYearSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.EducatorMenu",{extend:"Ext.app.Controller",refs:[{ref:"reportYearSelector",selector:"#reportYearSelector",xtype:"Ext.form.field.ComboBox"},{ref:"multipleDeletionGrid",selector:"#multipleDeletionGrid",xtype:"Ext.grid.Panel"},{ref:"schoolTree",selector:"#schoolTree",xtype:"Ext.tree.Panel"},{ref:"classReportGrid",selector:"#classReportGrid"},{ref:"studentReportPage",selector:"#studentReportPage"},{ref:"schoolReportTabs",selector:"#schoolReportTabs"},{ref:"overviewReportGrid",selector:"#overviewReportGrid"}],onReportYearSelected:function(c,a,b){this.application.fireEvent("reportYearSelected",c.value)},deleteMutiple:function(f,h,l){var k=f.up("window");var a=this.getMultipleDeletionGrid();var c=a.getSelectionModel().getSelection();var b=c.length;var g=this.getSchoolTree();var d=this;if(c.length<1){Ext.MessageBox.alert("Big Brainz","Please select someone to delete.");return}k.callback(g,b,c,k,d)},openDeleteMultipleStudentsWindow:function(c,f,b){var a=this.getSchoolTree();if(a.getSelectionModel().getSelection().length<1||a.getSelectionModel().getSelection()[0].data.id==="0"||a.getSelectionModel().getSelection()[0].data.leaf){Ext.MessageBox.show({title:"Please select a class",msg:"Please select a class before deleting students."});return}var d=Ext.ComponentQuery.query("#deleteMultipleWindow")[0];if(d===undefined||d===null){d=Ext.create("BigBrainzLauncher.view.DeleteMultipleWindow");d.callback=function(e,l,h,k,g){var m=e.getSelectionModel().getSelection()[0].data.id;Ext.MessageBox.confirm("Delete Students?","Are you sure you want to delete "+Ext.util.Format.plural(l,"student","students")+"?",function(n){if(n=="yes"){var o=[];for(i=0;i<l;i++){o.push(h[i].data.id)}k.getEl().mask();g.deleteStudents(o,function(){var p=e.getSelectionModel().getSelection()[0];setTimeout(function(){var q;while(q=e.getRootNode().childNodes[0]){e.getRootNode().removeChild(q)}Ext.getStore("SchoolTreeStore").load({callback:function(t,s,u){e.getSelectionModel().select(p)}});k.getEl().unmask();k.close()},1000)})}})}}d.setTitle("Delete Multiple Students");this.getMultipleDeletionGrid().reconfigure(Ext.getStore("GameStore"));d.show()},openDeleteMultipleClassesWindow:function(b,d,a){var c=Ext.ComponentQuery.query("#deleteMultipleWindow")[0];if(c===undefined||c===null){c=Ext.create("BigBrainzLauncher.view.DeleteMultipleWindow");c.callback=function(e,k,g,h,f){Ext.MessageBox.confirm("Delete Classes?","Are you sure you want to delete "+Ext.util.Format.plural(k,"class","classes")+"?",function(l){if(l=="yes"){var m=[];for(i=0;i<k;i++){if(g[i].data.PilotClass&&g[i].data.PilotClass!="false"){continue}m.push(g[i].data.id)}h.getEl().mask();test_this=this;f.deleteClasses(m,function(){setTimeout(function(){var n;while(n=e.getRootNode().childNodes[0]){e.getRootNode().removeChild(n)}Ext.getStore("ClassStore").load();Ext.getStore("SchoolTreeStore").load();h.getEl().unmask();h.close()},1000)})}})}}c.setTitle("Delete Multiple Classes");this.getMultipleDeletionGrid().reconfigure(Ext.getStore("ClassStore"));c.show()},openAddClassesWindow:function(b,d,a){var c=Ext.ComponentQuery.query("#addClassesWindow")[0];if(c===undefined||c===null){c=Ext.create("BigBrainzLauncher.view.AddClassesWindow")}c.show()},openAddStudentsWindow:function(b,d,a){if(Ext.getCmp("school_tree").getSelectionModel().getSelection().length<1||Ext.getCmp("school_tree").getSelectionModel().getSelection()[0].data.id==="0"){Ext.MessageBox.show({title:"Please select a class",msg:"Please select a class before adding students."})}else{var c=Ext.ComponentQuery.query("#addStudentsWindow")[0];if(c===undefined||c===null){c=Ext.create("BigBrainzLauncher.view.AddStudentsWindow")}c.show()}},openImportClassListWindow:function(b,d,a){var c=Ext.ComponentQuery.query("#importClassWindow")[0];if(c===undefined||c===null){c=Ext.create("BigBrainzLauncher.view.ImportClassWindow")}c.show()},onDeleteSelected:function(c,h,b){var a=this.getSchoolTree();var f=a.getSelectionModel().getSelection();if(f.length<1){Ext.MessageBox.alert("Big Brainz","Please select a class or student to delete")}f=f[0];if(f.data.id==="0"){Ext.MessageBox.alert("Big Brainz","Please select a class or student to delete")}var g=new Date().getTime();g=Math.floor(g/1000);if(f.data.leaf){Ext.MessageBox.confirm("Delete Student?","Are you sure you want to delete "+f.data.text+"?",function(e){if(e=="yes"){var k={ItemName:f.data.id,DeletionDate:g};Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/games",params:k,success:function(l){res=Ext.decode(l.responseText);if(res){setTimeout(function(){var m;while(m=a.getRootNode().childNodes[0]){a.getRootNode().removeChild(m)}Ext.getStore("ClassStore").load();Ext.getStore("SchoolTreeStore").load()},1000)}else{Ext.Msg.alert(res.error)}},failure:function(){Ext.Msg.alert("Could not delete classes.  Please try again.")}})}})}else{var d=Ext.getStore("ClassStore").data.items[Ext.getStore("ClassStore").find("id",f.data.id)];if(d.data.PilotClass!==null&&d.data.PilotClass.toLowerCase()=="true"){Ext.MessageBox.show({title:"Cannot Delete This Class",msg:"This is a special class and cannot be deleted."});return}Ext.MessageBox.confirm("Delete Class?",'Are you sure you want to delete "'+f.data.text+"\" class and all of it's students?",function(e){if(e=="yes"){var k={ItemName:f.data.id,DeletionDate:g};Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/classes",params:k,success:function(l){res=Ext.decode(l.responseText);if(res){setTimeout(function(){var m;while(m=a.getRootNode().childNodes[0]){a.getRootNode().removeChild(m)}Ext.getStore("ClassStore").load();Ext.getStore("SchoolTreeStore").load()},1000)}else{Ext.Msg.alert(res.error)}},failure:function(){Ext.Msg.alert("Could not delete classes.  Please try again.")}})}})}},openEditSchoolPasswordsWindow:function(b,c,a){var d=Ext.ComponentQuery.query("editSchoolPasswordWindow")[0];if(d===undefined){d=Ext.create("BigBrainzLauncher.view.EditSchoolPasswordsWindow")}d.show()},openEditStudentNamesPasswordsWindow:function(c,f,b){var d=Ext.getCmp("school_tree").getSelectionModel().getSelection();if(d.length<1){Ext.MessageBox.alert("Big Brainz","Please select a class before editing.");return}d=d[0];if(d.data.id==="0"){Ext.MessageBox.alert("Big Brainz","Please select a class before editing.");return}var a=Ext.ComponentQuery.query("editStudentsWindow")[0];if(a===undefined){a=Ext.create("BigBrainzLauncher.view.EditStudentsWindow")}a.show()},onOpenEditClassNames:function(c,d,b){var a=Ext.ComponentQuery.query("editClassesWindow")[0];if(a===undefined){a=Ext.create("BigBrainzLauncher.view.EditClassesWindow")}a.show()},onBack:function(b,c,a){window.location.reload()},onPrint:function(c,f,b){var d=this.getSchoolTree().getSelectionModel().getSelection();if(d.length<1||d[0].data.id==="0"){this.getOverviewReportGrid().print()}else{if(d[0].data.leaf){var a=this.getSchoolReportTabs().active_app_id();if(a==="addsub"){alert("Printing of Addition/Subtraction is not currently available.");return}this.getStudentReportPage().print()}else{this.getClassReportGrid().down().next().print()}}},onCheckChangedDragNDrop:function(c,b,a){this.application.fireEvent("dragNDropChanged",b)},onEditClassGrades:function(b,c,a){},onAdvanceReportChange:function(e,d,c){var b=Ext.ComponentQuery.query("overviewreportgrid")[0].down("grid");if(d){for(var a=3;a<=11;a++){b.columns[a].show()}b.columns[12].hide()}else{for(var a=3;a<=11;a++){b.columns[a].hide()}b.columns[12].show();BigBrainzLauncher.getApplication().getController("OverviewReportGrid").update("all")}},onEditDateCreatedSelected:function(g,c,d){var b=this.getSchoolTree();if(b.getSelectionModel().getSelection().length<1||b.getSelectionModel().getSelection()[0].data.id==="0"){Ext.MessageBox.show({title:"Please select a class or student",msg:"Please select a class or a student before setting the year."});g.setValue("");return}var e=g.getValue();if(b.getSelectionModel().getSelection()[0].data.leaf){h(e)}else{f(e)}function h(k){g.setValue("");a("games",b.getSelectionModel().getSelection()[0].data.id,k)}function f(k){g.setValue("");a("classes",b.getSelectionModel().getSelection()[0].data.id,k)}function a(l,r,o){var m=new Date().getFullYear();var k=new Date();var p=k.getMonth();if(p<=6){if(o=="Last Year"){m-=2}else{m-=1}}else{if(o=="Last Year"){m-=1}}var n=Math.floor(new Date(m+"/08/01").getTime()/1000);var q={ItemName:r,DateCreated:n,Timestamp_MostRecentGame:n};Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/"+l,params:q,success:function(s){res=Ext.decode(s.responseText);if(res){setTimeout(function(){var t;while(t=b.getRootNode().childNodes[0]){b.getRootNode().removeChild(t)}Ext.getStore("ClassStore").load();Ext.getStore("SchoolTreeStore").load()},1000)}else{Ext.Msg.alert(res.error)}},failure:function(){Ext.Msg.alert("Could set year.  Please try again.")}})}},onSetSchoolYearMult:function(b,d,a){var c=Ext.ComponentQuery.query("#setMultSchoolYear")[0];if(c===undefined||c===null){c=Ext.create("BigBrainzLauncher.view.SetMultSchoolYear")}var f=[];Ext.Array.forEach(Ext.getStore("SchoolTreeStore").getRootNode().childNodes,function(e){f.push({id:e.data.id,name:e.data.text})});store=Ext.create("Ext.data.Store",{fields:["id","name"],data:f});c.down("grid").reconfigure(store);c.show()},onSchoolSelected:function(b){var a=this.getReportYearSelector();if(a===undefined||a===null){return}a.enable()},onClassSelected:function(b){var a=this.getReportYearSelector();if(a===undefined||a===null){return}a.enable()},onStudentSelected:function(b){var a=this.getReportYearSelector();if(a===undefined||a===null){return}a.enable();this.getReportYearSelector().disable()},deleteStudents:function(b,d){var a=[];c(b);function c(e){if(e.length>0){var h=e.shift();var f=new Date().getTime();f=Math.floor(f/1000);var g={ItemName:h,DeletionDate:f};Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/games",params:g,callback:function(l,m,k){if(!m){a.push(h)}c(e)}})}else{d(a)}}},deleteClasses:function(b,d){var c=[];a(b);function a(e){if(e.length>0){var h=e.shift();var f=new Date().getTime();f=Math.floor(f/1000);var g={ItemName:h,DeletionDate:f};Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/classes",params:g,callback:function(l,m,k){if(!m){c.push(h)}a(e)}})}else{d(c)}}},init:function(a){this.control({"#reportYearSelector":{select:this.onReportYearSelected},"#deleteMultipleBtn":{click:this.deleteMutiple},"#openDeleteMultipleStudentsWindownBtn":{click:this.openDeleteMultipleStudentsWindow},"#openDeleteMultipleClassesWindownBtn":{click:this.openDeleteMultipleClassesWindow},"#addClassesBtn":{click:this.openAddClassesWindow},"#addStudentsBtn":{click:this.openAddStudentsWindow},"#importClassListBtn":{click:this.openImportClassListWindow},"#deleteSelectedBtn":{click:this.onDeleteSelected},"#editSchoolPasswordsBtn":{click:this.openEditSchoolPasswordsWindow},"#editStudentNamesPasswordsBtn":{click:this.openEditStudentNamesPasswordsWindow},"#editClassNamesBtn":{click:this.onOpenEditClassNames},"#backBtn":{click:this.onBack},"#printBtn":{click:this.onPrint},"#dragNDropStudents":{checkchange:this.onCheckChangedDragNDrop},"#editClassGrade":{click:this.onEditClassGrades},"#advanceReports":{checkchange:this.onAdvanceReportChange},"#editDateCreated":{select:this.onEditDateCreatedSelected},"#setSchoolYearMltBtn":{click:this.onSetSchoolYearMult}});a.on({schoolSelected:{fn:this.onSchoolSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},studentSelected:{fn:this.onStudentSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.EducatorViewport",{extend:"Ext.app.Controller",statics:{getActiveRegionType:function(){if(Ext.ComponentQuery.query("#classReportGrid")[0].isVisible()){return"class"}if(Ext.ComponentQuery.query("#schoolReportGrid")[0].isVisible()){return"school"}if(Ext.ComponentQuery.query("#studentReportPage")[0].isVisible()){return"student"}return""}},refs:[{ref:"schoolTree",selector:"#schoolTree",xtype:"Ext.tree.Panel"},{ref:"newYorkProxyLabel",selector:"#newYorkProxyLabel",xtype:"Ext.form.Label"},{ref:"educatorToolbar",selector:"#educatorToolbar"},{ref:"overviewReportGrid",selector:"#overviewReportGrid"}],onViewportAfterRender1:function(n,h){Ext.define("report_data",{singleton:true,data:""});Ext.define("report_grid_data",{singleton:true,data:""});Ext.define("pretest_data",{singleton:true,data:""});Ext.define("posttest_data",{singleton:true,data:""});Ext.define("avg_improvement",{singleton:true,data:""});Ext.define("class_report_grid_data",{singleton:true,data:""});this.getOverviewReportGrid().columns[0].setText("Class");var b="BB02691691445231259433720081208183020372969";if(district_data.id==b){this.getEducatorToolbar().hide();for(var f=3;f<=11;f++){this.getOverviewReportGrid().columns[f].show()}this.getOverviewReportGrid().columns[12].hide()}class_report_grid_data.data={ta9:[],division:[],addsub:[],mult:[]};var d;var e=this.getSchoolTree();while(d=e.getRootNode().childNodes[0]){e.getRootNode().removeChild(d)}Ext.getStore("SchoolTreeStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/classes/tree";Ext.getStore("SchoolTreeStore").load({callback:function(p,o,q){if(!q){Ext.getStore("SchoolTreeStore").load();return}if(Ext.getStore("SchoolTreeStore").getRootNode().childNodes.length<1){setTimeout(function(){Ext.MessageBox.confirm("Add Classes","It looks like you have not added any classes.  Would you like to add some now?",function(r){if(r=="yes"){var s=Ext.create("BigBrainzLauncher.view.AddClassesWindow");s.show()}})},1000)}}});Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/schools/"+school_data.id+"/summary/current",success:function(o){var p=Ext.decode(o.responseText);if(p.avg_test_scores<1){Ext.get("avg_posttest_scores").dom.innerHTML=""}else{Ext.get("avg_posttest_scores").dom.innerHTML=Math.round(p.avg_test_scores)+"%"}if(p.avg_pretest_scores<1){Ext.get("avg_pretest_scores").dom.innerHTML=""}else{Ext.get("avg_pretest_scores").dom.innerHTML=Math.round(p.avg_pretest_scores)+"%"}Ext.get("instructional_hours").dom.innerHTML=Ext.util.Format.number(p.instructional_hours,"0,000")},failure:function(){},callback:function(){}});if(Ext.getStore("SchoolStore").data.items[0].data.averageImprovement!==null&&Ext.getStore("SchoolStore").data.items[0].data.averageImprovement!==""&&Ext.getStore("SchoolStore").data.items[0].data.averageImprovement!==undefined){Ext.get("total_students").dom.innerHTML=Ext.util.Format.number(Ext.decode(Ext.getStore("SchoolStore").data.items[0].data.averageImprovement).all.count,"0,000");Ext.get("average_improvement").dom.innerHTML=(Ext.decode(Ext.getStore("SchoolStore").data.items[0].data.averageImprovement).all.avg_improvement-100)+"%";if(Ext.decode(Ext.getStore("SchoolStore").data.items[0].data.averageImprovement).all.avg_improvement-100<0){Ext.get("average_improvement").dom.innerHTML=""}}else{Ext.get("total_students").dom.innerHTML="";Ext.get("average_improvement").dom.innerHTML=""}var m=false;var c=-1;if(Ext.getStore("SchoolStore").data.items[0].data.purchase_status==="free"){m=true}if(Ext.getStore("SchoolStore").data.items[0].data.expirationDate===null||Ext.getStore("SchoolStore").data.items[0].data.expirationDate===undefined){m=true}var k=parseInt(Ext.getStore("SchoolStore").data.items[0].data.expirationDate,10)*1000;var g=new Date(k);var l=new Date();var a=1/(1000*60*60*24);c=(g-l)*a;if(c<0||isNaN(c)){Ext.get("expirationMessage").show()}else{if(c<=90){Ext.get("expirationMessage").show();Ext.get("expirationMessage").dom.innerHTML="Number of subscription days remaining: "+Math.floor(c)}else{Ext.get("expirationMessage").hide()}}if(state_data.name=="New York"){this.getNewYorkProxyLabel().show()}},onReportYearSelected:function(b){var a="schools";var c=school_data.id;if(Ext.ComponentQuery.query("#educatorViewport").length<1){a="districts";c=district_data.id}Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/"+a+"/"+c+"/summary/"+b,success:function(d){var e=Ext.decode(d.responseText);Ext.get("avg_posttest_scores").dom.innerHTML="Average Post-Test Scores: "+Math.round(e.avg_test_scores)+"%";Ext.get("instructional_hours").dom.innerHTML="Instructional Hours: "+Ext.util.Format.number(e.instructional_hours,"0,000");Ext.get("total_students").dom.innerHTML="Total Students (Playing more than 1 hour): "+Ext.util.Format.number(e.total_students,"0,000");Ext.get("average_improvement").dom.innerHTML="Average Improvement (Playing more than 1 hour): "+(e.avg_improvement-100)+"%"},failure:function(){},callback:function(){}})},init:function(a){this.control({"#educatorViewport":{afterrender:this.onViewportAfterRender1}});a.on({reportYearSelected:{fn:this.onReportYearSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.EducatorReportTabs",{extend:"Ext.app.Controller",refs:[{ref:"reportTabs",selector:"#schoolReportTabs"},{ref:"schoolTree",selector:"#schoolTree"},{ref:"additionTab",selector:"#additionTab"},{ref:"subtractionTab",selector:"#subtractionTab"},{ref:"addSubTab",selector:"#addSubTab"},{ref:"ta9Tab",selector:"#ta9Tab"},{ref:"ta12Tab",selector:"#ta12Tab"}],onTabpanelAfterRender:function(c,e){var f=this.getReportTabs().down("tab");var b=f.next();var a=b.next();var d=a.next();b.activate();if(window.showAdditionAndSubtraction!==false){this.getAddSubTab().tab.hide();this.getAdditionTab().tab.show();this.getSubtractionTab().tab.show()}if(Ext.getStore("SchoolStore").data.items.length<1||Ext.getStore("SchoolStore").data.items[0].data.purchase_status===null||Ext.getStore("SchoolStore").data.items[0].data.purchase_status.indexOf("TA12")<0){a.show();d.hide()}else{a.hide();d.show()}},onTabpanelBeforeTabChange:function(d,a,c,b){d.activate_tab(d,a);this.application.fireEvent("reportTabChange",d.active_app_id());return false},onDragNDropChanged:function(a){if(a){Ext.ComponentQuery.query("overviewreportgrid")[0].up("panel").up("panel").mask("In Move Student Mode.  To see reports, uncheck 'Enable Moving Students' in the 'Edit' Menu.","no-image")}else{Ext.ComponentQuery.query("overviewreportgrid")[0].up("panel").up("panel").unmask()}},init:function(a){this.control({"#schoolReportTabs":{afterrender:this.onTabpanelAfterRender,beforetabchange:this.onTabpanelBeforeTabChange}});a.on({dragNDropChanged:{fn:this.onDragNDropChanged,scope:this}})}});Ext.define("BigBrainzLauncher.controller.StudentReportPage",{extend:"Ext.app.Controller",refs:[{ref:"studentReportPage",selector:"#studentReportPage"},{ref:"schoolTree",selector:"#schoolTree"},{ref:"schoolReportTabs",selector:"#schoolReportTabs"}],onStudentSelected:function(d){var b=this.getStudentReportPage();if(b===undefined||b===null){return}Ext.getBody().mask();var a=this.application;var c=function(f,e,g){a.fireEvent("studentLoaded",d)};Ext.getStore("GameDataStore").proxy.url="routes/routes.php?url=/games/"+d+"/report_data";Ext.getStore("GameDataStore").load({callback:c})},onClassSelected:function(b){var a=this.getStudentReportPage();if(a===undefined||a===null){return}a.hide()},onSchoolSelected:function(b){var a=this.getStudentReportPage();if(a===undefined||a===null){return}a.hide()},onReportTabChange:function(a){this.update(a)},onStudentLoaded:function(a){Ext.getBody().unmask();this.getStudentReportPage().show();this.update(this.getSchoolReportTabs().active_app_id())},update:function(o){var e=this.getSchoolTree();if(e===undefined||e===null||e.getSelectionModel().getSelection().length===0||(e.getSelectionModel().getSelection().length>0&&!e.getSelectionModel().getSelection()[0].isLeaf())){return}if(o==="all"){Ext.ComponentQuery.query("#studentReportPageData")[0].hide();Ext.ComponentQuery.query("#selectSubjectExplaination")[0].show();return}else{Ext.ComponentQuery.query("#selectSubjectExplaination")[0].hide();Ext.ComponentQuery.query("#studentReportPageData")[0].show()}c(o);m();f();var h=parseInt(Ext.getStore("SchoolStore").data.items[0].data.expirationDate,10)*1000;var d=new Date(h);var k=new Date();var a=1/(1000*60*60*24);var b=(d-k)*a;if(b>=0&&!isNaN(b)){g()}function c(q){var p=Ext.getStore("GameStore").getById(student_data.id);if(p===null||p==undefined){Ext.getStore("GameStore").proxy.url="routes/routes.php?url=/classes/"+Ext.getCmp("school_tree").getSelectionModel().getSelection()[0].parentNode.data.id+"/children";Ext.getStore("GameStore").load({callback:function(t,s,u){n(q)}})}else{n(q)}}function n(q){var p=Ext.getStore("GameStore").getById(student_data.id);Ext.getStore("ProgressGaugeStore").clearData();Ext.getStore("ProgressGaugeStore").add(p.data.progress_report[q])}function m(){Ext.get("play_game").show();var u="Multiplication";if(o=="division"){u="Division"}else{if(o=="addsub"){u="AddSub"}else{if(o=="addition"){u="Add"}else{if(o=="subtraction"){u="Sub"}}}}var t=parseInt(Ext.getStore("SchoolStore").data.items[0].data.expirationDate,10)*1000;var s=new Date(t);var q=new Date();var r=1/(1000*60*60*24);var p=(s-q)*r;if(p<0||isNaN(p)){Ext.get("play_game").dom.innerHTML='<img src="images/subjects/Button_Play'+u+'_150Disabled.png">';Ext.get("play_game").dom.style.cursor="auto"}else{Ext.get("play_game").dom.innerHTML='<img src="images/Button_Play'+u+'_150.png" onmouseover="this.src=\'images/Button_Play'+u+"Hover_150.png'\" onmouseout=\"this.src='images/Button_Play"+u+"_150.png'\">";Ext.get("play_game").dom.style.cursor="pointer"}}function l(){try{if(o=="addsub"){adj_appid="addsubtract"}var q=Ext.getStore("GameDataStore").data.items[0].data.weekly_time["TimePlayed"+adj_appid];Ext.getStore("StudentWeeklyMinutes").loadRawData(q)}catch(p){Ext.getStore("StudentWeeklyMinutes").loadRawData([{week_number:"Week 1",minutes:0}])}}function f(){try{var s=Ext.decode(Ext.getStore("GameDataStore").data.items[0].data.fact_grid);var q=Ext.decode(Ext.getStore("GameDataStore").data.items[0].data.pretest_grid);var r=Ext.decode(Ext.getStore("GameDataStore").data.items[0].data.posttest_grid);Ext.getCmp("progress_grid_tpl").update(s[o]);Ext.getCmp("pretest_grid_tpl").update(q[o]);Ext.getCmp("posttest_grid_tpl").update(r[o])}catch(p){}}function g(){Ext.get("play_game").clearListeners();var p=true;if(Ext.getStore("SchoolStore").data.items[0].data.purchase_status!==null&&Ext.getStore("SchoolStore").data.items[0].data.purchase_status!==undefined&&Ext.getStore("SchoolStore").data.items[0].data.purchase_status.indexOf("TA12")>-1){p=false}if(o=="mult"&&p){Ext.get("play_game").hide()}else{if(o=="ta9"&&!p){Ext.get("play_game").hide()}else{Ext.get("play_game").show()}}Ext.get("play_game").on("click",function(w,x){var s=Ext.getCmp("school_tree").getSelectionModel().getSelection();s=s[0];var q=s.data.id;var t=Ext.getStore("SchoolStore").getById(school_data.id).data.il_school;if(t){q="il"+q}var r="turbo";var v=e.getSelectionModel().getSelection()[0];var u=v.parentNode.data.text;if(u=="Ninja Apprentice"){r="ninja1"}else{if(u=="Ninja"){r="ninja2"}else{if(u=="Ninja Master"){r="ninja3"}else{if(u=="Ninja Calculated"||u.endsWith("_*")){r="ninjaC"}}}}if(o=="division"||o=="mult"||o=="addition"||o=="subtraction"){r=o}else{if(o=="addsub"){r="addsubtract"}}window.location.href="play.php?appid="+r+"&school_id="+school_data.id+"&id="+q})}},init:function(a){a.on({studentSelected:{fn:this.onStudentSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this},reportTabChange:{fn:this.onReportTabChange,scope:this},studentLoaded:{fn:this.onStudentLoaded,scope:this}})}});Ext.define("BigBrainzLauncher.controller.UsageChart",{extend:"Ext.app.Controller",refs:[{ref:"usageChart",selector:"#usageChart"},{ref:"schoolReportTabs",selector:"#schoolReportTabs"},{ref:"reportYearSelector",selector:"#reportYearSelector"}],onPanelExpand:function(c,a){var b=this.getSchoolReportTabs().active_app_id();if(this.getUsageChart().data===undefined||this.getUsageChart().data===null){return}Ext.getStore("WeeklyProgressStore").loadRawData(Ext.decode(this.getUsageChart().data[b]))},onDistrictSelected:function(a){this.updateUsageChart(a,"districts")},onSchoolSelected:function(a){this.updateUsageChart(a,"schools")},onClassSelected:function(a){this.updateUsageChart(a,"classes")},onReportTabChange:function(a){if(this.getUsageChart().data===undefined||this.getUsageChart().data===null){return}Ext.getStore("WeeklyProgressStore").loadRawData(Ext.decode(this.getUsageChart().data[a]))},onReportYearSelected:function(a){var b=school_data.id;if(b===null||b===undefined||b===""){this.updateUsageChart(district_data.id,"districts")}else{this.updateUsageChart(school_data.id,"schools")}},updateUsageChart:function(e,a){var d=this.getUsageChart();if(d===undefined||d===null){return}var c=this.getSchoolReportTabs().active_app_id();var b="current";if(this.getReportYearSelector()!==undefined&&this.getReportYearSelector()!==null){b=this.getReportYearSelector().value}if(b=="alltime"){if(d.rendered){d.getEl().mask("All time weekly usage<br />is not available.","no-image")}Ext.getStore("WeeklyProgressStore").clearData();return}if(d.rendered){d.mask()}Ext.Ajax.request({retries:2,method:"GET",url:"routes/routes.php?url=/"+a+"/"+e+"/weekly_progress/"+b,success:function(f){d.data=Ext.decode(f.responseText);Ext.getStore("WeeklyProgressStore").loadRawData(Ext.decode(d.data[c]))},failure:function(){},callback:function(){d.unmask();d.getEl().unmask()}})},init:function(a){this.control({"#summaryGraphs":{expand:this.onPanelExpand}});a.on({districtSelected:{fn:this.onDistrictSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},reportTabChange:{fn:this.onReportTabChange,scope:this},reportYearSelected:{fn:this.onReportYearSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.SchoolProgressGrid",{extend:"Ext.app.Controller",refs:[{ref:"schoolReportTabs",selector:"#schoolReportTabs"},{ref:"schoolReportGrid",selector:"#schoolReportGrid"},{ref:"commonReports",selector:"#commonReports"},{ref:"reportYearSelector",selector:"#reportYearSelector"}],onSchoolSelected:function(b){var a=this.getSchoolReportGrid();if(a===undefined||a===null){return}a.up().show();a.show();this.getCommonReports().show();this.load(b)},onClassSelected:function(b){var a=this.getSchoolReportGrid();if(a===undefined||a===null){return}a.hide()},onStudentSelected:function(b){var a=this.getSchoolReportGrid();if(a===undefined||a===null){return}this.getCommonReports().up().hide()},onReportYearSelected:function(a){this.load(school_data.id)},load:function(c){var a=this.getSchoolReportGrid();if(a===undefined||a===null){return}var b=this.getSchoolReportTabs().active_app_id()},init:function(a){a.on({schoolSelected:{fn:this.onSchoolSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},studentSelected:{fn:this.onStudentSelected,scope:this},reportYearSelected:{fn:this.onReportYearSelected,scope:this}})}});Ext.define("BigBrainzLauncher.store.ProgressGaugeStore",{extend:"Ext.data.Store",constructor:function(a){var b=this;a=a||{};b.callParent([Ext.apply({storeId:"ProgressGaugeStore",fields:[{name:"name"},{name:"pretest"},{name:"progress"},{name:"posttest"},{name:"minutes"},{name:"id"}],sorters:{property:"name"}},a)])}});Ext.define("BigBrainzLauncher.controller.ClassReportGrid",{extend:"Ext.app.Controller",refs:[{ref:"classReportGrid",selector:"#classReportGrid"},{ref:"schoolReportTabs",selector:"#schoolReportTabs"},{ref:"commonReports",selector:"#commonReports"}],onGridpanelSelect:function(d,a,b,c){this.application.fireEvent("classReportGridRowSelected",a.data.id)},onDistrictSelected:function(b){var a=this.getClassReportGrid();if(a===undefined||a===null){return}a.hide()},onSchoolSelected:function(b){var a=this.getClassReportGrid();if(a===undefined||a===null){return}a.hide()},onClassSelected:function(h){var g=this.getClassReportGrid();if(g===undefined||g===null){return}if(g.rendered){g.mask()}g.show();this.getCommonReports().show();this.getCommonReports().up().show();if(Ext.getCmp("school_tree")!==undefined){if(Ext.getCmp("school_tree").getSelectionModel().getSelection()[0].childNodes.length>0){Ext.getStore("GameStore").loadFrom(Ext.getCmp("school_tree").getSelectionModel().getSelection()[0].childNodes)}return}var f=this.getSchoolReportTabs().active_app_id();var d=Ext.getStore("ClassStore").find("id",h);var c=Ext.getStore("ClassStore").data.items[d];if(c===undefined){b=false}else{var b=c.data.PilotClass;if(b=="True"||b=="true"){b=true}else{b=false}}var a=this;var e=Ext.ComponentQuery.query("#reportYearSelector")[0].getTimestamps();Ext.getStore("GameStore").proxy.url="routes/routes.php?url=/classes/"+h+"/children/"+e[0]+","+e[1]+"";Ext.getStore("GameStore").load({callback:function(p,l,s){g.unmask();if(!s){Ext.getStore("GameStore").load();return}var q=Ext.getStore("GameStore").data.items.length;var o="It looks like you have not added any students.  Would you like to add some now?";if(b){o="It looks like you have not added any students to this Pilot Class.  Would you like to add some now?  Remember, you can add up to 30 students who can play the deluxe version of the game."}if(q<1&&Ext.ComponentQuery.query("#reportYearSelector")[0].value=="current"){setTimeout(function(){Ext.MessageBox.confirm("Add Students",o,function(r){if(r=="yes"){var t=Ext.create("BigBrainzLauncher.view.AddStudentsWindow");t.show()}})},250)}g.data={ta9:[],division:[],addsub:[],mult:[],addition:[],subtraction:[]};var n=p.length;for(var m=0;m<n;m++){var k=p[m].data;if(k.progress_report.ta9!==undefined){k.progress_report.ta9.id=k.id;g.data.ta9.push(k.progress_report.ta9)}if(k.progress_report.division!==undefined){k.progress_report.division.id=k.id;g.data.division.push(k.progress_report.division)}if(k.progress_report.addsub!==undefined){k.progress_report.addsub.id=k.id;g.data.addsub.push(k.progress_report.addsub)}if(k.progress_report.mult!==undefined){k.progress_report.mult.id=k.id;g.data.mult.push(k.progress_report.mult)}if(k.progress_report.addition!==undefined){k.progress_report.addition.id=k.id;g.data.addition.push(k.progress_report.addition)}if(k.progress_report.subtraction!==undefined){k.progress_report.subtraction.id=k.id;g.data.subtraction.push(k.progress_report.subtraction)}}a.update(f)}})},onStudentSelected:function(b){var a=this.getClassReportGrid();if(a===undefined||a===null){return}a.hide();this.getCommonReports().hide()},onReportTabChange:function(a){this.update(a)},onReportYearSelected:function(a){},onStudentsLoaded:function(c){var k=this.getClassReportGrid();if(k===undefined||k===null){return}var l=this.getSchoolReportTabs().active_app_id();var h=Ext.getStore("GameStore").data.items.length;var d=Ext.getStore("ClassStore").find("id",c);var g=Ext.getStore("ClassStore").data.items[d];if(g===undefined){b=false}else{var b=g.data.PilotClass;if(b=="True"||b=="true"){b=true}else{b=false}}var n="It looks like you have not added any students.  Would you like to add some now?";if(b){n="It looks like you have not added any students to this Pilot Class.  Would you like to add some now?  Remember, you can add up to 30 students who can play the deluxe version of the game."}if(h<1&&Ext.ComponentQuery.query("#reportYearSelector")[0].value=="current"){setTimeout(function(){Ext.MessageBox.confirm("Add Students",n,function(o){if(o=="yes"){var p=Ext.create("BigBrainzLauncher.view.AddStudentsWindow");p.show()}})},250)}var a=Ext.getStore("GameStore").data.items;k.data={ta9:[],division:[],addsub:[],mult:[],addition:[],subtraction:[]};var m=a.length;for(var f=0;f<m;f++){var e=a[f].data;if(e.progress_report.ta9!==undefined){e.progress_report.ta9.id=e.id;k.data.ta9.push(e.progress_report.ta9)}if(e.progress_report.division!==undefined){e.progress_report.division.id=e.id;k.data.division.push(e.progress_report.division)}if(e.progress_report.addsub!==undefined){e.progress_report.addsub.id=e.id;k.data.addsub.push(e.progress_report.addsub)}if(e.progress_report.mult!==undefined){e.progress_report.mult.id=e.id;k.data.mult.push(e.progress_report.mult)}if(e.progress_report.addition!==undefined){e.progress_report.addition.id=e.id;k.data.addition.push(e.progress_report.addition)}if(e.progress_report.subtraction!==undefined){e.progress_report.subtraction.id=e.id;k.data.subtraction.push(e.progress_report.subtraction)}}this.update(l)},update:function(a){var b=this.getClassReportGrid();if(b===undefined||b===null||b.data===undefined||b.data===null){return}if(a==="all"){b.getEl().mask("Summary report not applicable for individual students.","no-image");Ext.getStore("GameProgressStore").loadRawData([{name:"&nbsp;"}]);return}else{b.getEl().unmask()}Ext.getStore("GameProgressStore").loadRawData(b.data[a])},init:function(a){this.control({"#classReportGridGrid":{select:this.onGridpanelSelect}});a.on({districtSelected:{fn:this.onDistrictSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},studentSelected:{fn:this.onStudentSelected,scope:this},reportTabChange:{fn:this.onReportTabChange,scope:this},reportYearSelected:{fn:this.onReportYearSelected,scope:this},studentsLoaded:{fn:this.onStudentsLoaded,scope:this}})}});Ext.define("BigBrainzLauncher.controller.PretestChart",{extend:"Ext.app.Controller",refs:[{ref:"pretestChart",selector:"#pretestChart"},{ref:"schoolReportTabs",selector:"#schoolReportTabs"},{ref:"reportYearSelector",selector:"#reportYearSelector"},{ref:"schoolTree",selector:"#schoolTree"}],onDistrictSelected:function(a){this.loadPretestChart(a)},onSchoolSelected:function(a){this.loadPretestChart(a)},onClassSelected:function(a){this.loadPretestChart(a)},onReportTabChange:function(b){var a=this.getPretestChart();if(a.data===undefined||a.data===null){return}Ext.getStore("PretestChartStore").loadRawData(a.data[b])},onReportYearSelected:function(a){var b=school_data.id;if(b===null||b===undefined||b===""){this.loadPretestChart(district_data.id)}else{this.loadPretestChart(school_data.id)}},loadPretestChart:function(d){var b=this.getPretestChart();if(b===undefined||b===null){return}if(b.rendered){b.mask()}var c=this.getSchoolReportTabs().active_app_id();var a="current";if(this.getReportYearSelector()!==undefined&&this.getReportYearSelector()!==null){a=this.getReportYearSelector().value}Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/districts/"+d+"/report/test_scores/pretest/"+a,success:function(e){b.data=Ext.decode(e.responseText);Ext.getStore("PretestChartStore").loadRawData(b.data[c])},failure:function(){Ext.Msg.alert("Could not load pretest chart data.  Please try again.")},callback:function(){b.unmask()}})},init:function(a){a.on({districtSelected:{fn:this.onDistrictSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},reportTabChange:{fn:this.onReportTabChange,scope:this},reportYearSelected:{fn:this.onReportYearSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.PosttestChart",{extend:"Ext.app.Controller",refs:[{ref:"posttestChart",selector:"#posttestChart"},{ref:"schoolReportTabs",selector:"#schoolReportTabs"},{ref:"reportYearSelector",selector:"#reportYearSelector"},{ref:"schoolTree",selector:"#schoolTree"}],onDistrictSelected:function(a){this.loadPosttestChart(a)},onSchoolSelected:function(a){this.loadPosttestChart(a)},onClassSelected:function(a){this.loadPosttestChart(a)},onReportTabChange:function(a){var b=this.getPosttestChart();if(b.data===undefined||b.data===null){return}Ext.getStore("PosttestChartStore").loadRawData(b.data[a])},onReportYearSelected:function(a){var b=school_data.id;if(b===null||b===undefined||b===""){this.loadPosttestChart(district_data.id)}else{this.loadPosttestChart(school_data.id)}},loadPosttestChart:function(d){var c=this.getPosttestChart();if(c===undefined||c===null){return}if(c.rendered){c.mask()}var b=this.getSchoolReportTabs().active_app_id();var a="current";if(this.getReportYearSelector()!==undefined&&this.getReportYearSelector()!==null){a=this.getReportYearSelector().value}Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/districts/"+d+"/report/test_scores/posttest/"+a,success:function(e){c.data=Ext.decode(e.responseText);Ext.getStore("PosttestChartStore").loadRawData(c.data[b])},failure:function(){Ext.Msg.alert("Could not load posttest chart data.  Please try again.")},callback:function(){c.unmask()}})},init:function(a){a.on({districtSelected:{fn:this.onDistrictSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},reportTabChange:{fn:this.onReportTabChange,scope:this},reportYearSelected:{fn:this.onReportYearSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.StudentViewport",{extend:"Ext.app.Controller",refs:[{ref:"schoolTree",selector:"#schoolTree"}],onViewportAfterRender:function(a,b){var e=Ext.getStore("SchoolStore").getById(school_data.id).data.SeparateAdditionSubtraction;e=true;if(e||window.showAdditionAndSubtraction){Ext.ComponentQuery.query("#addSubtractContainer")[0].hide();Ext.ComponentQuery.query("#additionSubtractionContainer")[0].show();Ext.ComponentQuery.query("#addSubButton")[0].hide();Ext.ComponentQuery.query("#additionButton")[0].show();Ext.ComponentQuery.query("#subtractionButton")[0].show()}else{Ext.ComponentQuery.query("#additionSubtractionContainer")[0].hide();Ext.ComponentQuery.query("#addSubtractContainer")[0].show();Ext.ComponentQuery.query("#addSubButton")[0].show();Ext.ComponentQuery.query("#additionButton")[0].hide();Ext.ComponentQuery.query("#subtractionButton")[0].hide()}Ext.get("pizza").hide();var d;var c=Ext.ComponentQuery.query("#schoolTree")[0];while(d=c.getRootNode().childNodes[0]){c.getRootNode().removeChild(d)}Ext.getStore("SchoolTreeStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/classes/tree";Ext.getStore("SchoolTreeStore").load({callback:function(g,f,h){if(!h){Ext.getStore("SchoolTreeStore").load();return}}})},onStudentSelected:function(a){},init:function(a){this.control({"#studentViewport":{afterrender:this.onViewportAfterRender}});a.on({studentSelected:{fn:this.onStudentSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.StudentViewportMenu",{extend:"Ext.app.Controller",refs:[{ref:"studentViewportMenu",selector:"#studentViewportMenu"}],onStudentSelected:function(g){var e=this.getStudentViewportMenu();if(e===undefined||e===null){return}e.down("button").enable();e.down("button").next("button").enable();var f=true;if(f||window.showAdditionAndSubtraction){e.down("button").next("button").next("button").next("button").enable();e.down("button").next("button").next("button").next("button").next("button").enable()}else{e.down("button").next("button").next("button").enable()}var d=parseInt(Ext.getStore("SchoolStore").data.items[0].data.expirationDate,10)*1000;var c=new Date(d);var a=new Date();var b=1/(1000*60*60*24);daysRemaining=(c-a)*b;if(daysRemaining<0||isNaN(daysRemaining)){e.down("button").disable();e.down("button").next("button").disable();if(f||window.showAdditionAndSubtraction){e.down("button").next("button").next("button").next("button").disable();e.down("button").next("button").next("button").next("button").next("button").disable()}else{e.down("button").next("button").next("button").disable()}}},onClassSelected:function(c){var a=this.getStudentViewportMenu();if(a===undefined||a===null){return}a.down("button").disable();a.down("button").next("button").disable();var b=Ext.getStore("SchoolStore").getById(school_data.id).data.SeparateAdditionSubtraction;if(b||window.showAdditionAndSubtraction){a.down("button").next("button").next("button").next("button").disable();a.down("button").next("button").next("button").next("button").next("button").disable()}else{a.down("button").next("button").next("button").disable()}},onSchoolSelected:function(c){var a=this.getStudentViewportMenu();if(a===undefined||a===null){return}a.down("button").disable();a.down("button").next("button").disable();var b=Ext.getStore("SchoolStore").getById(school_data.id).data.SeparateAdditionSubtraction;if(b||window.showAdditionAndSubtraction){a.down("button").next("button").next("button").next("button").disable();a.down("button").next("button").next("button").next("button").next("button").disable()}else{a.down("button").next("button").next("button").disable()}},init:function(a){a.on({studentSelected:{fn:this.onStudentSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.StudentMinutesChart",{extend:"Ext.app.Controller",refs:[{ref:"studentMinutesChart",selector:"#studentMinutesChart"},{ref:"schoolReportTabs",selector:"#schoolReportTabs"}],onStudentLoaded:function(a){this.weekly_times=Ext.getStore("GameDataStore").data.items[0].data.weekly_time;this.update(this.getSchoolReportTabs().active_app_id())},update:function(b){if(this.weekly_times===null||this.weekly_times===undefined){return}var a=this.weekly_times["TimePlayed"+b];Ext.getStore("StudentWeeklyMinutes").loadRawData(a)},onReportTabChange:function(a){this.update(a)},init:function(a){a.on({studentLoaded:{fn:this.onStudentLoaded,scope:this},reportTabChange:{fn:this.onReportTabChange,scope:this}})}});Ext.define("BigBrainzLauncher.controller.GamesPanel",{extend:"Ext.app.Controller",refs:[{ref:"gamesPanel",selector:"#gamesPanel"},{ref:"multiplicationPlay",selector:"#multiplicationPlay"},{ref:"divisionPlay",selector:"#divisionPlay"},{ref:"additionPlay",selector:"#additionPlay"},{ref:"subtractionPlay",selector:"#subtractionPlay"},{ref:"multiplicationLabel",selector:"#multiplicationLabel"},{ref:"divisionLabel",selector:"#divisionLabel"},{ref:"additionLabel",selector:"#additionLabel"},{ref:"subtractionLabel",selector:"#subtractionLabel"}],onStudentSelected:function(s){var l=-1;var q=false;var b=this.getGamesPanel();if(b===undefined||b===null){b=Ext.ComponentQuery.query("gamepanel")[0];if(b===undefined||b===null){return}}try{var k=Ext.getStore("SchoolTreeStore");var a=Ext.ComponentQuery.query("#schoolTree")[0];var o=Ext.JSON.decode(k.getById(s).data.OperationOrder);if(o===undefined||o===null){o=Ext.JSON.decode(k.getById(s).parentNode.data.OperationOrder);if(o===undefined||o===null){o=Ext.JSON.decode(Ext.getStore("SchoolStore").data.items[0].data.OperationOrder);if(o===undefined||o===null){o={a:[],s:[],m:[],d:[]}}}}}catch(x){o={a:[],s:[],m:[],d:[]}}b.show();var m=Ext.getStore("GameStore").find("id",s);if(m===-1){Ext.getStore("GameStore").proxy.url="routes/routes.php?url=/classes/"+Ext.getCmp("school_tree").getSelectionModel().getSelection()[0].parentNode.data.id+"/children";Ext.getStore("GameStore").load({callback:function(A,e,B){t(Ext.getStore("GameStore").find("id",s))}})}else{t(m)}function t(B){b.suspendLayout=true;var E=Ext.getStore("GameStore").data.items[B].data;if(Ext.getStore("SchoolStore").data.items.length>0){var D=parseInt(Ext.getStore("SchoolStore").data.items[0].data.expirationDate,10)*1000;var C=new Date(D);var e=new Date();var A=1/(1000*60*60*24);l=(C-e)*A}if(district_data.id==="BB02691691445231259433720081208183020372969"){l=100}if(isNaN(l)||l<0){Ext.ComponentQuery.query("#expiredLabel")[0].show()}else{if(l<=90){Ext.ComponentQuery.query("#expiredLabel")[0].setText("Number of subscription days remaining: "+Math.floor(l));Ext.ComponentQuery.query("#expiredLabel")[0].show()}}p(E);z(E);if(window.showAdditionAndSubtraction){Ext.ComponentQuery.query("#addSubtractContainer")[0].hide();Ext.ComponentQuery.query("#additionSubtractionContainer")[0].show();v(E);r(E)}else{h(E)}b.suspendLayout=false;b.doLayout()}function u(A){var e=Ext.getStore("GameStore").find("id",s);for(var B=0;B<A.length;B++){if(A[B]==="a"){if(Ext.getStore("GameStore").data.items[e].data.progress_report.addition.posttest<95){return false}}if(A[B]==="s"){if(Ext.getStore("GameStore").data.items[e].data.progress_report.subtraction.posttest<95){return false}}if(A[B]==="m"){if(Ext.getStore("GameStore").data.items[e].data.progress_report.ta9.posttest<95){return false}}if(A[B]==="d"){if(Ext.getStore("GameStore").data.items[e].data.progress_report.division.posttest<95){return false}}}return true}function p(C){if(l<0||isNaN(l)||!u(o.m)){Ext.ComponentQuery.query("gamepanel #multiplicationPlayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #multiplicationReplayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #multiplicationExpired")[0].show();return}else{Ext.ComponentQuery.query("gamepanel #multiplicationExpired")[0].hide()}var A=C.progress_report.ta9.posttest;var B=A>0;if(C.progress_report.ninja2!==undefined){A=C.progress_report.ninja2.posttest;B=A>0}if(C.progress_report["ta9-latest"]!==undefined){A=C.progress_report["ta9-latest"].posttest;B=A>0}if(q){B=false}if(B){Ext.ComponentQuery.query("gamepanel #multiplicationPlayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #multiplicationReplayContainer")[0].show();Ext.ComponentQuery.query("gamepanel #multiplicationScoreLabel")[0].setText(A+"%");var e=c;if(C.to_play_data.ta9.version=="ninja1"){e=y}if(C.to_play_data.ta9.version=="ninja2"){e=w}if(A<95){e=d}e(C,Ext.ComponentQuery.query("gamepanel #multiplicationLevelLabel")[0],Ext.ComponentQuery.query("gamepanel #multiplicationReplyMessageLabel")[0],Ext.get("multiplicationMasteryLevelCharacter"),Ext.get("multiplicationNextMasteryLevelCharacter"),Ext.get("multiplicationReplayRetestImage"),Ext.ComponentQuery.query("gamepanel #multiplicationPraiseLabel")[0],"ta9")}else{Ext.ComponentQuery.query("gamepanel #multiplicationPlayContainer")[0].show();Ext.ComponentQuery.query("gamepanel #multiplicationReplayContainer")[0].hide()}}function z(C){if(l<0||isNaN(l)||!u(o.d)){Ext.ComponentQuery.query("gamepanel #divisionPlayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #divisionReplayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #divisionExpired")[0].show();return}else{Ext.ComponentQuery.query("gamepanel #divisionExpired")[0].hide()}var A=C.progress_report.division.posttest;var B=A>0;if(q){B=false}if(B){Ext.ComponentQuery.query("gamepanel #divisionPlayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #divisionReplayContainer")[0].show();Ext.ComponentQuery.query("gamepanel #divisionScoreLabel")[0].setText(A+"%");var e=f;if(A<95){e=d}e(C,Ext.ComponentQuery.query("gamepanel #divisionLevelLabel")[0],Ext.ComponentQuery.query("gamepanel #divisionReplyMessageLabel")[0],Ext.get("divisionMasteryLevelCharacter"),Ext.get("divisionNextMasteryLevelCharacter"),Ext.get("divisionReplayRetestImage"),Ext.ComponentQuery.query("gamepanel #divisionPraiseLabel")[0],"division")}else{Ext.ComponentQuery.query("gamepanel #divisionPlayContainer")[0].show();Ext.ComponentQuery.query("gamepanel #divisionReplayContainer")[0].hide()}}function v(C){if(l<0||isNaN(l)||!u(o.a)){Ext.ComponentQuery.query("gamepanel #additionPlayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #additionReplayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #additionExpired")[0].show();return}else{Ext.ComponentQuery.query("gamepanel #additionExpired")[0].hide()}var A=C.progress_report.addition.posttest;var B=A>0;if(q){B=false}if(B){Ext.ComponentQuery.query("gamepanel #additionPlayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #additionReplayContainer")[0].show();Ext.ComponentQuery.query("gamepanel #additionScoreLabel")[0].setText(A+"%");var e=f;if(A<95){e=d}e(C,Ext.ComponentQuery.query("gamepanel #additionLevelLabel")[0],Ext.ComponentQuery.query("gamepanel #additionReplyMessageLabel")[0],Ext.get("additionMasteryLevelCharacter"),Ext.get("additionNextMasteryLevelCharacter"),Ext.get("additionReplayRetestImage"),Ext.ComponentQuery.query("gamepanel #additionPraiseLabel")[0],"addition")}else{Ext.ComponentQuery.query("gamepanel #additionPlayContainer")[0].show();Ext.ComponentQuery.query("gamepanel #additionReplayContainer")[0].hide()}}function r(C){if(l<0||isNaN(l)||!u(o.s)){Ext.ComponentQuery.query("gamepanel #subtractionPlayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #subtractionReplayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #subtractionExpired")[0].show();return}else{Ext.ComponentQuery.query("gamepanel #subtractionExpired")[0].hide()}var A=C.progress_report.subtraction.posttest;var B=A>0;if(q){B=false}if(B){Ext.ComponentQuery.query("gamepanel #subtractionPlayContainer")[0].hide();Ext.ComponentQuery.query("gamepanel #subtractionReplayContainer")[0].show();Ext.ComponentQuery.query("gamepanel #subtractionScoreLabel")[0].setText(A+"%");var e=f;if(A<95){e=d}e(C,Ext.ComponentQuery.query("gamepanel #subtractionLevelLabel")[0],Ext.ComponentQuery.query("gamepanel #subtractionReplyMessageLabel")[0],Ext.get("subtractionMasteryLevelCharacter"),Ext.get("subtractionNextMasteryLevelCharacter"),Ext.get("subtractionReplayRetestImage"),Ext.ComponentQuery.query("gamepanel #subtractionPraiseLabel")[0],"subtraction")}else{Ext.ComponentQuery.query("gamepanel #subtractionPlayContainer")[0].show();Ext.ComponentQuery.query("gamepanel #subtractionReplayContainer")[0].hide()}}function h(e){Ext.ComponentQuery.query("gamepanel #addSubtractContainer")[0].show();Ext.ComponentQuery.query("gamepanel #additionSubtractionContainer")[0].hide()}function d(D,G,B,E,A,F,e,C){G.setText("Apprentice");B.setText('Score above 95% to become a "Master"');E.dom.src="images/replay_characters/Scratch_White_h200.png";A.dom.src="images/replay_characters/Scratch_Ninja2_h75.png";F.parent().parent().parent().show();if(D.retest_data[C]>=100){F.dom.src="images/replay_characters/Replay_50.png"}else{F.dom.src="images/replay_characters/Retest_50.png"}F.show();e.hide()}function c(D,G,B,E,A,F,e,C){G.setText("Master");if(n(D)){B.setText("Now...can you handle Ninja mode?!!!");F.dom.src="images/replay_characters/Play-Ninja_50.png";F.parent().parent().parent().show()}else{B.setText("Master All 4 operations to unlock Ninja Mode!");F.parent().parent().parent().hide()}E.dom.src="images/replay_characters/Scratch_Ninja2_h200.png";A.dom.src="images/replay_characters/Scratch_Black_h75.png";e.setText("Great Job!");e.show()}function y(D,G,B,E,A,F,e,C){G.setText("Master");B.setText("");B.hide();F.dom.src="images/replay_characters/Play-Ninja_50.png";F.parent().parent().parent().show();F.parent().parent().parent().hide();E.dom.src="images/replay_characters/Scratch_Black_h200.png";A.dom.src="images/replay_characters/Scratch_Black_h75.png";A.hide();e.setText("Great Job!");e.show()}function f(D,G,B,E,A,F,e,C){G.setText("Master");if(n(D)){B.setText("Now...can you handle Ninja mode?!!!");B.hide();F.dom.src="images/replay_characters/Play-Ninja_50.png";F.parent().parent().parent().show();F.parent().parent().parent().hide()}else{B.setText("Master All 4 operations to unlock Ninja Mode!");F.parent().parent().parent().hide()}E.dom.src="images/replay_characters/Scratch_Ninja2_h200.png";A.dom.src="images/replay_characters/Scratch_Black_h75.png";e.setText("Great Job!");e.show()}function w(D,G,B,E,A,F,e,C){G.setText("Master");if(n(D)){B.setText("Now...can you handle Ninja mode?!!!");F.dom.src="images/replay_characters/Play-Ninja_50.png";F.parent().parent().parent().show()}else{B.setText("Master All 4 operations to unlock Ninja Mode!");F.parent().parent().parent().hide()}E.dom.src="images/replay_characters/Scratch_Ninja2_h200.png";A.dom.src="images/replay_characters/Scratch_Black_h75.png";e.setText("Great Job!");e.show()}function g(){}function n(A){var e=true;if(A.progress_report.ta9.posttest<94){e=false}if(A.progress_report.division.posttest<94){e=false}if(A.progress_report.subtraction.posttest<94){e=false}if(A.progress_report.addition.posttest<94){e=false}return e}},onClassSelected:function(b){var a=this.getGamesPanel();if(a===undefined||a===null){return}a.hide()},onSchoolSelected:function(b){var a=this.getGamesPanel();if(a===undefined||a===null){return}a.hide()},onPlayMultiplication:function(){var b=Ext.getStore("GameStore").find("id",student_data.id);var e=Ext.getStore("GameStore").data.items[b].data;var a=e.progress_report.ta9.posttest;var d=a>0;if(e.progress_report.ninja2!==undefined){a=e.progress_report.ninja2.posttest;d=a>0}if(e.progress_report["ta9-latest"]!==undefined){a=e.progress_report["ta9-latest"].posttest;d=a>0}var c=e.retest_data.ta9;if(d){var g=Ext.create("BigBrainzLauncher.view.ReplayDialog");g.app_id="ta9";if(a>=95){g.down("#fluentContainer").show();g.down("#notFluentContainer").hide();g.down("#pretestFromPosttestCB").show();g.down("#retestContainer").hide();this.application.fireEvent("addReplayGame","ta9","ninja1")}else{if(c>=100){label=Ext.ComponentQuery.query("#notFluentLabel")[0];label.setText(label.text.replace("**",a));g.down("#fluentContainer").hide();g.down("#notFluentContainer").show();g.down("#pretestFromPosttestCB").show();g.down("#retestContainer").hide();g.show()}else{label=Ext.ComponentQuery.query("#notFluentLabel")[0];label.setText(label.text.replace("**",a));g.down("#fluentContainer").hide();g.down("#notFluentContainer").hide();g.down("#pretestFromPosttestCB").hide();g.down("#retestContainer").show();this.application.fireEvent("retestStudent","ta9","normal")}}}else{f()}function f(){var m="turbo";if(class_data.name=="Ninja Apprentice"){m="ninja1"}else{if(class_data.name=="Ninja"){m="ninja2"}else{if(class_data.name=="Ninja Master"){m="ninja3"}else{if(class_data.name=="Ninja Calculated"||class_data.name.endsWith("_*")){m="ninjaC"}}}}var h=student_data.id;try{if(Ext.getStore("SchoolStore").count()>0){var n=Ext.getStore("SchoolStore").getById(school_data.id).data.il_school;if(n){h="il"+h}if(Ext.getStore("SchoolStore").data.items[0].data.purchase_status.indexOf("TA12")>-1){m="mult"}}var l=1;l=Ext.getStore("GameStore").data.items[b].data.to_play_data.ta9.latest;if(l>1){h+="_playthrough_"+l}var k=Ext.getStore("GameStore").data.items[b].data.to_play_data.ta9.version;if(k!=="normal"){m=k}}catch(o){}window.location.href="play.php?appid="+m+"&school_id="+school_data.id+"&id="+h}},onPlayDivision:function(){var b=Ext.getStore("GameStore").find("id",student_data.id);var e=Ext.getStore("GameStore").data.items[b].data;var a=e.progress_report.division.posttest;var d=a>0;var c=e.retest_data.division;if(d){var g=Ext.create("BigBrainzLauncher.view.ReplayDialog");g.app_id="division";if(a>=95){g.down("#fluentContainer").show();g.down("#notFluentContainer").hide();g.down("#pretestFromPosttestCB").show();g.down("#retestContainer").hide()}else{if(c>=100){label=Ext.ComponentQuery.query("#notFluentLabel")[0];label.setText(label.text.replace("**",a));g.down("#fluentContainer").hide();g.down("#notFluentContainer").show();g.down("#pretestFromPosttestCB").show();g.down("#retestContainer").hide()}else{label=Ext.ComponentQuery.query("#notFluentLabel")[0];label.setText(label.text.replace("**",a));g.down("#fluentContainer").hide();g.down("#notFluentContainer").hide();g.down("#pretestFromPosttestCB").hide();g.down("#retestContainer").show();this.application.fireEvent("retestStudent","division","normal")}}}else{f()}function f(){var l="division";try{var h=student_data.id;var m=Ext.getStore("SchoolStore").getById(school_data.id).data.il_school;if(m){h="il"+h}var k=Ext.getStore("GameStore").data.items[b].data.to_play_data.division.latest;k=1;if(k>1){h+="_playthrough_"+k}}catch(n){}window.location.href="play.php?appid=division&school_id="+school_data.id+"&id="+h}},onPlayAddition:function(){var b=Ext.getStore("GameStore").find("id",student_data.id);var e=Ext.getStore("GameStore").data.items[b].data;var a=e.progress_report.addition.posttest;var d=a>0;var c=e.retest_data.addition;if(d){var g=Ext.create("BigBrainzLauncher.view.ReplayDialog");g.app_id="addition";if(a>=95){g.down("#fluentContainer").show();g.down("#notFluentContainer").hide();g.down("#pretestFromPosttestCB").show();g.down("#retestContainer").hide()}else{if(c>=100){label=Ext.ComponentQuery.query("#notFluentLabel")[0];label.setText(label.text.replace("**",a));g.down("#fluentContainer").hide();g.down("#notFluentContainer").show();g.down("#pretestFromPosttestCB").show();g.down("#retestContainer").hide()}else{label=Ext.ComponentQuery.query("#notFluentLabel")[0];label.setText(label.text.replace("**",a));g.down("#fluentContainer").hide();g.down("#notFluentContainer").hide();g.down("#pretestFromPosttestCB").hide();g.down("#retestContainer").show();this.application.fireEvent("retestStudent","addition","normal")}}}else{f()}function f(){var l="addition";try{var h=student_data.id;var m=Ext.getStore("SchoolStore").getById(school_data.id).data.il_school;if(m){h="il"+h}var k=Ext.getStore("GameStore").data.items[b].data.to_play_data.addition.latest;k=1;if(k>1){h+="_playthrough_"+k}}catch(n){}window.location.href="play.php?appid=addition&school_id="+school_data.id+"&id="+h}},onPlaySubtraction:function(){var b=Ext.getStore("GameStore").find("id",student_data.id);var e=Ext.getStore("GameStore").data.items[b].data;var a=e.progress_report.subtraction.posttest;var d=a>0;var c=e.retest_data.subtraction;if(d){var g=Ext.create("BigBrainzLauncher.view.ReplayDialog");g.app_id="subtraction";if(a>=95){g.down("#fluentContainer").show();g.down("#notFluentContainer").hide();g.down("#pretestFromPosttestCB").show();g.down("#retestContainer").hide()}else{if(c>=100){label=Ext.ComponentQuery.query("#notFluentLabel")[0];label.setText(label.text.replace("**",a));g.down("#fluentContainer").hide();g.down("#notFluentContainer").show();g.down("#pretestFromPosttestCB").show();g.down("#retestContainer").hide()}else{label=Ext.ComponentQuery.query("#notFluentLabel")[0];label.setText(label.text.replace("**",a));g.down("#fluentContainer").hide();g.down("#notFluentContainer").hide();g.down("#pretestFromPosttestCB").hide();g.down("#retestContainer").show();this.application.fireEvent("retestStudent","subtraction","normal")}}}else{f()}function f(){var l="subtraction";try{var h=student_data.id;var m=Ext.getStore("SchoolStore").getById(school_data.id).data.il_school;if(m){h="il"+h}var k=Ext.getStore("GameStore").data.items[b].data.to_play_data.subtraction.latest;k=1;if(k>1){h+="_playthrough_"+k}}catch(n){}window.location.href="play.php?appid=subtraction&school_id="+school_data.id+"&id="+h}},onPlayAddSubtract:function(){a();function a(){var c="addsubtract";var b=student_data.id;try{var d=Ext.getStore("SchoolStore").getById(school_data.id).data.il_school;if(d){b="il"+b}}catch(f){}window.location.href="play.php?appid=addsubtract&school_id="+school_data.id+"&id="+b}},init:function(a){a.on({studentSelected:{fn:this.onStudentSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this},playMultiplication:{fn:this.onPlayMultiplication,scope:this},playDivision:{fn:this.onPlayDivision,scope:this},playAddition:{fn:this.onPlayAddition,scope:this},playSubtraction:{fn:this.onPlaySubtraction,scope:this},playAddSubtract:{fn:this.onPlayAddSubtract,scope:this}})}});Ext.define("BigBrainzLauncher.controller.DistrictTree",{extend:"Ext.app.Controller",refs:[{ref:"districtTree",selector:"#districtTree"}],onTreepanelAfterRender:function(a,b){this.application.fireEvent("districtSelected",district_data.id)},onTreepanelBeforeLoad:function(b,a,c){Ext.getStore("DistrictTreeStore").getRootNode().data.text=district_data.name},onTreepanelItemExpand:function(b,a){if(b.data.id==="0"){return}Ext.getStore("ClassStore").proxy.url="routes/routes.php?url=/schools/"+b.data.id+"/children";Ext.getStore("ClassStore").load({callback:function(d,c,e){if(!e){Ext.getStore("ClassStore").load()}}})},onTreepanelSelect:function(d,a,b,c){if(a.data.id==="0"){this.application.fireEvent("districtSelected",district_data.id)}else{if(a.data.leaf){class_data.id=a.data.id;class_data.name=a.data.text;this.application.fireEvent("classSelected",a.data.id)}else{school_data.id=a.data.id;school_data.name=a.data.text;var e=Ext.getStore("DistrictTreeStore").getById(a.data.id);this.getDistrictTree().expandNode(e);this.application.fireEvent("schoolSelected",a.data.id)}}},onTreepanelLoad:function(a,e,b,h,c){var g=this.getDistrictTree();try{f()}catch(d){}function f(){var k=Ext.getStore("DistrictTreeStore").getRootNode();g.expandNode(k)}},onOverviewReportGridRowSelected:function(c){var a=this.getDistrictTree();if(a===undefined||a===null){return}var b=a.getStore().getNodeById(c);a.getSelectionModel().select(b)},init:function(a){this.control({"#districtTree":{afterrender:this.onTreepanelAfterRender,beforeload:this.onTreepanelBeforeLoad,itemexpand:this.onTreepanelItemExpand,select:this.onTreepanelSelect,load:this.onTreepanelLoad}});a.on({overviewReportGridRowSelected:{fn:this.onOverviewReportGridRowSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.DistrictOverview",{extend:"Ext.app.Controller",refs:[{ref:"districtOverview",selector:"#districtOverview"},{ref:"districtTree",selector:"#districtTree"},{ref:"overviewReportGrid",selector:"#overviewReportGrid"}],onViewportAfterRender:function(h,f){Ext.define("report_data",{singleton:true,data:""});Ext.define("report_grid_data",{singleton:true,data:""});Ext.define("pretest_data",{singleton:true,data:""});Ext.define("posttest_data",{singleton:true,data:""});Ext.define("avg_improvement",{singleton:true,data:""});var a="BB02691691445231259433720081208183020372969";if(district_data.id==a){for(var d=3;d<=11;d++){this.getOverviewReportGrid().columns[d].show()}this.getOverviewReportGrid().columns[12].hide();for(var d=3;d<=11;d++){this.getOverviewReportGrid().columns[d].autoSize()}}var e=this.getDistrictOverview();var k=e.down("tab");var b=k.next();b.activate();var l="Loading.  Please wait...";if(Ext.ieVersion<9&&Ext.ieVersion>0){l="You are using an older version of Internet Explorer.  This may take longer to load.  Please wait."}if(Ext.getCmp("school_selection_window")){Ext.getCmp("school_selection_window").hide()}var c;var g=this.getDistrictTree();while(c=g.getRootNode().childNodes[0]){g.getRootNode().removeChild(c)}Ext.getStore("DistrictTreeStore").proxy.url="routes/routes.php?url=/districts/"+district_data.id+"/schools/tree";Ext.getStore("DistrictTreeStore").load({callback:function(n,m,o){if(!o){Ext.getStore("DistrictTreeStore").load();return}}});Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/districts/"+district_data.id+"/summary/current",success:function(m){var n=Ext.decode(m.responseText);Ext.get("avg_posttest_scores").dom.innerHTML="Average Post-Test Scores: "+Math.round(n.avg_test_scores)+"%";Ext.get("instructional_hours").dom.innerHTML="Instructional Hours: "+Ext.util.Format.number(n.instructional_hours,"0,000")},failure:function(){},callback:function(){}});Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/districts/"+district_data.id+"/avg_improvement",success:function(m){if(m.responseText!==""){averageImprovement=Ext.decode(m.responseText);Ext.get("total_students").dom.innerHTML="Total operations finished or played > 1 hour: "+Ext.util.Format.number(averageImprovement.all.count,"0,000");if(averageImprovement.all.avg_improvement-100>0){Ext.get("average_improvement").dom.innerHTML="Average Improvement: "+(averageImprovement.all.avg_improvement-100)+"%"}else{Ext.get("average_improvement").dom.innerHTML="Average Improvement: "}}else{Ext.get("total_students").dom.innerHTML="";Ext.get("average_improvement").dom.innerHTML=""}},failure:function(){Ext.get("total_students").dom.innerHTML="";Ext.get("average_improvement").dom.innerHTML=""}})},init:function(a){this.control({"#districtOverview":{afterrender:this.onViewportAfterRender}})}});Ext.define("BigBrainzLauncher.controller.LoginViewportController",{extend:"Ext.app.Controller",refs:[{ref:"loginViewport",selector:"#loginViewport"},{ref:"schoolSelectionPanel",selector:"#schoolSelectionPanel"},{ref:"countryCombo",selector:"#selectCountryPanel combobox"},{ref:"stateCombo",selector:"#selectStatePanel combobox"},{ref:"districtCombo",selector:"#selectDistrictPanel combobox"}],onButtonClick:function(c,f,b){var d=this.getSchoolSelectionPanel();var a=d.items.indexOf(d.layout.activeItem);d.layout.setActiveItem(a-1)},onComboboxSelect:function(c,a,b){this.setupStore("countries","StateStore",c.value,c.getRawValue(),1)},onComboboxSelect1:function(c,a,b){this.setupStore("states","DistrictStore",c.value,c.getRawValue(),2)},onComboboxSelect2:function(c,a,b){this.setupStore("districts","SchoolStore",c.value,c.getRawValue(),3)},onComboboxSelect3:function(c,a,b){this.getSchoolSelectionPanel().layout.setActiveItem(4)},onCountryPanelActivate:function(a,b){},onStatePanelActivate:function(a,b){a.down("#countryButton").setText(this.getCountryCombo().getRawValue())},onDistrictPanelActivate:function(a,b){a.down("#countryButton").setText(this.getCountryCombo().getRawValue());a.down("#stateButton").setText(this.getStateCombo().getRawValue())},onSchoolPanelActivate:function(a,b){a.down("#countryButton").setText(this.getCountryCombo().getRawValue());a.down("#stateButton").setText(this.getStateCombo().getRawValue());a.down("#districtButton").setText(this.getDistrictCombo().getRawValue())},onPanelActivate:function(a,b){var c=a.down("combobox");if(c!==undefined||c!==null){c.focus();c.reset();c.expand()}},onCountryButtonClick:function(b,c,a){this.getSchoolSelectionPanel().layout.setActiveItem(0)},onStateButtonClick:function(b,c,a){this.getSchoolSelectionPanel().layout.setActiveItem(1)},onDistrictButtonClick:function(b,c,a){this.getSchoolSelectionPanel().layout.setActiveItem(2)},setupStore:function(a,b,f,c,e){var d=this.getSchoolSelectionPanel();Ext.getStore(b).proxy.url="routes/routes.php?url=/"+a+"/"+f+"/children";Ext.getStore(b).load({callback:function(h,g,k){d.layout.setActiveItem(e)}})},init:function(a){this.control({"#back":{click:this.onButtonClick},"#selectCountryPanel combobox":{select:this.onComboboxSelect},"#selectStatePanel combobox":{select:this.onComboboxSelect1},"#selectDistrictPanel combobox":{select:this.onComboboxSelect2},"#selectSchoolPanel combobox":{select:this.onComboboxSelect3},"#selectCountryPanel":{activate:this.onCountryPanelActivate},"#selectStatePanel":{activate:this.onStatePanelActivate},"#selectDistrictPanel":{activate:this.onDistrictPanelActivate},"#selectSchoolPanel":{activate:this.onSchoolPanelActivate},"#loginViewport panel":{activate:this.onPanelActivate},"#countryButton":{click:this.onCountryButtonClick},"#stateButton":{click:this.onStateButtonClick},"#districtButton":{click:this.onDistrictButtonClick}})}});Ext.define("BigBrainzLauncher.controller.DailyUsageChart",{extend:"Ext.app.Controller",refs:[{ref:"dailyUsageChart",selector:"#dailyUsageChart"},{ref:"schoolReportTabs",selector:"#schoolReportTabs"},{ref:"reportYearSelector",selector:"#reportYearSelector"}],onPanelExpand:function(d,a){var c=this.getSchoolReportTabs().active_app_id();var b=this.getDailyUsageChart();if(b===undefined||b===null){return}if(this.getDailyUsageChart().data===undefined||this.getDailyUsageChart().data===null){return}Ext.getStore("DailyProgressStore").loadRawData(this.getDailyUsageChart().data[c])},onDistrictSelected:function(a){this.update(a)},onSchoolSelected:function(a){this.update(a)},onClassSelected:function(a){this.update(a)},onReportTabChange:function(b){var a=this.getDailyUsageChart();if(a===undefined||a===null){return}if(this.getDailyUsageChart().data===undefined||this.getDailyUsageChart().data===null){return}Ext.getStore("DailyProgressStore").loadRawData(this.getDailyUsageChart().data[b])},onReportYearSelected:function(a){var b=school_data.id;if(b===null||b===undefined||b===""){b=district_data.id}this.update(b)},update:function(d){var c=this.getDailyUsageChart();if(c===undefined||c===null){return}var b=this.getSchoolReportTabs().active_app_id();var a="current";if(this.getReportYearSelector()!==undefined&&this.getReportYearSelector()!==null){a=this.getReportYearSelector().value}if(a!="current"){if(c.rendered){c.getEl().mask("Previous daily usage<br />is not available.","no-image")}Ext.getStore("DailyProgressStore").clearData();return}if(c.rendered){c.mask()}Ext.Ajax.request({retries:2,method:"GET",url:"routes/routes.php?url=/districts/"+d+"/daily_progress/"+a,success:function(e){c.data=Ext.decode(e.responseText);Ext.getStore("DailyProgressStore").loadRawData(c.data[b])},failure:function(){},callback:function(){if(c.rendered){c.mask();c.unmask()}}})},init:function(a){this.control({"#summaryGraphs":{expand:this.onPanelExpand}});a.on({districtSelected:{fn:this.onDistrictSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},reportTabChange:{fn:this.onReportTabChange,scope:this},reportYearSelected:{fn:this.onReportYearSelected,scope:this}})}});Ext.define("BigBrainzLauncher.controller.OverviewReportGrid",{extend:"Ext.app.Controller",refs:[{ref:"overviewReportGrid",selector:"#overviewReportGrid"},{ref:"schoolReportTabs",selector:"#schoolReportTabs"},{ref:"overviewReportGridProgressBar",selector:"#overviewReportGridProgressBar"},{ref:"reportYearSelector",selector:"#reportYearSelector"},{ref:"summaryGraphs",selector:"#summaryGraphs"}],onGridpanelSelect:function(d,a,b,c){this.application.fireEvent("overviewReportGridRowSelected",a.data.id)},onGridpanelSortChange:function(c,d,f,b){var e=this.getSchoolReportTabs().active_app_id();var a=this;setTimeout(function(){a.displayComprehensiveSummary(e)},250)},onDistrictSelected:function(b){this.show();var a=this.getSummaryGraphs();if(a!==undefined&&a!==null){a.show()}this.load(b,"districts");this.getOverviewReportGrid().columns[0].setText("School")},onSchoolSelected:function(b){this.show();var a=this.getSummaryGraphs();if(a!==undefined&&a!==null){a.show()}if(this.getOverviewReportGrid()!==undefined&&this.getOverviewReportGrid()!==null){this.getOverviewReportGrid().columns[0].setText("Class")}this.load(b,"schools")},onClassSelected:function(a){this.hide()},onStudentSelected:function(b){this.hide();var a=this.getSummaryGraphs();if(a!==undefined&&a!==null){a.hide()}},onReportYearSelected:function(b){var a="schools";var c=school_data.id;if(Ext.ComponentQuery.query("#educatorViewport").length<1){a="districts";c=district_data.id}this.load(c,a)},onReportTabChange:function(a){this.update()},load:function(b,l){var o=this.getOverviewReportGrid();if(o===undefined||o===null){return}var r=this.getSchoolReportTabs().active_app_id();var n="current";try{n=this.getReportYearSelector().value}catch(m){}if(o.rendered){o.mask()}var f=this;o.data={};f.comprehensiveSummary={};var g=this.getOverviewReportGridProgressBar();var a=[];var q=[];var c=undefined;if(l=="districts"){c=Ext.getStore("DistrictTreeStore").getRootNode()}else{if(Ext.ComponentQuery.query("#districtOverview").length>0){c=Ext.getStore("DistrictTreeStore").getNodeById(b)}else{c=Ext.getStore("SchoolTreeStore").getRootNode()}}var d=0;setTimeout(function(){p()},1000);function p(){if(c.childNodes.length<1){d+=1;if(d<=6){setTimeout(function(){p()},1000*d);return}}var e=c.childNodes;for(var s=0;s<e.length;s++){a.push(e[s].get("id"));q.push(e[s].get("id"))}k(a,function(t){g.hide();f.update(r);o.unmask();o.columns[0].autoSize();if(t.length>0){k(t,function(u){f.update(r)})}});h(q,function(t){g.hide();f.update(r);o.unmask();o.columns[0].autoSize();if(t.length>0){h(t,function(u){f.update(r)})}})}function k(u,x){g.show();var w=[];var e=[];v(u);var t=u.length;var s=0;function v(A){if(A.length){var y=[];for(var z=0;z<10;z++){if(A.length<1){continue}y.push(A.shift())}var B=Ext.encode(y).replace("[","").replace("]","").replace(/"/g,"");Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/"+l+"/report/"+n+"/"+B,callback:function(){v(A)},success:function(C){if(C.responseText===""){return}var D;try{D=Ext.decode(C.responseText)}catch(E){for(var F=0;F<y.length;F++){w.push(y[F])}return}for(classId in D){var H=D[classId];for(var G in H){if(o.data[G]===undefined){o.data[G]=[]}o.data[G].push(H[G][0])}}},failure:function(){w.push(classId)}});f.update(r)}else{x(w)}}}function h(u,v){var e=[];var t=u.length;s(u);function s(y){g.updateProgress((t-y.length)/t,Math.round((t-y.length)/t*100)+"% loaded...");if(y.length){var w=[];for(var x=0;x<10;x++){if(y.length<1){continue}w.push(y.shift())}var z=Ext.encode(w).replace("[","").replace("]","").replace(/"/g,"");Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/classes/comprehensive_summaries/"+n+"/"+z,success:function(A){if(A.responseText===""){return}try{var E=Ext.decode(A.responseText)}catch(C){for(var D=0;D<w.length;D++){e.push(w[D])}return}for(classId in E){var B=E[classId];f.comprehensiveSummary[classId]=B}},failure:function(){for(var A=0;A<w.length;A++){e.push(w[A])}},callback:function(){s(y)}});f.update(r)}else{v(e)}}}},update:function(){var d=this.getSchoolReportTabs().active_app_id();var a=this.getOverviewReportGrid();if(a===undefined||a===null){return}var e=a.data[d];if(e===undefined){return}var c=[];for(var b=0;b<e.length;b++){if(e[b]===undefined){continue}c.push(e[b])}Ext.getStore("DistrictReportStore").loadRawData(c);Ext.getStore("DistrictReportStore").sort("pretest_taken","desc");this.displayComprehensiveSummary(d)},show:function(){var a=this.getOverviewReportGrid();if(a===undefined||a===null){return}a.up().show()},hide:function(){var a=this.getOverviewReportGrid();if(a===undefined||a===null){return}a.up().hide()},generateSummary:function(g,b,n){var d=g.length;var k=[];var e=0;for(var h=0;h<d;h++){if(g[h].deleted){continue}var m=g[h].ta9.pretest;var a=g[h].ta9.progress;var q=g[h].ta9.posttest;var p="ta9";var f=g[h].ta9.time_played_recently;if(m>=0){e+=1}var o="Multiplication";if(m<0){m=g[h].addition.pretest;a=g[h].addition.progress;q=g[h].addition.posttest;f=g[h].addition.time_played_recently;p="addition";o="Addition";if(m>=0){e+=1}}if(m<0){m=g[h].division.pretest;a=g[h].division.progress;q=g[h].division.posttest;f=g[h].division.time_played_recently;p="division";o="Division";if(m>=0){e+=1}}if(m<0){m=g[h].subtraction.pretest;a=g[h].subtraction.progress;q=g[h].subtraction.posttest;f=g[h].subtraction.time_played_recently;p="subtraction";o="Subtraction";if(m>=0){e+=1}}var l=this.createCellData(m,f,a,q,g,p,o,h,e);if(l!==undefined){l.combined=c(g[h]);k.push(l)}}this.setCell(k,b,n);function c(s){var r={};r.count=0;r.ta9={};r.ta9.pretest=s.ta9.pretest;if(r.ta9.pretest>-1){r.count+=1}r.ta9.progress=s.ta9.progress;r.ta9.posttest=s.ta9.posttest;r.division={};r.division.pretest=s.division.pretest;if(r.division.pretest>-1){r.count+=1}r.division.progress=s.division.progress;r.division.posttest=s.division.posttest;r.addition={};r.addition.pretest=s.addition.pretest;if(r.addition.pretest>-1){r.count+=1}r.addition.progress=s.addition.progress;r.addition.posttest=s.addition.posttest;r.subtraction={};r.subtraction.pretest=s.subtraction.pretest;if(r.subtraction.pretest>-1){r.count+=1}r.subtraction.progress=s.subtraction.progress;r.subtraction.posttest=s.subtraction.posttest;return r}},generateSummaryAppId:function(e,b,n,l){var c=e.length;var g=[];for(var f=0;f<c;f++){if(e[f].deleted){continue}if(n=="mult"){continue}var k=e[f][n].pretest;var a=e[f][n].progress;var o=e[f][n].posttest;var d=e[f][n].time_played_recently;var m="Multiplication";if(n=="addition"){m="Addition"}else{if(n=="division"){m="Division"}else{if(n=="subtraction"){m="Subtraction"}}}var h=this.createCellData(k,d,a,o,e,n,m,f);if(h!==undefined){g.push(h)}}this.setCell(g,b,l,null)},createCellData:function(k,d,b,n,g,m,l,h,c){var f=Math.floor((128*k)/100+127);var a="rgb("+f+",0,0)";var e="red";if(k==-1){return undefined;a="rgb(128,128,128)";e="black"}else{if(n>-1){f=Math.floor(180*n/100+50);a="rgb(0,"+255+",0)";e="green"}else{f=Math.floor(180*b/100+50);a="rgb("+0+","+112+",203)";e="blue"}}return{border:e,color:f,colorString:a,id:g[h].id,name:g[h].name,appId:m,title:l,data:g[h][m],pretestCount:c}},popupDetails:function(e,b,g){var f=this.sortedData[g][b];var d=this;if(f.combined!==undefined&&f.combined.count>1){a()}else{c()}function a(){if(!(d.studentDetailsWindow===null||d.studentDetailsWindow===undefined)){d.studentDetailsWindow.hide()}if(d.studentMultipleDetailsWindow===null||d.studentMultipleDetailsWindow===undefined){d.studentMultipleDetailsWindow=Ext.create("BigBrainzLauncher.view.StudentMultipleDetails")}if(d.hideTimerMultiple!==undefined){clearTimeout(d.hideTimerMultiple)}Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsName")[0].setText(f.name);if(f.combined.ta9.pretest=="-1"){Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsTA9")[0].hide()}else{Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsTA9")[0].show();Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsTA9 #pretestScore")[0].setText(f.combined.ta9.pretest);if(f.combined.ta9.posttest==-1){Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsTA9 #progressPosttestLabel")[0].setText("Multiplication Progress:");Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsTA9 #progressPosttestScore")[0].setText(f.combined.ta9.progress)}else{Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsTA9 #progressPosttestLabel")[0].setText("Multiplication Post-Test:");Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsTA9 #progressPosttestScore")[0].setText(f.combined.ta9.posttest)}}if(f.combined.division.pretest=="-1"){Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsDivision")[0].hide()}else{Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsDivision")[0].show();Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsDivision #pretestScore")[0].setText(f.combined.division.pretest);if(f.combined.division.posttest==-1){Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsDivision #progressPosttestLabel")[0].setText("Division Progress:");Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsDivision #progressPosttestScore")[0].setText(f.combined.division.progress)}else{Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsDivision #progressPosttestLabel")[0].setText("Division Post-Test:");Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsDivision #progressPosttestScore")[0].setText(f.combined.division.posttest)}}if(f.combined.addition.pretest=="-1"){Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsAddition")[0].hide()}else{Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsAddition")[0].show();Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsAddition #pretestScore")[0].setText(f.combined.addition.pretest);if(f.combined.addition.posttest==-1){Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsAddition #progressPosttestLabel")[0].setText("Addition Progress:");Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsAddition #progressPosttestScore")[0].setText(f.combined.addition.progress)}else{Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsAddition #progressPosttestLabel")[0].setText("Addition Post-Test:");Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsAddition #progressPosttestScore")[0].setText(f.combined.addition.posttest)}}if(f.combined.subtraction.pretest=="-1"){Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsSubtraction")[0].hide()}else{Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsSubtraction")[0].show();Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsSubtraction #pretestScore")[0].setText(f.combined.subtraction.pretest);if(f.combined.subtraction.posttest==-1){Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsSubtraction #progressPosttestLabel")[0].setText("Subtraction Progress:");Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsSubtraction #progressPosttestScore")[0].setText(f.combined.subtraction.progress)}else{Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsSubtraction #progressPosttestLabel")[0].setText("Subtraction Post-Test:");Ext.ComponentQuery.query("studentMultipleDetails #studentMultipleDetailsSubtraction #progressPosttestScore")[0].setText(f.combined.subtraction.posttest)}}d.studentMultipleDetailsWindow.showAt(e.clientX,e.clientY-275)}function c(){if(!(d.studentMultipleDetailsWindow===null||d.studentMultipleDetailsWindow===undefined)){d.studentMultipleDetailsWindow.hide()}var o=f.data.pretest;var k=f.data.progress;var t=f.data.posttest;var q=f.title;if(d.studentDetailsWindow===null||d.studentDetailsWindow===undefined){d.studentDetailsWindow=Ext.create("BigBrainzLauncher.view.StudentDetails")}if(d.hideTimer!==undefined){clearTimeout(d.hideTimer)}Ext.ComponentQuery.query("studentDetails #studentDetailsPretestScore")[0].setText(o+"%");var m=o;var p=k;var n=t;if(p<1&&n<1){Ext.ComponentQuery.query("studentDetails #studentDetailsImprovement")[0].setText("")}else{if(n>0){Ext.ComponentQuery.query("studentDetails #studentDetailsImprovement")[0].setText(Math.floor(n/m*100-100)+"%")}else{var h=Math.floor(p/m*100-100);if(h<0){h=0}Ext.ComponentQuery.query("studentDetails #studentDetailsImprovement")[0].setText(h+"%")}}Ext.ComponentQuery.query("studentDetails #studentDetailsTimeInvested")[0].setText(Math.round(f.data.minutes_total/60*10)/10+" Hours");if(n<1){Ext.ComponentQuery.query("studentDetails #studentDetailsTimeRemaining")[0].setText(Math.round(10*((100-p)*6.54)/60)/10+" Hours")}else{Ext.ComponentQuery.query("studentDetails #studentDetailsTimeRemaining")[0].setText("")}if(f.data.minutes_total>=60||f.border=="green"){Ext.ComponentQuery.query("studentDetails #studentDetailsPPH")[0].setText(Math.round(((f.data.progress-o)/(f.data.minutes_total/60))*10)/10+"%")}else{Ext.ComponentQuery.query("studentDetails #studentDetailsPPH")[0].setText("Not enough playing time.")}Ext.ComponentQuery.query("studentDetails #studentDetailsTimeInvestedRecently")[0].setText(Math.round(f.data.time_played_recently/60*10)/10+" Hours");var l=Ext.ComponentQuery.query("studentDetails #studentDetailsName")[0];l.setText(f.name);Ext.ComponentQuery.query("studentDetails")[0].setTitle(q);if(d.sortedData[g][b].border==="black"){Ext.ComponentQuery.query("studentDetails #studentDetailsName")[0].setText("No pretest taken.");Ext.ComponentQuery.query("studentDetails #studentDetailsPPH")[0].setText("");Ext.ComponentQuery.query("studentDetails #studentDetailsTimeInvestedRecently")[0].setText("");Ext.ComponentQuery.query("studentDetails #studentDetailsTimeRemaining")[0].setText("");Ext.ComponentQuery.query("studentDetails #studentDetailsImprovement")[0].setText("");Ext.ComponentQuery.query("studentDetails #studentDetailsProgressPosttest")[0].setText("");Ext.ComponentQuery.query("studentDetails #studentDetailsPretestScore")[0].setText("");Ext.ComponentQuery.query("studentDetails #studentDetailsTimeInvested")[0].setText("");Ext.ComponentQuery.query("studentDetails #pretestLabel")[0].setText("");Ext.ComponentQuery.query("studentDetails #studentDetailsProgressPosttestLabel")[0].setText("");Ext.ComponentQuery.query("studentDetails #improvementLabel")[0].setText("");Ext.ComponentQuery.query("studentDetails #timeInvestedLabel")[0].setText("");Ext.ComponentQuery.query("studentDetails #estTimeRemainingLabel")[0].setText("");Ext.ComponentQuery.query("studentDetails #pphLabel")[0].setText("");Ext.ComponentQuery.query("studentDetails #timeInvestedRecentlyLabel")[0].setText("")}else{if(t==-1){Ext.ComponentQuery.query("studentDetails #studentDetailsProgressPosttestLabel")[0].setText("Progress");Ext.ComponentQuery.query("studentDetails #studentDetailsProgressPosttest")[0].setText(k+"%")}else{Ext.ComponentQuery.query("studentDetails #studentDetailsProgressPosttestLabel")[0].setText("Post-Test");Ext.ComponentQuery.query("studentDetails #studentDetailsProgressPosttest")[0].setText(t+"%")}Ext.ComponentQuery.query("studentDetails #pretestLabel")[0].setText("Pre-Test:");Ext.ComponentQuery.query("studentDetails #improvementLabel")[0].setText("Improvement:");Ext.ComponentQuery.query("studentDetails #timeInvestedLabel")[0].setText("Time Invested:");Ext.ComponentQuery.query("studentDetails #estTimeRemainingLabel")[0].setText("Estimated Time Remaining:");Ext.ComponentQuery.query("studentDetails #pphLabel")[0].setText("Progress Per Hour:");Ext.ComponentQuery.query("studentDetails #timeInvestedRecentlyLabel")[0].setText("Time Invested Last 2 Weeks:")}d.studentDetailsWindow.showAt(e.clientX,e.clientY-275);var s=new Ext.util.TextMetrics(l.getEl());var r=s.getWidth(l.text)+1;l.setWidth(r)}},popupMultipleDetails:function(c,l,f){var h=this.sortedData[f][l];var k=h.data.pretest;var b=h.data.progress;var q=h.data.posttest;var n=h.title;if(this.studentDetailsWindow===null||this.studentDetailsWindow===undefined){this.studentDetailsWindow=Ext.create("BigBrainzLauncher.view.StudentDetails")}if(this.hideTimer!==undefined){clearTimeout(this.hideTimer)}Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsPretestScore")[0].setText(k+"%");var e=k;var m=b;var g=q;if(m<1&&g<1){Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsImprovement")[0].setText("")}else{if(g>0){Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsImprovement")[0].setText(Math.floor(g/e*100-100)+"%")}else{var a=Math.floor(m/e*100-100);if(a<0){a=0}Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsImprovement")[0].setText(a+"%")}}Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsTimeInvested")[0].setText(Math.round(h.data.minutes_total/60*10)/10+" Hours");if(g<1){Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsTimeRemaining")[0].setText(Math.round(10*((100-m)*6.54)/60)/10+" Hours")}else{Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsTimeRemaining")[0].setText("")}if(h.data.minutes_total>=60||h.border=="green"){Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsPPH")[0].setText(Math.round(((h.data.progress-k)/(h.data.minutes_total/60))*10)/10+"%")}else{Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsPPH")[0].setText("Not enough playing time.")}Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsTimeInvestedRecently")[0].setText(Math.round(h.data.time_played_recently/60*10)/10+" Hours");var d=Ext.ComponentQuery.query("#studentDetailsName")[0];d.setText(h.name);Ext.ComponentQuery.query("studentMultipleDetails")[0].setTitle(n);if(this.sortedData[f][l].border==="black"){Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsName")[0].setText("No pretest taken.");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsPPH")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsTimeInvestedRecently")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsTimeRemaining")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsImprovement")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsProgressPosttest")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsPretestScore")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsTimeInvested")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #pretestLabel")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsProgressPosttestLabel")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #improvementLabel")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #timeInvestedLabel")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #estTimeRemainingLabel")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #pphLabel")[0].setText("");Ext.ComponentQuery.query("studentMultipleDetails #timeInvestedRecentlyLabel")[0].setText("")}else{if(q==-1){Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsProgressPosttestLabel")[0].setText("Progress");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsProgressPosttest")[0].setText(b+"%")}else{Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsProgressPosttestLabel")[0].setText("Post-Test");Ext.ComponentQuery.query("studentMultipleDetails #studentDetailsProgressPosttest")[0].setText(q+"%")}Ext.ComponentQuery.query("studentMultipleDetails #pretestLabel")[0].setText("Pre-Test:");Ext.ComponentQuery.query("studentMultipleDetails #improvementLabel")[0].setText("Improvement:");Ext.ComponentQuery.query("studentMultipleDetails #timeInvestedLabel")[0].setText("Time Invested:");Ext.ComponentQuery.query("studentMultipleDetails #estTimeRemainingLabel")[0].setText("Estimated Time Remaining:");Ext.ComponentQuery.query("studentMultipleDetails #pphLabel")[0].setText("Progress Per Hour:");Ext.ComponentQuery.query("studentMultipleDetails #timeInvestedRecentlyLabel")[0].setText("Time Invested Last 2 Weeks:")}this.studentDetailsWindow.showAt(c.clientX,c.clientY-275);var p=new Ext.util.TextMetrics(d.getEl());var o=p.getWidth(d.text)+1;d.setWidth(o)},popdownDetails:function(b){var a=this;if(!(this.studentDetailsWindow===null||this.studentDetailsWindow===undefined)){this.hideTimer=setTimeout(function(){a.studentDetailsWindow.hide()},1000)}if(!(this.studentMultipleDetailsWindow===null||this.studentMultipleDetailsWindow===undefined)){this.hideTimerMultiple=setTimeout(function(){a.studentMultipleDetailsWindow.hide()},1000)}},setCell:function(t,n,o){var w=o;var q=e();var p=b();var k=Ext.ComponentQuery.query("overviewreportgrid")[0].down("grid").columns[12].getWidth();var c=Math.ceil(k/q);if(Ext.ComponentQuery.query("#districtOverview").length>0){var d=Ext.ComponentQuery.query("#districtTree")[0].getSelectionModel().selected.items.length;if(d>0){var l=Ext.ComponentQuery.query("#districtTree")[0].getSelectionModel().selected.items[0].data.id;if(l==="0"){var v=Math.floor(Math.max(1,o/c));p=f(p,v);w=Math.floor(o/v)}}else{var v=Math.floor(Math.max(1,o/c));p=f(p,v);w=Math.floor(o/v)}}var s=[];while(p.length>c){s.push(p.shift())}s=f(s,100)[0];if(s!==undefined){p.unshift(s)}var h=p.length;var a="";a+="<table style = ''><tr>";this.sortedData[n]=p;for(var r=0;r<h;r++){colorString=p[r].colorString;var y='onmouseover=\'BigBrainzLauncher.getApplication().getController("OverviewReportGrid").popupDetails(event, '+r+', "'+n+"\")'";var x="onmouseout ='BigBrainzLauncher.getApplication().getController(\"OverviewReportGrid\").popdownDetails()'";var g=(255-p[r].color)/255;if(p[r].border==="green"||p[r].border==="blue"){g=p[r].color/255}if(p[r].border==="black"){g=1}a+="<td "+x+" "+y+" id = 'summary-"+n+"-"+r+"' style = 'opacity:"+g+";filter: alpha(opacity="+g*100+");border-radius: 5px;width:"+q+"px;background-color: "+colorString+"'>&nbsp;</td>"}a+="</tr></table>";if(document.getElementById(n)!==undefined&&document.getElementById(n)!==null){document.getElementById(n).innerHTML=a}else{}function b(){return t.sort(function(A,z){if(A.border===z.border){return(A.color<z.color)?-1:1}if(A.border==="black"&&z.border==="red"){return -1}if(A.border==="black"&&z.border==="blue"){return -1}if(A.border==="black"&&z.border==="green"){return -1}if(A.border==="red"&&z.border==="black"){return 1}if(A.border==="red"&&z.border==="blue"){return -1}if(A.border==="red"&&z.border==="green"){return -1}if(A.border==="blue"&&z.border==="black"){return 1}if(A.border==="blue"&&z.border==="red"){return 1}if(A.border==="blue"&&z.border==="green"){return -1}if(A.border==="green"){return 1}})}function e(){var z=15;if(w>60){z=10}if(w>80){z=7}if(w>100){z=5}return z}function f(C,A){if(false){return C}var E=C.length;var z=[];for(var B=0;B<E;B+=A){var D=u(C,B,A);z.push(D[0]);B-=D[1]}return z}function u(C,G,A){var F=C.slice(G,G+A);var E=F.length;var z=m(F[0]);z.title="Combined and Averaged";var D=1;for(var B=1;B<E;B++){if(z.border!=F[B].border){z.data.progress=Math.round(z.data.progress/(B+1));z.data.pretest=Math.round(z.data.pretest/(B+1));z.data.posttest=Math.round(z.data.posttest/D);z.color=Math.round(z.color/(B+1));z.data.minutes_total=Math.round(z.data.minutes_total/B);z.data.time_played_recently=Math.round(z.data.time_played_recently/B);z.name=B+" students combined";if(z.border=="green"){z.name=D+" students combined"}if(z.border=="black"){z.data.posttest=-1}return[z,E-B]}z.color+=F[B].color;z.data.minutes_total+=F[B].data.minutes_total;z.data.time_played_recently+=F[B].data.time_played_recently;if(F[B].data.progress>-1){z.data.progress+=F[B].data.progress}if(F[B].data.pretest>-1){z.data.pretest+=F[B].data.pretest}if(F[B].data.posttest>-1){z.data.posttest+=F[B].data.posttest;D+=1}}z.data.progress=Math.round(z.data.progress/F.length);z.data.minutes_total=Math.round(z.data.minutes_total/F.length);z.data.time_played_recently=Math.round(z.data.time_played_recently/F.length);z.data.pretest=Math.round(z.data.pretest/F.length);z.data.posttest=Math.round(z.data.posttest/D);if(z.border=="black"){z.data.posttest=-1}if(z.border=="green"){z.color=Math.round(z.color/D);z.name=D+" students combined"}else{z.color=Math.round(z.color/F.length);z.name=F.length+" students combined"}return[z,0]}function m(C){if(C===undefined){return}var B,A=0,z=C.length;if(typeof C!=="object"){B=C}else{if(z){B=[];for(;A<z;A++){B.push(m(C[A]))}}else{if(C.getTime){B=new Date(+C)}else{if(C.nodeName){B=C}else{B={};for(A in C){B[A]=m(C[A])}}}}}return B}},popupLegend:function(){var a=this;a.showLegendTimer=setTimeout(function(){try{if(Ext.query("#legendPopupText:hover").length>0){a.showLegend();clearTimeout(a.showLegendTimer)}}catch(b){}},500)},popdownLegend:function(){},displayComprehensiveSummary:function(c){this.sortedData={};var a=0;for(var b in this.comprehensiveSummary){a=Math.max(this.comprehensiveSummary[b].length,a)}for(var b in this.comprehensiveSummary){if(c=="all"){this.generateSummary(this.comprehensiveSummary[b],"summary-"+b,a)}else{this.generateSummaryAppId(this.comprehensiveSummary[b],"summary-"+b,c,a)}}},showLegend:function(){if(this.legend===null||this.legend===undefined){this.legend=Ext.create("BigBrainzLauncher.view.ComprehensiveSummaryLegend")}this.legend.show()},init:function(a){this.control({"#overviewReportGrid":{select:this.onGridpanelSelect},gridpanel:{sortchange:this.onGridpanelSortChange}});a.on({districtSelected:{fn:this.onDistrictSelected,scope:this},schoolSelected:{fn:this.onSchoolSelected,scope:this},classSelected:{fn:this.onClassSelected,scope:this},studentSelected:{fn:this.onStudentSelected,scope:this},reportYearSelected:{fn:this.onReportYearSelected,scope:this},reportTabChange:{fn:this.onReportTabChange,scope:this}})}});Ext.define("BigBrainzLauncher.controller.ReplayDialogController",{extend:"Ext.app.Controller",refs:[{ref:"addReplayGameButton",selector:"#addReplayGameButton"},{ref:"replayDialog",selector:"#replayDialog"}],onAddReplayGameButton:function(b,c,a){this.application.fireEvent("addReplayGame")},onAddReplayGame:function(b,a){var c=this.getReplayDialog();var a=c.down("radiogroup").getValue();a="ninja2";Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/games/"+student_data.id+"/add_replay_game",params:{app_id:b,version:a},success:function(f){var g=Ext.decode(f.responseText);if(g.success){Ext.MessageBox.alert("Replay Granted","Great!  Now you can play your game.");var e=student_data.id;var d=Ext.getStore("GameStore").find("id",e);Ext.getStore("GameStore").data.items[d].data.progress_report[c.app_id].posttest=-1;Ext.getStore("GameStore").data.items[0].data.to_play_data[b].latest=Ext.getStore("GameStore").data.items[0].data.to_play_data[b].latest+1;Ext.getStore("GameStore").data.items[0].data.to_play_data[b].version=a;setTimeout(function(){BigBrainzLauncher.getApplication().fireEvent("studentSelected",e)},500);c.close()}else{Ext.MessageBox.alert("Server Error","We could not process your replay request.  Please try again.")}},failure:function(){Ext.MessageBox.alert("Server Error","We could not process your replay request.  Please try again.")}})},onRetestStudent:function(b,a){win=this.getReplayDialog();studentID=student_data.id;Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/games/"+student_data.id+"/retest",params:{app_id:b},success:function(d){var e=Ext.decode(d.responseText);if(e.success){Ext.MessageBox.alert("Retest Granted","Great!  Now you can play your game.");var c=Ext.getStore("GameStore").find("id",studentID);Ext.getStore("GameStore").data.items[c].data.progress_report[b].posttest=-1;BigBrainzLauncher.getApplication().fireEvent("studentSelected",studentID);win.close()}else{Ext.MessageBox.alert("Server Error","We could not process your retest request.  Please try again.")}},failure:function(){Ext.MessageBox.alert("Server Error","We could not process your retest request.  Please try again.")}})},init:function(a){this.control({"#addReplayGameButton":{click:this.onAddReplayGameButton}});a.on({addReplayGame:{fn:this.onAddReplayGame,scope:this},retestStudent:{fn:this.onRetestStudent,scope:this}})}});Ext.define("BigBrainzLauncher.controller.SetMultSchoolYear",{extend:"Ext.app.Controller",refs:[{ref:"setChangesButton",selector:"#setYearMultipleBtn"},{ref:"classesGrid",selector:"#setMultSchoolYear gridpanel"},{ref:"setYearComboBox",selector:"#setMultSchoolYear combobox"}],onSetYearMultipleBtn:function(c,k,b){var h=this.getSetYearComboBox();var f=h.getValue();h.setValue("");var d=this.getClassesGrid().getSelectionModel().getSelection();var g=this;g.setClassDateCreated=function(){if(d.length<1){setTimeout(function(){var l=Ext.ComponentQuery.query("#schoolTree")[0];var m;while(m=l.getRootNode().childNodes[0]){l.getRootNode().removeChild(m)}Ext.getStore("ClassStore").load();Ext.getStore("SchoolTreeStore").load();c.up("window").close()},1000);return}var e=d.pop();a("classes",e.data.id,f)};g.setClassDateCreated();function a(l,r,o){var m=new Date().getFullYear();var e=new Date();var p=e.getMonth();if(p<=6){if(o=="Last Year"){m-=2}else{m-=1}}else{if(o=="Last Year"){m-=1}}var n=Math.floor(new Date(m+"/08/01").getTime()/1000);var q={ItemName:r,DateCreated:n,Timestamp_MostRecentGame:n};Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/"+l,params:q,success:function(s){res=Ext.decode(s.responseText);if(res){}else{Ext.Msg.alert(res.error)}},callback:function(){g.setClassDateCreated()},failure:function(){Ext.Msg.alert("Could set year.  Please try again.")}})}},onComboboxChange:function(d,c,a,b){this.notifyChange()},onGridpanelSelectionChange:function(a,c,b){this.notifyChange()},notifyChange:function(){var a=this.getSetChangesButton();a.enable();if(this.getClassesGrid().getSelectionModel().getSelection().length<1){a.disable()}if(this.getSetYearComboBox().value==null){a.disable()}},init:function(a){this.control({"#setYearMultipleBtn":{click:this.onSetYearMultipleBtn},"#setMultSchoolYear combobox":{change:this.onComboboxChange},"#setMultSchoolYear gridpanel":{selectionchange:this.onGridpanelSelectionChange}})}});Ext.define("BigBrainzLauncher.view.EditStudentsWindow",{extend:"Ext.window.Window",alias:"widget.editStudentsWindow",requires:["BigBrainzLauncher.view.OperationOrderEditor","BigBrainzLauncher.view.FriendlyModeCheckbox"],height:500,width:766,autoScroll:true,layout:{align:"stretch",type:"hbox"},closeAction:"hide",title:"Edit Student Names/Passwords",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",flex:1,layout:{align:"stretch",type:"vbox"},items:[{xtype:"label",itemId:"lblInstructions",margin:"10px",width:388,text:"Select the class you want to edit from the menu on the left. Double-click on a student's name or password to change it."},{xtype:"label",itemId:"lblPasswordInstructions",margin:"10px",width:388,text:"If the password is blank, it will automatically be set to the default password."},{xtype:"gridpanel",flex:1,margin:10,header:false,title:"Edit Individual Students",store:"GameStore",columns:[{xtype:"gridcolumn",dataIndex:"name",text:"Name",flex:1,editor:{xtype:"textfield"}},{xtype:"gridcolumn",itemId:"username",dataIndex:"username",text:"Username",flex:1,editor:{xtype:"textfield"}},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){if(g===undefined||g===null||g===""){return"(default password)"}else{return g}},dataIndex:"password",text:"Password",flex:1,editor:{xtype:"textfield"}}],plugins:[Ext.create("Ext.grid.plugin.CellEditing",{listeners:{edit:{fn:a.onGridcelleditingpluginEdit,scope:a}}})],listeners:{select:{fn:a.onGridpanelSelect,scope:a}}}]},{xtype:"container",flex:1,items:[{xtype:"label",text:"Select a student"},{xtype:"operationOrderEditor",disabled:true},{xtype:"friendlyModeCheckbox",disabled:true}]}],listeners:{afterrender:{fn:a.onWindowAfterRender,scope:a}}});a.callParent(arguments)},onGridcelleditingpluginEdit:function(f,g,k){var h=g.record.data.id;var l=g.field;var m=false;var b={ItemName:h};if(l==="name"){b.DisplayableName=g.value}else{if(l==="username"){b.Username=g.value}else{if(l==="password"){if(g.value!=="(default password)"){b.Password=g.value}else{Ext.MessageBox.alert("Error","Cannot use '(default password)' as a password.");return}}else{Ext.MessageBox.alert("Error","Error editing student information.");return}}}if(!school_data.UseLogin&&!district_data.UseLogin){}else{if(b.Username===""){Ext.MessageBox.alert("Error","Username cannot be blank.");return}if(b.Password===""){Ext.MessageBox.alert("Error","Password cannot be blank.");return}}Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/games",params:b,success:function(e){var n=Ext.decode(e.responseText);if(n.success){Ext.Msg.alert("Success","Update successful.")}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}});if(l==="name"){var c;var d=Ext.getCmp("school_tree");var a=d.getSelectionModel().getSelection()[0];while(c=d.getRootNode().childNodes[0]){d.getRootNode().removeChild(c)}Ext.getStore("SchoolTreeStore").load({callback:function(){d.getSelectionModel().select(a)}});Ext.getStore("GameStore").load()}},onGridpanelSelect:function(e,b,c,d){var h=Ext.ComponentQuery.query("editStudentsWindow")[0];var f=h.down("operationOrderEditor");f.enable();f.setOrdering("student",b.data.id);var g=h.down("friendlyModeCheckbox");g.enable();window.fmc={};window.fmc.index="Student_Index";window.fmc.id=b.data.id;if(b.data.FriendlyMode){var a=g.down("checkbox");a.suspendEvent("change");a.setValue(true);a.resumeEvent("change")}else{var a=g.down("checkbox");a.suspendEvent("change");a.setValue(false);a.resumeEvent("change")}},onWindowAfterRender:function(a,b){if(!school_data.UseLogin&&!district_data.UseLogin){a.down("#username").hide();a.down("#lblInstructions").setText("Select the class you want to edit from the menu on the left. Double-click on a student's name or password to change it.");a.down("#lblPasswordInstructions").setText("If the password is blank, it will automatically be set to the default password.")}else{a.down("#username").show();a.down("#lblInstructions").setText("Select the class you want to edit from the menu on the left. Double-click on a student's name, username, or password to change it.");a.down("#lblPasswordInstructions").hide()}}});Ext.define("BigBrainzLauncher.view.StudentLoginViewport",{extend:"Ext.container.Viewport",requires:["BigBrainzLauncher.view.PlanoGamePanel","BigBrainzLauncher.view.GamePanel"],layout:{type:"fit"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",layout:{align:"stretch",type:"vbox"},items:[{xtype:"container",height:90,html:'<div id="banner">\r\n	<div id="banner-left"></div>\r\n    <div id="banner-content"></div>\r\n	<div id="banner-right"></div>\r\n</div>\r\n<div id="logo"></div>',maxHeight:90,minHeight:90,minWidth:200,width:200},{xtype:"container",layout:{align:"stretch",pack:"center",type:"vbox"},items:[{xtype:"planogamepanel",hidden:true,flex:1},{xtype:"gamepanel",flex:1}]}]},{xtype:"panel",hidden:true,id:"student_classes_details_panel",layout:{type:"fit"},items:[{xtype:"tabpanel",id:"student_view_details",activeTab:0,items:[{xtype:"panel",layout:{type:"fit"},title:"Multiplication",items:[{xtype:"container",id:"student_view_multiplication_container",autoScroll:true,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"chart",height:250,id:"student_view_multiplication_gauge",width:400,animate:true,insetPadding:20,store:"GameStore",axes:[{position:"gauge",type:"Gauge",margin:8,maximum:100,minimum:0}],series:[{type:"gauge",angleField:"multiplication_progress",donut:50}]},{xtype:"container",flex:1,id:"progress_table"},{xtype:"container",html:"<div id = 'play_multiplication'>  \r\n  <img src=\"images/Button_PlayMultiplication_150.png\" onmouseover=\"this.src='images/Button_PlayMultiplicationHover_150.png'\" onmouseout=\"this.src='images/Button_PlayMultiplication_150.png'\"/>\r\n</div>",style:"cursor: pointer;",listeners:{afterrender:{fn:a.onContainerAfterRender,scope:a}}}]}]},{xtype:"panel",layout:{type:"fit"},title:"Division",items:[{xtype:"container",id:"student_view_division_container",autoScroll:true,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"chart",height:250,id:"student_view_division_gauge",width:400,animate:true,insetPadding:20,store:"GameStore",axes:[{position:"gauge",type:"Gauge",margin:8,maximum:100,minimum:0}],series:[{type:"gauge",angleField:"Division_progress",donut:50}]},{xtype:"container",html:"<div id = 'play_division'>  \r\n  <img src=\"images/Button_PlayDivision_150.png\" onmouseover=\"this.src='images/Button_PlayDivisionHover_150.png'\" onmouseout=\"this.src='images/Button_PlayDivision_150.png'\"/>\r\n</div>",style:"cursor: pointer;",listeners:{afterrender:{fn:a.onContainerAfterRender1,scope:a}}}]}],listeners:{activate:{fn:a.onPanelActivate,scope:a}}},{xtype:"panel",layout:{type:"fit"},title:"Addition/Subtraction",items:[{xtype:"container",id:"student_view_addsub_container",autoScroll:true,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"chart",height:250,id:"student_view_addsub_gauge",width:400,animate:true,insetPadding:20,store:"GameStore",axes:[{position:"gauge",type:"Gauge",margin:8,maximum:100,minimum:0}],series:[{type:"gauge",angleField:"addsubtract_progress",donut:50}]},{xtype:"container",html:"<div id = 'play_addsub'>  \r\n  <img src=\"images/Button_PlayAddSub_150.png\" onmouseover=\"this.src='images/Button_PlayAddSubHover_150.png'\" onmouseout=\"this.src='images/Button_PlayAddSub_150.png'\"/>\r\n</div>",style:"cursor: pointer;",listeners:{afterrender:{fn:a.onContainerAfterRender11,scope:a}}}]}],listeners:{activate:{fn:a.onPanelActivate1,scope:a}}}]}],listeners:{afterlayout:{fn:a.onStudent_classes_details_panelAfterLayout,scope:a}}}]});a.callParent(arguments)},onContainerAfterRender:function(a,b){Ext.get("play_multiplication").on("click",function(c,d){window.location.href="play.php?appid=turbo&school_id="+school_data.id+"&id="+student_data.id})},onContainerAfterRender1:function(a,b){Ext.get("play_division").on("click",function(c,d){window.location.href="play.php?appid=division&school_id="+school_data.id+"&id="+student_data.id})},onPanelActivate:function(a,b){setTimeout(function(){Ext.getCmp("student_view_division_container").layout.layout()},100)},onContainerAfterRender11:function(a,b){Ext.get("play_addsub").on("click",function(c,d){window.location.href="play.php?appid=addsubtract&school_id="+school_data.id+"&id="+student_data.id})},onPanelActivate1:function(a,b){setTimeout(function(){Ext.getCmp("student_view_addsub_container").layout.layout()},100)},onStudent_classes_details_panelAfterLayout:function(a,c,b){setTimeout(function(){Ext.getCmp("student_view_multiplication_container").layout.layout()},100)}});Ext.define("BigBrainzLauncher.view.StudentViewport",{extend:"Ext.container.Viewport",requires:["BigBrainzLauncher.view.SchoolTree","BigBrainzLauncher.view.GamePanel"],itemId:"studentViewport",layout:{type:"fit"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",layout:{align:"stretch",type:"vbox"},items:[{xtype:"container",height:90,html:'<div id="banner">\r\n	<div id="banner-left"></div>\r\n    <div id="banner-content"></div>\r\n	<div id="banner-right"></div>\r\n</div>\r\n<div id="logo"></div>\r\n<div id="pizza"></div>',maxHeight:90,minHeight:90,minWidth:200,width:200},{xtype:"panel",flex:1,layout:{align:"stretch",type:"hbox"},title:"You are logged in as a student",items:[{xtype:"mytreepanel",flex:2},{xtype:"panel",flex:9,layout:{type:"fit"},dockedItems:[{xtype:"toolbar",dock:"top",height:35,itemId:"studentViewportMenu",items:[{xtype:"label",flex:1,margins:"1",id:"student_details_title",text:"Student Details"},{xtype:"tbspacer"},{xtype:"tbseparator"},{xtype:"button",handler:function(b,c){BigBrainzLauncher.getApplication().fireEvent("playMultiplication")},disabled:true,text:"Play Multiplication"},{xtype:"tbseparator"},{xtype:"button",handler:function(b,c){BigBrainzLauncher.getApplication().fireEvent("playDivision")},disabled:true,text:"Play Division"},{xtype:"tbseparator"},{xtype:"button",handler:function(b,c){BigBrainzLauncher.getApplication().fireEvent("playAddSubtract")},disabled:true,itemId:"addSubButton",text:"Play Addition/Subtraction"},{xtype:"tbseparator"},{xtype:"button",handler:function(b,c){BigBrainzLauncher.getApplication().fireEvent("playAddition")},disabled:true,itemId:"additionButton",text:"Play Addition"},{xtype:"tbseparator"},{xtype:"button",handler:function(b,c){BigBrainzLauncher.getApplication().fireEvent("playSubtraction")},disabled:true,itemId:"subtractionButton",text:"Play Subtraction"},{xtype:"tbseparator"}]}],items:[{xtype:"container",itemId:"gamesPanel",autoScroll:true,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"gamepanel",itemId:""}]}]}],listeners:{afterrender:{fn:a.onStudent_classes_panelAfterRender,scope:a}}}],listeners:{afterrender:{fn:a.onContainerAfterRender,scope:a}}}]});a.callParent(arguments)},onStudent_classes_panelAfterRender:function(a,b){},onContainerAfterRender:function(a,b){}});Ext.define("BigBrainzLauncher.view.EditSchoolPasswordsWindow",{extend:"Ext.window.Window",alias:"widget.editSchoolPasswordWindow",requires:["BigBrainzLauncher.view.FriendlyModeCheckbox","BigBrainzLauncher.view.OperationOrderEditor"],height:281,width:578,layout:{align:"stretch",pack:"center",type:"vbox"},closeAction:"hide",title:"Edit School Passwords",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",layout:{align:"stretch",type:"hbox"},items:[{xtype:"fieldcontainer",flex:1,margins:"10",height:120,width:400,fieldLabel:"Change Educator Password",labelAlign:"top",items:[{xtype:"container",items:[{xtype:"textfield",id:"old_password",width:212,fieldLabel:"Old Password",inputType:"password",maxLength:30}]},{xtype:"container",items:[{xtype:"textfield",id:"new_password",width:213,fieldLabel:"New Password",inputType:"password",minLength:6,minLengthText:"The minimum password length is {0}",regex:/[A-z0-9]{6,}/m,regexText:"The password can only contain numbers and letters."},{xtype:"textfield",id:"new_password_again",width:213,fieldLabel:"Reenter",inputType:"password",maxLengthText:"The maximum password length is {0}",minLength:6,minLengthText:"The minimum password length is {0}",regex:/[A-z0-9]{6,}/m,regexText:"The password can only contain numbers and letters."}]},{xtype:"container",items:[{xtype:"button",handler:function(b,d){var c=Ext.getCmp("old_password").value;Ext.Ajax.request({method:"POST",url:"routes/routes.php?url=/login",params:{id:school_data.id,password:c},success:function(e){var g=Ext.decode(e.responseText);if(g.success&&g.access=="educator"){var k=Ext.getCmp("new_password").value;var f=Ext.getCmp("new_password_again").value;if(k==f&&Ext.getCmp("new_password").validate()&&Ext.getCmp("new_password_again").validate()){Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/schools",params:{ItemName:school_data.id,Password:k},success:function(l){var m=Ext.decode(l.responseText);if(m.success){Ext.Msg.alert("Success","Your password has been updated.")}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})}else{var h=k==f?"The new password must be 6 - 30 characters and can only contain letters and numbers.":"The new password fields do not match.  Please try again.";Ext.Msg.alert(h)}}else{Ext.Msg.alert("Could not authenticate","Please check your password and try again.")}},failure:function(){Ext.Msg.alert("Could not authenticate","Please check your password and try again.")}})},text:"Change"}]}]},{xtype:"fieldcontainer",flex:1,margins:"10",height:120,width:400,fieldLabel:"Change Default Student Password",labelAlign:"top",items:[{xtype:"textfield",id:"default_student_password_field",validateOnChange:false,listeners:{afterrender:{fn:a.onDefault_student_password_fieldAfterRender,scope:a}}},{xtype:"button",handler:function(b,c){var d=Ext.getCmp("default_student_password_field").value;Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/schools",params:{ItemName:school_data.id,DefaultStudentPassword:d},success:function(e){var f=Ext.decode(e.responseText);if(f.success){Ext.Msg.alert("Success","The default password has been updated.")}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})},text:"Change"}]}]},{xtype:"container",flex:1,height:118,layout:{type:"hbox"},items:[{xtype:"container",flex:1,layout:{align:"stretch",type:"vbox"},items:[{xtype:"combobox",padding:"10px",width:213,fieldLabel:"Set School Level",store:["Elementary","Middle","High"],listeners:{change:{fn:a.onComboboxChange,scope:a}}},{xtype:"friendlyModeCheckbox",flex:1}]},{xtype:"operationOrderEditor",disabled:true,flex:1}]}],listeners:{afterrender:{fn:a.onWindowAfterRender,scope:a}}});a.callParent(arguments)},onDefault_student_password_fieldAfterRender:function(a,b){a.value=Ext.getStore("SchoolStore").data.items[0].data.DefaultStudentPassword},onComboboxChange:function(d,c,a,b){Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/schools",params:{ItemName:school_data.id,type:c},success:function(e){var f=Ext.decode(e.responseText);if(f.success){Ext.Msg.alert("Success","Your school type has been updated.")}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})},onWindowAfterRender:function(b,c){var f=b;var d=f.down("operationOrderEditor");d.enable();d.setOrdering("school",school_data.id);var e=f.down("friendlyModeCheckbox");e.enable();window.fmc={};window.fmc.index="School_Index";window.fmc.id=school_data.id;if(Ext.getStore("SchoolStore").data.items[0].data.FriendlyMode){var a=e.down("checkbox");a.suspendEvent("change");a.setValue(true);a.resumeEvent("change")}}});Ext.define("BigBrainzLauncher.view.CommonReportGraphs",{extend:"Ext.container.Container",alias:"widget.commonreportgraphs",requires:["BigBrainzLauncher.view.WeeklyUsageGraph","BigBrainzLauncher.view.DailyUsageChart","BigBrainzLauncher.view.AvgerageImprovementGraphs","BigBrainzLauncher.view.PretestGraph","BigBrainzLauncher.view.PosttestGraph","BigBrainzLauncher.view.FluencyTimeGraph"],minHeight:290,autoScroll:true,layout:{type:"table"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"WeeklyUsageGraph",height:271,minHeight:270,width:600},{xtype:"dailyusagechart",height:271,hidden:true},{xtype:"button",handler:function(b,c){if(Ext.ComponentQuery.query("#dailyUsageChart")[0].isVisible()){Ext.ComponentQuery.query("#dailyUsageChart")[0].hide();Ext.ComponentQuery.query("#usageChart")[0].show();b.setText("Show Last Month Usage")}else{Ext.ComponentQuery.query("#dailyUsageChart")[0].show();Ext.ComponentQuery.query("#usageChart")[0].hide();b.setText("Show School Year Usage")}},hidden:true,margin:"-180 0 0 -135",text:"Show Last 30 Days"},{xtype:"combobox",margin:"-100 0 0 -135",fieldLabel:"",value:"School Year Usage",allowBlank:false,editable:false,forceSelection:true,store:["School Year Usage","Last 30 Days Usage"],listeners:{select:{fn:a.onComboboxSelect,scope:a}}},{xtype:"avgerageimprovementgraphs",height:270,width:600},{xtype:"pretestgraph"},{xtype:"posttestgraph"},{xtype:"fluencytimegraph",height:270,hidden:true,width:400}]});a.callParent(arguments)},onComboboxSelect:function(c,a,b){if(c.value=="Last 30 Days Usage"){Ext.ComponentQuery.query("#dailyUsageChart")[0].show();Ext.ComponentQuery.query("#usageChart")[0].hide()}else{Ext.ComponentQuery.query("#dailyUsageChart")[0].hide();Ext.ComponentQuery.query("#usageChart")[0].show()}}});Ext.define("BigBrainzLauncher.view.EducatorTreeViewport",{extend:"Ext.container.Viewport",requires:["BigBrainzLauncher.view.SchoolTree","BigBrainzLauncher.view.CommonReportGraphs","BigBrainzLauncher.view.OverviewReportGrid","BigBrainzLauncher.view.ClassReportGrid","BigBrainzLauncher.view.StudentReportPage"],itemId:"educatorViewport",layout:{type:"fit"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",layout:{align:"stretch",type:"vbox"},items:[{xtype:"container",flex:1,layout:{align:"stretch",type:"vbox"},items:[{xtype:"toolbar",hidden:true,itemId:"educatorToolbar",style:"border: solid 1px #99BBE8; margin: 0;background-color:#D9E5F3;",ui:"footer",items:[{xtype:"button",itemId:"addClassesBtn",text:"Add Class(es)"},{xtype:"button",itemId:"addStudentsBtn",text:"Add Student(s)"},{xtype:"button",itemId:"importClassListBtn",text:"Import Student List"},{xtype:"button",text:"Delete",textAlign:"left",menu:{xtype:"menu",minWidth:200,plain:true,items:[{xtype:"menuitem",itemId:"deleteSelectedBtn",text:"Delete Selected"},{xtype:"menuitem",itemId:"openDeleteMultipleClassesWindownBtn",text:"Delete Multiple Classes"},{xtype:"menuitem",itemId:"openDeleteMultipleStudentsWindownBtn",text:"Delete Multiple Students"}]}},{xtype:"button",overflowText:"...",text:"Edit",textAlign:"left",menu:{xtype:"menu",hidden:true,minWidth:200,plain:true,items:[{xtype:"menuitem",itemId:"editSchoolPasswordsBtn",text:"Edit School Passwords"},{xtype:"menuitem",itemId:"editClassNamesBtn",text:"Edit Class Names"},{xtype:"menuitem",itemId:"editStudentNamesPasswordsBtn",text:"Edit Student Names/Passwords"},{xtype:"menuitem",text:"Automated Emails ..."},{xtype:"menucheckitem",itemId:"dragNDropStudentsOLD",text:"Enable Moving Students (Drag and Drop)"}]}},{xtype:"button",itemId:"backBtn",text:"Back"},{xtype:"button",itemId:"printBtn",text:"Print"},{xtype:"tbspacer",flex:1},{xtype:"combobox",itemId:"reportYearSelectorOld",fieldLabel:"Year",labelAlign:"right",allowBlank:false,editable:false,displayField:"field2",forceSelection:true,queryMode:"local",store:[["current","Current Year"],["2013_2014","2013-2014"],["2012_2013","2012-2013"],["alltime","All Time"]],valueField:"field1"}]},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"mytreepanel",autoScroll:true,flex:1},{xtype:"tabpanel",activate_tab:function(o,h){var n=o.down("tab");var m=n.next();var k=m.next();var c=k.next();var d=c.next();var g=d.next();var b=g.next();var f=b.next();k.deactivate();c.deactivate();d.deactivate();g.deactivate();b.deactivate();f.deactivate();m.deactivate();Ext.ComponentQuery.query("#usageChart")[0].down("label").setText("Weekly Usage");Ext.ComponentQuery.query("#usageChart")[0].down("chart").axes.items[1].setTitle("# of Students");Ext.ComponentQuery.query("#pretestChart")[0].down("chart").axes.items[1].setTitle("# of Students");Ext.ComponentQuery.query("#posttestChart")[0].down("chart").axes.items[1].setTitle("# of Students");Ext.ComponentQuery.query("#dailyUsageChart")[0].down("label").setText("Daily Usage");try{Ext.ComponentQuery.query("#dailyUsageChart")[0].down("chart").axes.items[1].setTitle("# of Students")}catch(l){}Ext.ComponentQuery.query("#partialLabel")[0].hide();Ext.ComponentQuery.query("#partialImage")[0].hide();Ext.ComponentQuery.query("#missedLabel")[0].setText("Missed");switch(h.title){case"Multiplication":if(Ext.getStore("SchoolStore").data.items[0].data.purchase_status===null||Ext.getStore("SchoolStore").data.items[0].data.purchase_status===undefined||Ext.getStore("SchoolStore").data.items[0].data.purchase_status.indexOf("TA12")<0){k.activate()}else{c.activate()}Ext.ComponentQuery.query("#partialLabel")[0].show();Ext.ComponentQuery.query("#partialImage")[0].show();break;case"Division":d.activate();break;case"Addition/Subtraction":g.activate();break;case"Addition":Ext.ComponentQuery.query("#missedLabel")[0].setText("Missed");b.activate();break;case"Subtraction":f.activate();break;case"Summary":Ext.ComponentQuery.query("#usageChart")[0].down("label").setText("Weekly Usage (All Operations)");Ext.ComponentQuery.query("#usageChart")[0].down("chart").axes.items[1].setTitle("# of Operations");Ext.ComponentQuery.query("#pretestChart")[0].down("chart").axes.items[1].setTitle("# of Operations");Ext.ComponentQuery.query("#posttestChart")[0].down("chart").axes.items[1].setTitle("# of Operations");Ext.ComponentQuery.query("#dailyUsageChart")[0].down("label").setText("Daily Usage (All Operations)");try{Ext.ComponentQuery.query("#dailyUsageChart")[0].down("chart").axes.items[1].setTitle("# of Operations")}catch(l){}m.activate();break}},active_app_id:function(){var l=this.down("tab");var k=l.next();var g=k.next();var b=g.next();var d=b.next();var f=d.next();var c=f.next();var e=c.next();var h="all";if(g.active){h="ta9"}else{if(b.active){h="mult"}else{if(d.active){h="division"}else{if(f.active){h="addsub"}else{if(c.active){h="addition"}else{if(e.active){h="subtraction"}else{if(k.active){h="all"}}}}}}}return h},tbar:{tbar:[{xtype:"button",text:"Button 1"}]},flex:6,itemId:"schoolReportTabs",activeTab:0,items:[{xtype:"panel",cls:"",layout:{type:"border"},collapsible:true,header:false,title:"Reports",tabConfig:{xtype:"tab",hidden:true},items:[{xtype:"panel",region:"north",itemId:"summaryGraphs",layout:{align:"stretch",type:"hbox"},collapsible:true,title:"Summary Graphs",items:[{xtype:"commonreportgraphs",itemId:"commonReports",flex:1},{xtype:"container",html:"<div id = 'logos-container' style = 'width:99px;margin: 20px auto 0px auto;'>\r\n	<img style=\"height: 40px;\" src=\"images/BigBrainz.png\">\r\n</div>\r\n<div style = 'text-align: center;padding-top: 31px;'>\r\n	<p style = 'margin:0px;text-decoration: underline;'>Operations Played More than 1 Hour</p>\r\n	<p style=\"margin:0px;\"># of Operations: <span id = 'total_students'>896</span></p>\r\n	<p style=\"margin:0px;\">Average Improvement Overall: <span id = 'average_improvement'>58%</span></p>\r\n	<!--<p >Average Improvement [Multiplication^] [Grade]: 73%</p>-->\r\n	<p style=\"margin:12px 0px 0px 0px;\">Total Instructional Hours: <span id = 'instructional_hours'>4,364</span></p>\r\n	<p style=\"margin:0px;\">Average Pre-Test Score: <span id = 'avg_pretest_scores'>96%</span></p>\r\n	<p style=\"margin:0px;\">Average Post-Test Score: <span id = 'avg_posttest_scores'>96%</span></p>\r\n	<p style = 'margin:12px 0px 0px 0px;color:red;' id = 'expirationMessage'>Subscription not found. To upgrade or pilot please contact Quincie Weight at <a href='mailto:quincie.weight@imaginelearning.com'>quincie.weight@imaginelearning.com</a> or call her at (801) 616-4422.<p>\r\n</div>",minHeight:290,style:"background-color: #cbdbef;",width:400,layout:{align:"center",type:"vbox"}}]},{xtype:"panel",flex:1,region:"center",layout:{type:"fit"},header:false,items:[{xtype:"overviewreportgrid",height:150,itemId:"schoolReportGrid"},{xtype:"classreportgrid2",hidden:true,width:150},{xtype:"studentreportpage",width:150}]}]},{xtype:"panel",itemId:"combinedTab",iconCls:"all-icon",title:"Summary"},{xtype:"panel",itemId:"ta9Tab",iconCls:"mult-icon",title:"Multiplication"},{xtype:"panel",hidden:true,itemId:"ta12Tab",iconCls:"mult-icon",title:"Multiplication"},{xtype:"panel",iconCls:"div-icon",title:"Division"},{xtype:"panel",itemId:"addSubTab",iconCls:"addsub-icon",title:"Addition/Subtraction"},{xtype:"panel",hidden:true,itemId:"additionTab",iconCls:"add-icon",title:"Addition"},{xtype:"panel",hidden:true,itemId:"subtractionTab",iconCls:"sub-icon",title:"Subtraction"}],listeners:{afterrender:{fn:a.onSchoolReportTabsAfterRender,scope:a}}}]}]}]}]});a.callParent(arguments)},onSchoolReportTabsAfterRender:function(a,c){var b=new Array("Current Year","Last Year");var f=a.tabBar;var h="BB02691691445231259433720081208183020372969";if(district_data.id!=h){f.insert(8,g());var e=Ext.getStore("SchoolStore").getById(school_data.id).data.il_school;Ext.get("logos-container").dom.style.width="99px"}else{f.insert(8,d())}function d(){return[{xtype:"tbspacer",flex:1},{xtype:"button",itemId:"printBtn",text:"Print"},{xtype:"combobox",itemId:"reportYearSelector",fieldLabel:"Year",labelAlign:"right",labelWidth:50,value:"current",allowBlank:false,editable:false,forceSelection:true,queryMode:"local",store:[["current","CurrentYear"],["2016_2017","2016-2017"],["2015_2016","2015-2016"],["2014_2015","2014-2015"],["2013_2014","2013-2014"],["2012_2013","2012-2013"],["alltime","AllTime"]],getTimestamps:function(){var o=[];var n=Ext.ComponentQuery.query("#reportYearSelector")[0].value;if(n=="current"){var k=new Date();var m=k.getFullYear();if(new Date().getMonth()<7){m-=1}o[0]=Math.ceil(new Date(m,6,1).getTime()/1000);o[1]=Math.ceil(new Date(m+1,7,1).getTime()/1000)}else{if(n=="alltime"){o[0]=0;o[1]=2147485547}else{var l=n.split("_");o[0]=Math.ceil(new Date(l[0],7,1).getTime()/1000);o[1]=Math.ceil(new Date(l[1],7,1).getTime()/1000)}}return o}}]}function g(){return[{xtype:"component",width:30},{xtype:"button",itemId:"addClassesBtn",text:"AddClass(es)"},{xtype:"button",itemId:"addStudentsBtn",text:"AddStudent(s)",style:"margin: 0px 0px 0px 10px;"},{xtype:"button",itemId:"importClassListBtn",text:"ImportStudentList",style:"margin: 0px 0px 0px 10px;"},{xtype:"button",text:"Delete",textAlign:"left",style:"margin: 0px 0px 0px 10px;",menu:{xtype:"menu",minWidth:200,plain:true,items:[{xtype:"menuitem",itemId:"deleteSelectedBtn",text:"DeleteSelected"},{xtype:"menuitem",itemId:"openDeleteMultipleClassesWindownBtn",text:"DeleteMultipleClasses"},{xtype:"menuitem",itemId:"openDeleteMultipleStudentsWindownBtn",text:"DeleteMultipleStudents"}]}},{xtype:"button",overflowText:"...",text:"Edit",textAlign:"left",style:"margin: 0px 0px 0px 10px",menu:{xtype:"menu",hidden:true,minWidth:200,plain:true,items:[{xtype:"menuitem",itemId:"editSchoolPasswordsBtn",text:"Edit School ..."},{xtype:"menuitem",itemId:"editClassNamesBtn",text:"Edit Classes ..."},{xtype:"menuitem",itemId:"editStudentNamesPasswordsBtn",text:"Edit Student ..."},{xtype:"menucheckitem",itemId:"dragNDropStudents",text:"Enable Moving Students(DragandDrop)"},{xtype:"menuitem",itemId:"setSchoolYearMltBtn",text:"Set school year for multiple classes..."},{xtype:"combobox",itemId:"editDateCreated",emptyText:"Set year...",store:b},]}},{xtype:"button",itemId:"backBtn",style:"margin: 0px 0px 0px 10px",text:"Back"},{xtype:"button",itemId:"printBtn",style:"margin: 0px 0px 0px 10px",text:"Print"},{xtype:"tbspacer",flex:1},{xtype:"combobox",itemId:"reportYearSelector",fieldLabel:"Year",labelAlign:"right",value:"current",allowBlank:false,editable:false,forceSelection:true,queryMode:"local",store:[["current","CurrentYear"],["2016_2017","2016-2017"],["2015_2016","2015-2016"],["2014_2015","2014-2015"],["2013_2014","2013-2014"],["2012_2013","2012-2013"],["alltime","AllTime"]],getTimestamps:function(){var o=[];var n=Ext.ComponentQuery.query("#reportYearSelector")[0].value;if(n=="current"){var k=new Date();var m=k.getFullYear();if(new Date().getMonth()<7){m-=1}o[0]=Math.ceil(new Date(m,6,1).getTime()/1000);o[1]=Math.ceil(new Date(m+1,7,1).getTime()/1000)}else{if(n=="alltime"){o[0]=0;o[1]=2147485547}else{var l=n.split("_");o[0]=Math.ceil(new Date(l[0],7,1).getTime()/1000);o[1]=Math.ceil(new Date(l[1],7,1).getTime()/1000)}}return o}}]}}});Ext.define("BigBrainzLauncher.view.EditClassesWindow",{extend:"Ext.window.Window",alias:"widget.editClassesWindow",requires:["BigBrainzLauncher.view.OperationOrderEditor","BigBrainzLauncher.view.FriendlyModeCheckbox"],height:500,width:712,autoScroll:true,layout:{align:"stretch",type:"hbox"},closeAction:"hide",title:"Edit Class' Name",modal:true,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",flex:1,layout:{align:"stretch",type:"vbox"},items:[{xtype:"displayfield",padding:10,width:674,fieldLabel:"Note",hideLabel:true,value:"Double-click on a class' name to change it."},{xtype:"gridpanel",flex:1,itemId:"editClassesGrid",margin:10,header:false,title:"Edit Individual Classes",store:"ClassStore",columns:[{xtype:"gridcolumn",dataIndex:"name",text:"Name",flex:1,editor:{xtype:"textfield"}},{xtype:"gridcolumn",renderer:function(g,d,c,h,f,e,b){if(g=="0"){return"K"}if(g=="8"){return"8+"}if(g=="9"){return"Pre-K"}return g},dataIndex:"grade",text:"Grade",editor:{xtype:"combobox",displayField:"display",store:["Pre-K","K","1","2","3","4","5","6","7","8+"],valueField:"value"}}],plugins:[Ext.create("Ext.grid.plugin.CellEditing",{listeners:{edit:{fn:a.onGridcelleditingpluginEdit,scope:a}}})],listeners:{select:{fn:a.onEditClassesGridSelect,scope:a}}}]},{xtype:"container",flex:1,items:[{xtype:"label",text:"Select a class"},{xtype:"operationOrderEditor",disabled:true},{xtype:"friendlyModeCheckbox",disabled:true}]}]});a.callParent(arguments)},onGridcelleditingpluginEdit:function(b,f,a){var c=f.record.data.id;var d=f.field;var g={ItemName:c};if(d==="name"){g.DisplayableName=f.value}else{g.grade=f.value;if(f.value=="Pre-K"){g.grade=9}else{if(f.value=="K"){g.grade=0}else{if(f.value=="8+"){g.grade=8}}}}Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/classes",params:g,success:function(h){var k=Ext.decode(h.responseText);if(k.success){Ext.Msg.alert("Success","Update successful.");var l;var e=Ext.ComponentQuery.query("#schoolTree")[0];while(l=e.getRootNode().childNodes[0]){e.getRootNode().removeChild(l)}setTimeout(function(){Ext.getStore("ClassStore").load();Ext.getStore("SchoolTreeStore").load();e.getSelectionModel().deselectAll(true);e.selectPath("/0")},750)}else{Ext.Msg.alert("Could not update.","Please try again.")}},failure:function(){Ext.Msg.alert("Could not update.","Please try again.")}})},onEditClassesGridSelect:function(e,b,c,d){var h=Ext.ComponentQuery.query("editClassesWindow")[0];var f=h.down("operationOrderEditor");f.enable();f.setOrdering("class",b.data.id);var g=h.down("friendlyModeCheckbox");g.enable();window.fmc={};window.fmc.index="Class_Index";window.fmc.id=b.data.id;if(b.data.FriendlyMode){var a=g.down("checkbox");a.suspendEvent("change");a.setValue(true);a.resumeEvent("change")}else{var a=g.down("checkbox");a.suspendEvent("change");a.setValue(false);a.resumeEvent("change")}}});Ext.define("BigBrainzLauncher.view.AggregatedReportPanel",{extend:"Ext.panel.Panel",alias:"widget.aggregatedreportpanel",requires:["BigBrainzLauncher.view.CommonReportGraphs","BigBrainzLauncher.view.OverviewReportGrid","BigBrainzLauncher.view.ClassReportGrid"],layout:{align:"stretch",type:"hbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"treepanel",flex:1,itemId:"districtTree",store:"DistrictTreeStore",viewConfig:{}},{xtype:"tabpanel",load_test_scores:function(){var c=this.down("tab");var b="ta9";if(c.next().next().active){b="mult"}else{if(c.next().next().next().active){b="division"}else{if(c.next().next().next().next().active){b="addsub"}}}Ext.getStore("PretestChartStore").loadRawData(pretest_data.data[b]);Ext.getStore("PosttestChartStore").loadRawData(posttest_data.data[b])},load_weekly_progress:function(){var c=this.down("tab");var b=Ext.decode(report_data.data.ta9);if(c.next().next().active){b=Ext.decode(report_data.data.mult)}else{if(c.next().next().next().active){b=Ext.decode(report_data.data.division)}else{if(c.next().next().next().next().active){b=Ext.decode(report_data.data.addsub)}}}Ext.getStore("WeeklyProgressStore").loadRawData(b)},load_grid_progress:function(f){var e="Loading.  Please wait...";if(Ext.ieVersion<9&&Ext.ieVersion>0){e="You are using an older version of Internet Explorer.  This may take longer to load.  Please wait."}var d=this.down("tab");var b=report_grid_data.data.ta9;var c="ta9";if(d.next().next().active){b=report_grid_data.data.mult;c="mult"}else{if(d.next().next().next().active){b=report_grid_data.data.division;c="division"}else{if(d.next().next().next().next().active){b=report_grid_data.data.addsub;c="addsub"}}}Ext.getStore("DistrictReportStore").loadRawData(b)},load_improvement_chart:function(){var b=this.down("tab");var c=avg_improvement.data.ta9;if(b.next().next().active){c=avg_improvement.data.mult}else{if(b.next().next().next().active){c=avg_improvement.data.division}else{if(b.next().next().next().next().active){c=avg_improvement.data.addsub}}}Ext.getStore("AverageImprovementStore").loadRawData(c)},load_template_data:function(){var f={};var e=[];var b=0;var h=0;var d=Ext.getStore("DistrictReportStore").data.length;for(i=0;i<d;i++){b=Math.max(b,Ext.getStore("DistrictReportStore").data.items[i].data.total_hours);h=Math.max(h,Ext.getStore("DistrictReportStore").data.items[i].data.posttest_taken);var g=[];for(j=90;j>=10;j-=10){if(j===90){g.push(Ext.getStore("DistrictReportStore").data.items[i].data["_"+j])}else{g.push(Ext.getStore("DistrictReportStore").data.items[i].data["_"+j]-Ext.getStore("DistrictReportStore").data.items[i].data["_"+(j+10)])}}var c=Ext.getStore("DistrictReportStore").data.items[i].data.not_playing;c=Math.min(c,Ext.getStore("DistrictReportStore").data.items[i].data.pretest_taken);e.push({name:Ext.getStore("DistrictReportStore").data.items[i].data.name,hours:parseInt(Ext.getStore("DistrictReportStore").data.items[i].data.total_hours,10),avg_hours:parseInt(Ext.getStore("DistrictReportStore").data.items[i].data.total_hours,10)/Ext.getStore("DistrictReportStore").data.items[i].data.pretest_taken,pretest_taken:Ext.getStore("DistrictReportStore").data.items[i].data.pretest_taken,fluent:Ext.getStore("DistrictReportStore").data.items[i].data.posttest_taken,usage:1,fluency:Ext.encode(g.reverse()),school_id:Ext.getStore("DistrictReportStore").data.items[i].data.id,not_playing:c})}f.max_total_hours=b;f.max_student_fluent=h;f.rows=e;return f},load_fluency_time_chart:function(){var d=this.up("viewport").fluency_data;var c=this.down("tab");var b="merged_ta9_ta12";if(c.next().next().active){b="mult"}else{if(c.next().next().next().active){b="division"}else{if(c.next().next().next().next().active){b="addsub"}}}Ext.getStore("FluencyTimeStore").loadRawData(d[b])},activate_tab:function(g,l){var m=this.down("tab");var h=m.next();var f=h.next();var k=f.next();var c=k.next();var d=c.next();var b=d.next();var e=b.next();h.deactivate();f.deactivate();k.deactivate();c.deactivate();d.deactivate();b.deactivate();e.deactivate();Ext.ComponentQuery.query("#usageChart")[0].down("label").setText("Weekly Usage");Ext.ComponentQuery.query("#usageChart")[0].down("chart").axes.items[1].setTitle("# of Students");Ext.ComponentQuery.query("#pretestChart")[0].down("chart").axes.items[1].setTitle("# of Students");Ext.ComponentQuery.query("#posttestChart")[0].down("chart").axes.items[1].setTitle("# of Students");switch(l.title){case"Multiplication":f.activate();break;case"Multiplication(12's)":k.activate();break;case"Division":c.activate();break;case"Addition/Subtraction":d.activate();break;case"Addition":b.activate();break;case"Subtraction":e.activate();break;case"Summary":Ext.ComponentQuery.query("#usageChart")[0].down("label").setText("Weekly Usage (All Operations)");Ext.ComponentQuery.query("#usageChart")[0].down("chart").axes.items[1].setTitle("# of Operations");Ext.ComponentQuery.query("#pretestChart")[0].down("chart").axes.items[1].setTitle("# of Operations");Ext.ComponentQuery.query("#posttestChart")[0].down("chart").axes.items[1].setTitle("# of Operations");h.activate();break}},active_app_id:function(){var l=this.down("tab");var h=l.next();var f=h.next();var k=f.next();var c=k.next();var d=c.next();var b=d.next();var e=b.next();var g="all";if(f.active){g="ta9"}else{if(k.active){g="mult"}else{if(c.active){g="division"}else{if(d.active){g="addsub"}else{if(b.active){g="addition"}else{if(e.active){g="subtraction"}}}}}}return g},flex:6,id:"report_tabs1",itemId:"schoolReportTabs",activeTab:0,items:[{xtype:"panel",layout:{type:"border"},title:"Reports",tabConfig:{xtype:"tab",hidden:true},items:[{xtype:"panel",region:"north",height:290,itemId:"summaryGraphs",minHeight:340,autoScroll:true,collapsible:true,title:"Summary Graphs",items:[{xtype:"commonreportgraphs",itemId:"commonReports"}]},{xtype:"panel",flex:1,region:"center",layout:{align:"stretch",pack:"center",type:"vbox"},header:false,title:"My Panel",items:[{xtype:"overviewreportgrid",itemId:"overviewReportGrid",flex:1},{xtype:"classreportgrid2",hidden:true,flex:1}]},{xtype:"container",filter:function(){Ext.getStore("DistrictReportStore").clearFilter(true);var b=[];if(Ext.getCmp("chk_elem").getValue()){b.push("Elementary|El")}if(Ext.getCmp("chk_middle").getValue()){b.push("Middle|Junior")}if(Ext.getCmp("chk_high").getValue()){b.push("High")}var f=b.join("|");var e=new RegExp(f,"i");Ext.getStore("DistrictReportStore").filter("name",e);var c=[];if(Ext.getCmp("chk_paid").getValue()){c.push("paid")}if(Ext.getCmp("chk_free").getValue()){c.push("free")}var d=c.join("|");var g=new RegExp(d,"i");Ext.getStore("DistrictReportStore").filter("purchase_status",g);Ext.getCmp("template_test").update(Ext.getCmp("report_tabs").load_template_data())},flex:0,region:"east",hidden:true,width:150,layout:{align:"middle",pack:"center",type:"hbox"},items:[{xtype:"button",handler:function(b,c){Ext.getCmp("chk_elem").setRawValue(0);Ext.getCmp("chk_middle").setRawValue(0);Ext.getCmp("chk_high").setRawValue(0);Ext.getCmp("chk_paid").setRawValue(0);Ext.getCmp("chk_free").setRawValue(0);Ext.getStore("DistrictReportStore").clearFilter();Ext.getCmp("template_test").update(Ext.getCmp("report_tabs").load_template_data())},text:"Show All"},{xtype:"checkboxgroup",border:1,padding:"0 0 0 5",width:300,fieldLabel:"",items:[{xtype:"checkboxfield",handler:function(c,b){this.up().up().filter()},id:"chk_elem",boxLabel:"Elementary"},{xtype:"checkboxfield",handler:function(c,b){this.up().up().filter()},id:"chk_middle",boxLabel:"Middle"},{xtype:"checkboxfield",handler:function(c,b){this.up().up().filter()},id:"chk_high",fieldLabel:"",boxLabel:"High"}]},{xtype:"checkboxgroup",border:1,width:200,fieldLabel:"",items:[{xtype:"checkboxfield",handler:function(c,b){this.up().up().filter()},id:"chk_free",labelWidth:50,boxLabel:"Free"},{xtype:"checkboxfield",handler:function(c,b){this.up().up().filter()},id:"chk_paid",labelWidth:50,boxLabel:"Paid"}]}]},{xtype:"container",flex:1,region:"north",height:150,hidden:true,id:"district_reports_graphs",minHeight:300,autoScroll:true,items:[{xtype:"container",layout:{type:"fit"},items:[{xtype:"progressbar",animate:true}]},{xtype:"container",update_charts:function(d,l,f){var h=d.rows.length;b(0,h);function b(o,n){var p=d.rows[o].school_id;m(o,p);c(o,p);g(o,p);e(o,p);k(o,p);if(o+1<n){setTimeout(function(){b(o+1,n)},10)}else{if(l){l.hide()}}}function m(p,s){var o=Ext.getCmp("template_test").tpl.fluency_chart_ids;var r=Ext.decode(d.rows[p].fluency);var q=Ext.getCmp(o[s]);var n=q.store;n.loadRawData([{progress:"10%",number_of_students:r[0]},{progress:"20%",number_of_students:r[1]},{progress:"30%",number_of_students:r[2]},{progress:"40%",number_of_students:r[3]},{progress:"50%",number_of_students:r[4]},{progress:"60%",number_of_students:r[5]},{progress:"70%",number_of_students:r[6]},{progress:"80%",number_of_students:r[7]},{progress:"90%",number_of_students:r[8]}]);q.redraw()}function c(r,u){var n=0;Ext.getStore("DistrictReportStore").each(function(v){n=Math.max(n,v.get("total_hours"))});var o=Ext.getCmp("template_test").tpl.total_chart_ids;var q=Ext.decode(d.rows[r].hours);n=Math.max(1,n);var t=Math.min(Math.ceil(q*100/n),100);var s=Ext.getCmp(o[u]);var p=s.store;p.loadRawData([{school:"school",hours:q,percent:t}]);s.redraw()}function g(p,s){var r=Ext.getCmp("template_test").tpl.avg_hours_chart_ids;var o=Ext.decode(d.rows[p].avg_hours);var q=Ext.getCmp(r[s]);var n=q.store;n.loadRawData([{school:"school",hours:o}]);q.redraw()}function e(o,q){var p=Ext.getCmp("template_test").tpl.fluent_chart_ids;try{var n=Ext.getStore("DistrictReportStore").data.items[Ext.getStore("DistrictReportStore").find("id",q)].data.posttest_taken;var u=Ext.getStore("DistrictReportStore").data.items[Ext.getStore("DistrictReportStore").find("id",q)].data.pretest_taken;u=Math.max(1,u);var r=Math.min(Math.ceil(n*100/u),100);var s=Ext.getCmp(p[q]);var v=s.store;v.loadRawData([{school:"school",fluent:n,fluent_percent:r}]);s.redraw()}catch(t){}}function k(o,p){try{var n=Ext.getCmp("template_test").tpl.usage_chart_ids;var q=Ext.getCmp("template_test").tpl.usage_data[p];var s=Ext.getCmp(n[p]);var x=s.store;var u=[{p:0,np:0,dnp:0,f:0,date:""}];if(q[f]!==""){u=Ext.decode(q[f]).slice(Math.max(0,u.length-12))}x.loadRawData(u);s.redraw();var z=Ext.getStore("DistrictReportStore").data.items[Ext.getStore("DistrictReportStore").find("id",p)].data.not_playing;var w=Ext.getStore("DistrictReportStore").data.items[Ext.getStore("DistrictReportStore").find("id",p)].data.pretest_taken;w=Math.max(1,w);var r=Math.min(Math.ceil(z*100/w),100);var v=Ext.getCmp(Ext.getCmp("template_test").tpl.not_fluent_chart_ids[p]);var y=v.store;y.loadRawData([{school:"school",not_fluent:z,not_fluent_percent:r}]);v.redraw()}catch(t){}}},id:"template_test",tpl:Ext.create("Ext.XTemplate","<table style=\"width:100%;\" id='schoolTable'>","  <tr style='position:fixed;background:#111;color:#fff;'>",'    <td style="text-align:center;" onclick="Ext.getCmp(\'template_test\').tpl.sort_name();">School</td>','    <td style="text-align:center;" onclick="Ext.getCmp(\'template_test\').tpl.sort_total_hours();">Total<br />Hours</td>    ','    <td style="text-align:center;" onclick="Ext.getCmp(\'template_test\').tpl.sort_avg_hours();">Avg<br />Hours</td>    ','    <td style="text-align:center;" onclick="Ext.getCmp(\'template_test\').tpl.sort_fluents();">Students<br />Fluent</td>','    <td style="text-align:center;">Usage</td>','    <td style="text-align:center;">Current Fluency<image width="16" height="16" data-qtip="Each bar represents the number of students that currently have the indicated fluency, in other words, hovering over the bar at 50% will tell you how many students are currently at 50% fluency." src = \'images/icon-question.gif\' /></td>','    <td style="text-align:center;">Students<br />Not Progressing<image width="16" height="16" data-qtip="Students Not Progressing in the last 4 weeksâ€? with the help bubble: â€œThese are students that took a pre-test, but havenâ€™t played the game at any point in the last 4 weeks." src = \'images/icon-question.gif\' /></td>',"  </tr>",'  <tr><td style="height:40px;">&nbsp;</td></tr>','  <tpl for="rows">','    <tr id = "{[Ext.id()]}" style = "background-color:{[xindex % 2 === 0 ? "Gainsboro" : "white"]};">',"      <td style=\"text-align:center;font-size:150%;\"><a href=\"javascript:void(0)\" onclick=\"Ext.getCmp('template_test').tpl.log_in_as_educator('{school_id}','{name}');return false;\">{name}</a></td>",'      <td style="text-align:center;">{[this.add_total_hours_data(parent.max_total_hours,values.hours, values.school_id)]}</td>      ','      <td style="text-align:center;">{[this.add_avg_hours_data(values.avg_hours, values.school_id)]}</td>      ','      <td style="text-align:center;">{[this.add_fluent_data(parent.max_student_fluent,values.fluent, values.school_id)]}</td>      ','      <td style="text-align:center;">{[this.display_usage(values.school_id)]}</td>','      <td style="text-align:center;">{[this.add_fluency_data(values.fluency, values.school_id)]}</td>','      <td style="text-align:center;">{[this.add_not_fluent_data(values.pretest_taken,values.not_playing, values.school_id)]}</td>',"    </tr>","  </tpl>","</table>","{[this.get_usage_data()]}","","",{add_total_hours_data:function(b,c,d){if(this.total_hours_school_id_data===undefined){this.total_hours_school_id_data={}}var e=Ext.id();this.total_hours_school_id_data[d]={};this.total_hours_school_id_data[d].max=b;this.total_hours_school_id_data[d].hours=c;this.total_hours_school_id_data[d].div_id=e;return'<div id="'+e+'"></div>'},add_not_fluent_data:function(c,b,d){if(this.not_fluent_data===undefined){this.not_fluent_data={}}var e=Ext.id();b=Math.min(c,b);this.not_fluent_data[d]={};this.not_fluent_data[d].max=c+1;this.not_fluent_data[d].not_fluent=b;this.not_fluent_data[d].div_id=e;return'<div id="'+e+'"></div>'},add_fluent_data:function(b,c,d){if(this.fluent_data===undefined){this.fluent_data={}}var e=Ext.id();this.fluent_data[d]={};this.fluent_data[d].max=b;this.fluent_data[d].fluent=c;this.fluent_data[d].div_id=e;return'<div id="'+e+'"></div>'},display_usage:function(b){if(this.usage_graph_data===undefined){this.usage_graph_data=[]}var c=Ext.id();this.usage_graph_data.push({div_id:c,school_id:b});return'<div id="'+c+'"></div>'},get_usage_data:function(){var l=this.fluent_chart_ids;var r=this.fluency_school_id_data;var t=this.total_hours_school_id_data;var n=this.avg_hours_school_id_data;var k=this.fluent_data;var o=this.not_fluent_data;var w=Ext.ComponentQuery.query("viewport")[0].down("progressbar");var x=this;var d=false;var p=0;var m=this.usage_graph_data.length;q(this.usage_graph_data,function(y){w.hide()});if(this.usage_data===undefined){this.usage_data={}}var v=this.usage_data;var u=this.fluency_data;function q(z,B){var A=[];y(z);function y(D){if(D.length){var C=D.shift();w.updateProgress(p/m,p+" out of "+m+" schools loaded.");p++;Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/schools/"+C.school_id+"/weekly_progress",callback:function(){h(r[C.school_id].div_id,r[C.school_id].data,C.school_id);s(t[C.school_id].div_id,t[C.school_id].max,t[C.school_id].hours,C.school_id);b(n[C.school_id].div_id,n[C.school_id].hours,C.school_id);g(k[C.school_id].div_id,k[C.school_id].max,k[C.school_id].fluent,C.school_id)},success:function(E){try{var I=Ext.decode(E.responseText);v[C.school_id]=I;var G=Ext.decode(I.ta9);c(C.div_id,G,C.school_id);var J=0;if(G.length>0){J=G[G.length-1]}var F=o[C.school_id].not_fluent;f(o[C.school_id].div_id,o[C.school_id].max,F,C.school_id)}catch(H){A.push(C)}y(D)},failure:function(){A.push(C);y(D)}})}else{if(!d){e();d=true}B(A)}}}if(this.usage_chart_ids===undefined){this.usage_chart_ids={}}function c(B,z,A){var y=Ext.create("Ext.data.JsonStore",{fields:["date","f","p","np"]});y.loadRawData(z);Ext.defer(function(){try{var C=Ext.create("Ext.chart.Chart",{listeners:{refresh:{fn:function(F,E){F.axes.items[0].label.date_seen=[];F.axes.items[0].label.month_seen=[]}}},xtype:"chart",animate:true,width:400,height:225,insetPadding:20,store:y,theme:"Fancy",renderTo:B,axes:[{type:"Category",fields:["date"],position:"bottom",title:"",label:{renderer:function(E){if(E===undefined){return""}if(this.date_seen===undefined){this.date_seen=[]}if(this.month_seen===undefined){this.month_seen=[]}monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var F=E.split("/");return monthNames[F[1]-1]+" "+F[2]}}},{type:"Numeric",fields:["f","p","np"],position:"left",title:"# of Students",decimals:0,minimum:0,maximum:200}],legend:{position:"float",x:90,y:-15},series:[{type:"area",highlight:true,tips:{trackMouse:true,width:175,height:42,renderer:function(J,I){var H=["January","February","March","April","May","June","July","August","September","October","November","December"];var F=I.storeField;if(J.data===undefined){return}var K=J.data[F];var E="students";if(K===1){E="student"}var G=J.data.date;G=G.split("/");G=H[G[1]-1]+" "+G[2];var L="";switch(F){case"f":L=K+" "+E+" finished by "+G;break;case"p":L=K+" "+E+" progressing on "+G;break;case"np":L=K+" "+E+" playing but not progressing on "+G;break}this.setTitle(L)}},title:["Fluent","Progressing > 20 min.wk","Not Progressing < 20 min.wk"],xField:"date",yField:["f","p","np"]}]});x.usage_chart_ids[A]=C.id}catch(D){}},50)}if(this.fluency_chart_ids===undefined){this.fluency_chart_ids={}}function h(D,B,C){try{var y=Ext.create("Ext.data.JsonStore",{fields:["progress","number_of_students"],data:[{progress:"10%",number_of_students:B[0]},{progress:"20%",number_of_students:B[1]},{progress:"30%",number_of_students:B[2]},{progress:"40%",number_of_students:B[3]},{progress:"50%",number_of_students:B[4]},{progress:"60%",number_of_students:B[5]},{progress:"70%",number_of_students:B[6]},{progress:"80%",number_of_students:B[7]},{progress:"90%",number_of_students:B[8]}]});var z=Ext.create("Ext.chart.Chart",{xtype:"chart",animate:true,shadow:true,store:y,renderTo:D,width:400,height:225,axes:[{type:"Numeric",position:"left",fields:["number_of_students"],title:"Number of Students",grid:true,minimum:0,maximum:100},{type:"Category",position:"bottom",fields:["progress"],label:{rotate:{degrees:270}}}],series:[{type:"column",axis:"left",gutter:80,xField:"name",yField:["number_of_students"],renderer:function(I,F,E,H,G){if(H===6||H===7){return Ext.apply(E,{fill:"#FFFF00"})}if(H===8){return Ext.apply(E,{fill:"#66CC00"})}return Ext.apply(E,{fill:"#FF0000"})},tips:{trackMouse:true,width:120,height:55,renderer:function(F,E){this.setTitle(F.get("progress"));this.update(Ext.util.Format.plural(F.get("number_of_students"),"student","students"))}}}]});x.fluency_chart_ids[C]=z.id}catch(A){}}if(this.total_chart_ids===undefined){this.total_chart_ids={}}function s(F,y,z,E){try{y=Math.max(1,y);var D=Math.min(Math.ceil(z*100/y),100);var A=Ext.create("Ext.data.JsonStore",{fields:["school","hours","percent"],data:[{school:"school",hours:z,percent:D}]});var B=Ext.create("Ext.chart.Chart",{xtype:"chart",animate:true,shadow:true,store:A,renderTo:F,width:100,height:225,axes:[{type:"Numeric",hidden:true,position:"left",fields:["percent"],minimum:0,maximum:100},{type:"Category",hidden:true,position:"bottom",fields:["school"]}],series:[{type:"column",axis:"left",gutter:80,xField:"school",yField:["percent"],label:{display:"insideEnd","text-anchor":"left",field:["hours","percent"],font:"14px Helvetica, sans-serif",renderer:function(I,G,H){if(H.get("hours")===0){return""}return"     "+H.get("hours")},orientation:"horizontal",contrast:true},tips:{trackMouse:true,width:140,height:28,renderer:function(H,G){this.setTitle(Ext.util.Format.plural(H.get("hours"),"hour","hours"))}},renderer:function(K,H,G,J,I){return Ext.apply(G,{fill:"#0066cc"})}}]});x.total_chart_ids[E]=B.id}catch(C){}}if(this.avg_hours_chart_ids===undefined){this.avg_hours_chart_ids={}}function b(D,y,C){try{var z=Ext.create("Ext.data.JsonStore",{fields:["school","hours"],data:[{school:"school",hours:y}]});var A=Ext.create("Ext.chart.Chart",{xtype:"chart",animate:true,shadow:true,store:z,renderTo:D,width:100,height:225,axes:[{type:"Numeric",hidden:true,position:"left",fields:["hours"],minimum:0,maximum:10},{type:"Category",hidden:true,position:"bottom",fields:["school"]}],series:[{type:"column",axis:"left",gutter:80,xField:"school",yField:["hours"],label:{display:"insideEnd","text-anchor":"left",field:"hours",font:"14px Helvetica, sans-serif",renderer:function(E){if(isNaN(E)){return""}return"     "+Ext.util.Format.number(E,"0.0")},orientation:"horizontal",contrast:true},tips:{trackMouse:true,width:140,height:28,renderer:function(F,E){this.setTitle(Ext.util.Format.number(E.value[1],"0.0")+" hours")}},renderer:function(I,F,E,H,G){return Ext.apply(E,{fill:"#0066cc"})}}]});x.avg_hours_chart_ids[C]=A.id}catch(B){}}if(this.fluent_chart_ids===undefined){this.fluent_chart_ids={}}function g(F,y,D,E){try{y=Math.max(1,y);var C=Math.min(Math.ceil(D*100/y),100);var z=Ext.create("Ext.data.JsonStore",{fields:["school","fluent","fluent_percent"],data:[{school:"school",fluent:D,fluent_percent:C}]});var A=Ext.create("Ext.chart.Chart",{xtype:"chart",animate:true,shadow:true,store:z,renderTo:F,width:100,height:225,axes:[{type:"Numeric",hidden:true,position:"left",fields:["fluent_percent"],minimum:0,maximum:100},{type:"Category",hidden:true,position:"bottom",fields:["school"]}],series:[{type:"column",axis:"left",gutter:80,xField:"school",yField:["fluent_percent"],label:{display:"insideEnd","text-anchor":"left",field:["fluent","fluent_percent"],font:"14px Helvetica, sans-serif",renderer:function(G){if(G===0){return""}return"     "+G},orientation:"horizontal",contrast:true},tips:{trackMouse:true,width:140,height:52,renderer:function(J,I){var G=Ext.util.Format.plural(J.get("fluent"),"student","students");var H="";if(J.get("fluent")>0){H=" (about "+J.get("fluent_percent")+"%)"}this.setTitle(G+"<br />"+H)}},style:{fill:"#66CC00"}}]});x.fluent_chart_ids[E]=A.id}catch(B){}}if(this.not_fluent_chart_ids===undefined){this.not_fluent_chart_ids={}}function f(F,y,A,E){try{y=Math.max(1,y);var D=Math.min(Math.ceil(A*100/y),100);var z=Ext.create("Ext.data.JsonStore",{fields:["school","not_fluent","not_fluent_percent"],data:[{school:"school",not_fluent:A,not_fluent_percent:D}]});var B=Ext.create("Ext.chart.Chart",{xtype:"chart",animate:true,shadow:true,store:z,renderTo:F,height:225,width:100,axes:[{type:"Numeric",hidden:true,position:"left",fields:["not_fluent_percent"],minimum:0,maximum:100},{type:"Category",hidden:true,position:"bottom",fields:["school"]}],series:[{type:"column",axis:"left",gutter:80,xField:"school",yField:["not_fluent_percent"],label:{display:"insideEnd","text-anchor":"left",field:["not_fluent","not_fluent_percent"],font:"14px Helvetica, sans-serif",renderer:function(J,H,I){var G=I.get("not_fluent");if(G===0){return""}return"     "+G},orientation:"horizontal",contrast:true},tips:{trackMouse:true,width:140,height:52,renderer:function(J,I){var G=Ext.util.Format.plural(J.get("not_fluent"),"student","students");var H="";if(J.get("not_fluent")>0){H=" (about "+J.get("not_fluent_percent")+"%)"}this.setTitle(G+"<br />"+H)}},style:{fill:"#FF0000"}}]});x.not_fluent_chart_ids[E]=B.id}catch(C){}}function e(){var A=document.getElementById("schoolTable").rows[2].cells.length;for(var y=0;y<A;y++){var z=document.getElementById("schoolTable").rows[2].cells[y].offsetWidth;document.getElementById("schoolTable").rows[0].cells[y].width=z}}},add_avg_hours_data:function(b,c){if(this.avg_hours_school_id_data===undefined){this.avg_hours_school_id_data={}}var d=Ext.id();this.avg_hours_school_id_data[c]={};this.avg_hours_school_id_data[c].hours=b;this.avg_hours_school_id_data[c].div_id=d;return'<div id="'+d+'"></div>'},log_in_as_educator:function(e,d){var b=new Date();var f=new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours()+4);Ext.util.Cookies.set("__district_overview",true,f);Ext.getCmp("template_test").up("viewport").destroy();school_data.id=e;school_data.name=d;var c=new Date(b.getFullYear()+1,b.getMonth(),b.getDay());Ext.util.Cookies.set("__school_id_saved",school_data.id,c);Ext.util.Cookies.set("__school_name_saved",school_data.name,c);Ext.getStore("ClassStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/children";Ext.getStore("SchoolStore").proxy.url="routes/routes.php?url=/schools/"+school_data.id+"/login_info";Ext.getStore("ClassStore").load({callback:function(h,g,k){Ext.getStore("SchoolStore").load({callback:function(m,l,o){var n=Ext.create("BigBrainzLauncher.view.EducatorTreeViewport")}})}})},sort_name:function(){var b="ASC";if(Ext.getStore("DistrictReportStore").sorters.items[0].property==="name"){if(Ext.getStore("DistrictReportStore").sorters.items[0].direction==="ASC"){b="DESC"}}Ext.getStore("DistrictReportStore").sorters.clear();Ext.getStore("DistrictReportStore").sort("name",b);Ext.getCmp("template_test").update(Ext.getCmp("report_tabs").load_template_data())},sort_total_hours:function(){var b="ASC";if(Ext.getStore("DistrictReportStore").sorters.items[0].property==="hours"){if(Ext.getStore("DistrictReportStore").sorters.items[0].direction==="ASC"){b="DESC"}}Ext.getStore("DistrictReportStore").sorters.clear();Ext.getStore("DistrictReportStore").sort("hours",b);Ext.getCmp("template_test").update(Ext.getCmp("report_tabs").load_template_data())},sort_avg_hours:function(){var b="ASC";if(Ext.getStore("DistrictReportStore").sorters.items[0].property==="avg_hours"){if(Ext.getStore("DistrictReportStore").sorters.items[0].direction==="ASC"){b="DESC"}}Ext.getStore("DistrictReportStore").sorters.clear();Ext.getStore("DistrictReportStore").sort("avg_hours",b);Ext.getCmp("template_test").update(Ext.getCmp("report_tabs").load_template_data())},sort_fluents:function(){var b="ASC";if(Ext.getStore("DistrictReportStore").sorters.items[0].property==="fluent"){if(Ext.getStore("DistrictReportStore").sorters.items[0].direction==="ASC"){b="DESC"}}Ext.getStore("DistrictReportStore").sorters.clear();Ext.getStore("DistrictReportStore").sort("fluent",b);Ext.getCmp("template_test").update(Ext.getCmp("report_tabs").load_template_data())},add_fluency_data:function(b,c){if(this.fluency_school_id_data===undefined){this.fluency_school_id_data={}}var d=Ext.id();b=Ext.decode(b);this.fluency_school_id_data[c]={};this.fluency_school_id_data[c].data=b;this.fluency_school_id_data[c].div_id=d;return'<div id="'+d+'"></div>'}})}]}]},{xtype:"panel",title:"Summary"},{xtype:"panel",itemId:"ta9Tab",title:"Multiplication"},{xtype:"panel",hidden:true,itemId:"ta12Tab",title:"Multiplication(12's)"},{xtype:"panel",itemId:"divisionTab",title:"Division"},{xtype:"panel",itemId:"addSubTab",title:"Addition/Subtraction"},{xtype:"panel",hidden:true,itemId:"additionTab",title:"Addition"},{xtype:"panel",hidden:true,itemId:"subtractionTab",title:"Subtraction"}]}]});a.callParent(arguments)}});Ext.define("BigBrainzLauncher.view.DistrictOverview",{extend:"Ext.container.Viewport",requires:["BigBrainzLauncher.view.ReportYearSelector","BigBrainzLauncher.view.AggregatedReportPanel"],id:"district_overview",itemId:"districtOverview",layout:{align:"stretch",type:"vbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"toolbar",items:[{xtype:"reportyearselector"},{xtype:"button",hidden:true,text:"Automatic Emails",listeners:{click:{fn:a.onButtonClick,scope:a}}}]},{xtype:"container",height:90,html:"<div id=\"banner\">\r\n	<div id=\"banner-left\"></div>\r\n    <div id=\"banner-content\">\r\n			<ul style = 'text-align:center;list-style-type: none;font-weight:bold;'>\r\n				<li id = 'total_students'>Total Operations (Played for more than 1 hour): NA</li>\r\n				<li id = 'average_improvement'>Average Improvement (Played for more than 1 hour): NA</li>\r\n				<li id = 'instructional_hours'>Instructional Hours: 0</li>\r\n				<li id = 'avg_posttest_scores'>Average Post-Test Score: NA</li>\r\n			</ul>\r\n		</div>\r\n	<div id=\"banner-right\"></div>\r\n</div>\r\n<div id=\"logo\"></div>",maxHeight:90,minHeight:90,minWidth:200,width:200,layout:{align:"center",type:"vbox"}},{xtype:"aggregatedreportpanel",flex:1}]});a.callParent(arguments)},onButtonClick:function(b,d,a){var c=Ext.ComponentQuery.query("#emailSpecificReport")[0];if(c===undefined||c===null){c=Ext.create("BigBrainzLauncher.view.EmailSpecificReport")}c.down("grid").reconfigure(Ext.getStore("SchoolStore"));c.show()},load_school_report:function(d,c,a){var b=this.next().down("tabpanel");school_data.id=d;school_data.name=c;Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/schools/"+d+"/weekly_progress",success:function(e){report_data.data=Ext.decode(e.responseText);b.load_weekly_progress()},failure:function(){}});Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/districts/"+d+"/report/test_scores/pretest",success:function(e){pretest_data.data=Ext.decode(e.responseText);Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/districts/"+d+"/report/test_scores/posttest",success:function(f){posttest_data.data=Ext.decode(f.responseText);b.load_test_scores()},failure:function(){Ext.Msg.alert("Could not load pretest chart data.  Please try again.")}})},failure:function(){Ext.Msg.alert("Could not load pretest chart data.  Please try again.")}});Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/schools/"+d+"/report",success:function(e){report_grid_data.data=Ext.decode(e.responseText);b.load_grid_progress();if(a){a.hide()}},failure:function(){Ext.Msg.alert("Could load district report.  Please try again.");if(a){a.hide()}}});Ext.Ajax.request({method:"GET",url:"routes/routes.php?url=/districts/"+d+"/avg_test_scores",success:function(e){avg_improvement.data=Ext.decode(e.responseText);b.load_improvement_chart()},failure:function(){Ext.Msg.alert("Could load district report.  Please try again.")}})}});Ext.define("BigBrainzLauncher.controller.EducatorSchoolTree",{extend:"Ext.app.Controller",views:["EducatorTreeViewport"],refs:[{ref:"schoolTree",selector:"#schoolTree",xtype:"Ext.tree.Panel"},{ref:"dragNDropStudents",selector:"#dragNDropStudents"}],onSchoolTreeBeforeLoad:function(b,a,c){Ext.getStore("SchoolTreeStore").getRootNode().data.text=Ext.util.Cookies.get("__school_name_saved")},onSchoolTreeItemExpand:function(d,b){if(d.data.id==="0"){return}var c=Ext.getStore("SchoolTreeStore").getById(d.data.id);var a=Ext.ComponentQuery.query("#schoolTree")[0];a.selModel.select(c)},onSchoolTreeLoad:function(b,f,c,h,d){var a=this.getSchoolTree();try{g()}catch(e){}function g(){var k=Ext.getStore("SchoolTreeStore").getRootNode();a.expandNode(k)}},onSchoolTreeAfterRender:function(a,b){this.inDragDropMode=false;this.application.fireEvent("schoolSelected",school_data.id)},onSchoolTreeSelect:function(d,a,b,c){if(this.getDragNDropStudents()!==undefined&&this.getDragNDropStudents()!==null&&this.getDragNDropStudents().checked){return}if(a.data.id==="0"){this.application.fireEvent("schoolSelected",school_data.id)}else{if(a.data.leaf){student_data.id=a.data.id;student_data.name=a.data.text;this.application.fireEvent("studentSelected",a.data.id)}else{class_data.id=a.data.id;class_data.name=a.data.text;var e=Ext.getStore("SchoolTreeStore").getById(a.data.id);this.getSchoolTree().expandNode(e);this.application.fireEvent("classSelected",a.data.id)}}},onViewBeforeDrop:function(d,f,e,a,c,b){if((e.data.parentId==="0"&&a!=="append")||e.data.id==="0"||f.records[0].data.leaf===false){c.cancelDrop()}if(this.getDragNDropStudents()===undefined||this.getDragNDropStudents()===null){c.cancelDrop()}else{}},onViewDrop:function(f,h,g,b,d,c){var e=h.records[0];var a={ItemName:e.data.id,ParentID:e.data.parentId};Ext.Ajax.request({method:"PUT",url:"routes/routes.php?url=/games",params:a,success:function(k){var l=Ext.decode(k.responseText);if(l.success){Ext.Msg.alert("Success","Student moved successfully.")}else{Ext.Msg.alert("Could not move student.","Please try again.");d.cancelDrop()}},failure:function(){Ext.Msg.alert("Could not move student","Please try again.");d.cancelDrop()}})},onReportYearSelected:function(b){var a=this.getSchoolTree();if(a===undefined||a===null){return}var c=undefined;if(a.getSelectionModel().getSelection().length>0){c=a.getSelectionModel().getSelection()[0]}a.getRootNode().removeAll();a.getStore().load({callback:function(){Ext.getCmp("school_tree").getSelectionModel().select(0)}})},onClassReportGridRowSelected:function(c){var a=this.getSchoolTree();if(a===undefined||a===null){return}var b=a.getStore().getNodeById(c);a.getSelectionModel().select(b)},onOverviewReportGridRowSelected:function(c){var a=this.getSchoolTree();if(a===undefined||a===null){return}var b=a.getStore().getNodeById(c);a.getSelectionModel().select(b)},init:function(a){this.control({"#schoolTree":{beforeload:this.onSchoolTreeBeforeLoad,itemexpand:this.onSchoolTreeItemExpand,load:this.onSchoolTreeLoad,afterrender:this.onSchoolTreeAfterRender,select:this.onSchoolTreeSelect},"#schoolTreeView":{beforedrop:this.onViewBeforeDrop,drop:this.onViewDrop}});a.on({reportYearSelected:{fn:this.onReportYearSelected,scope:this},classReportGridRowSelected:{fn:this.onClassReportGridRowSelected,scope:this},overviewReportGridRowSelected:{fn:this.onOverviewReportGridRowSelected,scope:this}})}});Ext.Loader.setConfig({enabled:true,paths:{BigBrainzLauncher:"./"}});Ext.application({models:["CountryModel","StateModel","DistrictModel","SchoolModel","ClassModel","GameModel","SubjectModel","TreeModel","GameDataModel","TestModel"],stores:["CountryStore","StateStore","DistrictStore","SchoolStore","ClassStore","GameStore","AddGameStore","AddClassStore","SchoolTreeStore","WeeklyProgressStore","PosttestScoresStore","StudentWeeklyMinutes","GameDataStore","ClassPasswordsStore","DistrictReportStore","PretestChartStore","PosttestChartStore","AverageImprovementStore","GameProgressStore","SchoolSummary","FluencyTimeStore","ImportClassListStore","ProgressGaugeStore","DistrictTreeStore","DailyProgressStore","AutoReportEmail"],views:["AddStudentsWindow","StudentViewport","AddClassesWindow","UnlockDeluxeWindow","EducatorTreeViewport","BigBrainzSetup","StudentNeedPassword","StartupMessageWindow","EditStudentsWindow","ReportErrorWindow","LoginWindow","StudentLoginViewport","PizzaPartySignup","EditSchoolPasswordsWindow","DistrictOverview","WeeklyUsageGraph","AvgerageImprovementGraphs","PretestGraph","PosttestGraph","OverviewReportGrid","CommonReportGraphs","AggregatedReportPanel","StudentReportPage","FluencyTimeGraph","ImportClassWindow","DeleteMultipleWindow","EditClassesWindow","GamePanel","SchoolTree","DistrictOverviewLoginWindow","ClassReportGrid","LoginViewport","DailyUsageChart","ReplayDialog","PlanoGamePanel","BigBrainzMain","StudentDetails","ComprehensiveSummaryLegend","EmailSpecificReport","ReportYearSelector","StudentMultipleDetails","OperationOrderEditor","FriendlyModeCheckbox","SetMultSchoolYear"],autoCreateViewport:true,controllers:["EducatorSchoolTree","ImprovementChart","EducatorMenu","EducatorViewport","EducatorReportTabs","StudentReportPage","UsageChart","SchoolProgressGrid","ClassReportGrid","PretestChart","PosttestChart","StudentViewport","StudentViewportMenu","GamesPanel","StudentMinutesChart","DistrictTree","DistrictOverview","OverviewReportGrid","LoginViewportController","DailyUsageChart","ReplayDialogController","SetMultSchoolYear"],name:"BigBrainzLauncher"});window.launcherVersion = '20170807.000';
